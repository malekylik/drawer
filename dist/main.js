/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/assets/circle-pixel.glsl":
/*!**************************************!*\
  !*** ./src/assets/circle-pixel.glsl ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nin vec3 color;\\nin vec2 textureCoord;\\nin float vertexId;\\n\\nlayout(location = 0) out vec4 fragColor;\\nlayout(location = 1) out uvec4 fragId;\\n\\nvoid main()\\n{\\n  vec2 textureCoordOffset = vec2(textureCoord) * 2.0;\\n  textureCoordOffset.x -= 1.0;\\n  textureCoordOffset.y -= 1.0;\\n\\n  float squareDist = 1.0 - length(textureCoordOffset);\\n\\n  // TODO: why is not bleended\\n  // float smoothes = smoothstep(0.0, 0.005, squareDist);\\n  float smoothes = 1.0;\\n  float coef = step(0.0, squareDist) * smoothes;\\n\\n  if (coef == 0.0) {\\n    discard;\\n  }\\n\\n  fragColor = vec4(color, coef);\\n\\n  uint id = uint(vertexId);\\n  fragId = uvec4(id & uint(255), (id >> uint(8)) & uint(255), (id >> uint(16)) & uint(255), (id >> uint(24)) & uint(255));\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2NpcmNsZS1waXhlbC5nbHNsLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpRUFBZSw0Q0FBNEMsa0JBQWtCLHVCQUF1QixvQkFBb0IsNENBQTRDLHdDQUF3QyxrQkFBa0IsdURBQXVELGdDQUFnQyxnQ0FBZ0MsMERBQTBELDZGQUE2Rix5QkFBeUIsa0RBQWtELHdCQUF3QixjQUFjLEtBQUssb0NBQW9DLCtCQUErQiw0SEFBNEgsR0FBRyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL2Fzc2V0cy9jaXJjbGUtcGl4ZWwuZ2xzbD9iZWY2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuXFxuaW4gdmVjMyBjb2xvcjtcXG5pbiB2ZWMyIHRleHR1cmVDb29yZDtcXG5pbiBmbG9hdCB2ZXJ0ZXhJZDtcXG5cXG5sYXlvdXQobG9jYXRpb24gPSAwKSBvdXQgdmVjNCBmcmFnQ29sb3I7XFxubGF5b3V0KGxvY2F0aW9uID0gMSkgb3V0IHV2ZWM0IGZyYWdJZDtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gIHZlYzIgdGV4dHVyZUNvb3JkT2Zmc2V0ID0gdmVjMih0ZXh0dXJlQ29vcmQpICogMi4wO1xcbiAgdGV4dHVyZUNvb3JkT2Zmc2V0LnggLT0gMS4wO1xcbiAgdGV4dHVyZUNvb3JkT2Zmc2V0LnkgLT0gMS4wO1xcblxcbiAgZmxvYXQgc3F1YXJlRGlzdCA9IDEuMCAtIGxlbmd0aCh0ZXh0dXJlQ29vcmRPZmZzZXQpO1xcblxcbiAgLy8gVE9ETzogd2h5IGlzIG5vdCBibGVlbmRlZFxcbiAgLy8gZmxvYXQgc21vb3RoZXMgPSBzbW9vdGhzdGVwKDAuMCwgMC4wMDUsIHNxdWFyZURpc3QpO1xcbiAgZmxvYXQgc21vb3RoZXMgPSAxLjA7XFxuICBmbG9hdCBjb2VmID0gc3RlcCgwLjAsIHNxdWFyZURpc3QpICogc21vb3RoZXM7XFxuXFxuICBpZiAoY29lZiA9PSAwLjApIHtcXG4gICAgZGlzY2FyZDtcXG4gIH1cXG5cXG4gIGZyYWdDb2xvciA9IHZlYzQoY29sb3IsIGNvZWYpO1xcblxcbiAgdWludCBpZCA9IHVpbnQodmVydGV4SWQpO1xcbiAgZnJhZ0lkID0gdXZlYzQoaWQgJiB1aW50KDI1NSksIChpZCA+PiB1aW50KDgpKSAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoMTYpKSAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoMjQpKSAmIHVpbnQoMjU1KSk7XFxufVxcblwiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/assets/circle-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/circle-vertex.glsl":
/*!***************************************!*\
  !*** ./src/assets/circle-vertex.glsl ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nuniform mat4x4 P;\\nuniform mat4x4 MV;\\nuniform mat4x4 MM;\\n\\nlayout(location = 0) in vec3 vPosition;\\nlayout(location = 1) in vec3 vColor;\\nlayout(location = 2) in vec2 vTextureCoord;\\nlayout(location = 3) in float vVertexId;\\n\\nout vec3 color;\\nout vec2 textureCoord;\\nout float vertexId;\\n\\nvoid main()\\n{\\n  gl_Position = P * inverse(MV) * MM * vec4(vPosition, 1.0);\\n\\n  color = vColor;\\n  textureCoord = vTextureCoord;\\n  vertexId = vVertexId;\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2NpcmNsZS12ZXJ0ZXguZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUscUNBQXFDLG9CQUFvQixvQkFBb0IsMkNBQTJDLHNDQUFzQyw2Q0FBNkMsMENBQTBDLG1CQUFtQix3QkFBd0IscUJBQXFCLGtCQUFrQiw4REFBOEQscUJBQXFCLGlDQUFpQyx5QkFBeUIsR0FBRyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL2Fzc2V0cy9jaXJjbGUtdmVydGV4Lmdsc2w/NWZkMyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIiN2ZXJzaW9uIDMwMCBlc1xcblxcbnVuaWZvcm0gbWF0NHg0IFA7XFxudW5pZm9ybSBtYXQ0eDQgTVY7XFxudW5pZm9ybSBtYXQ0eDQgTU07XFxuXFxubGF5b3V0KGxvY2F0aW9uID0gMCkgaW4gdmVjMyB2UG9zaXRpb247XFxubGF5b3V0KGxvY2F0aW9uID0gMSkgaW4gdmVjMyB2Q29sb3I7XFxubGF5b3V0KGxvY2F0aW9uID0gMikgaW4gdmVjMiB2VGV4dHVyZUNvb3JkO1xcbmxheW91dChsb2NhdGlvbiA9IDMpIGluIGZsb2F0IHZWZXJ0ZXhJZDtcXG5cXG5vdXQgdmVjMyBjb2xvcjtcXG5vdXQgdmVjMiB0ZXh0dXJlQ29vcmQ7XFxub3V0IGZsb2F0IHZlcnRleElkO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgZ2xfUG9zaXRpb24gPSBQICogaW52ZXJzZShNVikgKiBNTSAqIHZlYzQodlBvc2l0aW9uLCAxLjApO1xcblxcbiAgY29sb3IgPSB2Q29sb3I7XFxuICB0ZXh0dXJlQ29vcmQgPSB2VGV4dHVyZUNvb3JkO1xcbiAgdmVydGV4SWQgPSB2VmVydGV4SWQ7XFxufVxcblwiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/assets/circle-vertex.glsl\n");

/***/ }),

/***/ "./src/assets/line-pixel.glsl":
/*!************************************!*\
  !*** ./src/assets/line-pixel.glsl ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nin vec3 color;\\nin float vertexId;\\n\\nlayout(location = 0) out vec4 fragColor;\\nlayout(location = 1) out uvec4 fragId;\\n\\nvoid main()\\n{\\n  fragColor = vec4(color, 1.0);\\n\\n  uint id = uint(vertexId);\\n  fragId = uvec4(id & uint(255), (id >> uint(8)) & uint(255), (id >> uint(16)) & uint(255), (id >> uint(24)) & uint(255));\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2xpbmUtcGl4ZWwuZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsNENBQTRDLGtCQUFrQixvQkFBb0IsNENBQTRDLHdDQUF3QyxrQkFBa0IsaUNBQWlDLCtCQUErQiw0SEFBNEgsR0FBRyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL2Fzc2V0cy9saW5lLXBpeGVsLmdsc2w/MzJmYSJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIiN2ZXJzaW9uIDMwMCBlc1xcblxcbnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0O1xcblxcbmluIHZlYzMgY29sb3I7XFxuaW4gZmxvYXQgdmVydGV4SWQ7XFxuXFxubGF5b3V0KGxvY2F0aW9uID0gMCkgb3V0IHZlYzQgZnJhZ0NvbG9yO1xcbmxheW91dChsb2NhdGlvbiA9IDEpIG91dCB1dmVjNCBmcmFnSWQ7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBmcmFnQ29sb3IgPSB2ZWM0KGNvbG9yLCAxLjApO1xcblxcbiAgdWludCBpZCA9IHVpbnQodmVydGV4SWQpO1xcbiAgZnJhZ0lkID0gdXZlYzQoaWQgJiB1aW50KDI1NSksIChpZCA+PiB1aW50KDgpKSAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoMTYpKSAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoMjQpKSAmIHVpbnQoMjU1KSk7XFxufVxcblwiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/assets/line-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/line-vertex.glsl":
/*!*************************************!*\
  !*** ./src/assets/line-vertex.glsl ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nuniform mat4x4 P;\\nuniform mat4x4 MV;\\nuniform mat4x4 MM;\\n\\nlayout(location = 0) in vec3 vPosition;\\nlayout(location = 1) in vec3 vColor;\\nlayout(location = 2) in float vVertexId;\\n\\nout vec3 color;\\nout float vertexId;\\n\\nvoid main()\\n{\\n  gl_Position = P * inverse(MV) * MM * vec4(vPosition, 1.0);\\n\\n  color = vColor;\\n  vertexId = vVertexId;\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2xpbmUtdmVydGV4Lmdsc2wuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLHFDQUFxQyxvQkFBb0Isb0JBQW9CLDJDQUEyQyxzQ0FBc0MsMENBQTBDLG1CQUFtQixxQkFBcUIsa0JBQWtCLDhEQUE4RCxxQkFBcUIseUJBQXlCLEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9hc3NldHMvbGluZS12ZXJ0ZXguZ2xzbD9hM2E2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxudW5pZm9ybSBtYXQ0eDQgUDtcXG51bmlmb3JtIG1hdDR4NCBNVjtcXG51bmlmb3JtIG1hdDR4NCBNTTtcXG5cXG5sYXlvdXQobG9jYXRpb24gPSAwKSBpbiB2ZWMzIHZQb3NpdGlvbjtcXG5sYXlvdXQobG9jYXRpb24gPSAxKSBpbiB2ZWMzIHZDb2xvcjtcXG5sYXlvdXQobG9jYXRpb24gPSAyKSBpbiBmbG9hdCB2VmVydGV4SWQ7XFxuXFxub3V0IHZlYzMgY29sb3I7XFxub3V0IGZsb2F0IHZlcnRleElkO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgZ2xfUG9zaXRpb24gPSBQICogaW52ZXJzZShNVikgKiBNTSAqIHZlYzQodlBvc2l0aW9uLCAxLjApO1xcblxcbiAgY29sb3IgPSB2Q29sb3I7XFxuICB2ZXJ0ZXhJZCA9IHZWZXJ0ZXhJZDtcXG59XFxuXCI7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/assets/line-vertex.glsl\n");

/***/ }),

/***/ "./src/assets/texture-pixel.glsl":
/*!***************************************!*\
  !*** ./src/assets/texture-pixel.glsl ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nuniform sampler2D outTexture;\\n\\nin vec2 texCoord;\\n\\nout vec4 fragColor;\\n\\nvoid main()\\n{\\n  fragColor = texture(outTexture, texCoord);\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL3RleHR1cmUtcGl4ZWwuZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsNENBQTRDLGlDQUFpQyxxQkFBcUIsdUJBQXVCLGtCQUFrQiw4Q0FBOEMsR0FBRyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL2Fzc2V0cy90ZXh0dXJlLXBpeGVsLmdsc2w/ZDM4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIiN2ZXJzaW9uIDMwMCBlc1xcblxcbnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0O1xcblxcbnVuaWZvcm0gc2FtcGxlcjJEIG91dFRleHR1cmU7XFxuXFxuaW4gdmVjMiB0ZXhDb29yZDtcXG5cXG5vdXQgdmVjNCBmcmFnQ29sb3I7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBmcmFnQ29sb3IgPSB0ZXh0dXJlKG91dFRleHR1cmUsIHRleENvb3JkKTtcXG59XFxuXCI7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/assets/texture-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/texture-vertex.glsl":
/*!****************************************!*\
  !*** ./src/assets/texture-vertex.glsl ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nlayout(location = 0) in vec4 vPosition;\\nlayout(location = 1) in vec2 aTexCoord;\\n\\nout vec2 texCoord;\\n\\nvoid main()\\n{\\n  gl_Position = vPosition;\\n  texCoord = vec2(aTexCoord.x, 1.0 - aTexCoord.y);\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL3RleHR1cmUtdmVydGV4Lmdsc2wuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLDJEQUEyRCx5Q0FBeUMsc0JBQXNCLGtCQUFrQiw0QkFBNEIsb0RBQW9ELEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9hc3NldHMvdGV4dHVyZS12ZXJ0ZXguZ2xzbD85MDYzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxubGF5b3V0KGxvY2F0aW9uID0gMCkgaW4gdmVjNCB2UG9zaXRpb247XFxubGF5b3V0KGxvY2F0aW9uID0gMSkgaW4gdmVjMiBhVGV4Q29vcmQ7XFxuXFxub3V0IHZlYzIgdGV4Q29vcmQ7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBnbF9Qb3NpdGlvbiA9IHZQb3NpdGlvbjtcXG4gIHRleENvb3JkID0gdmVjMihhVGV4Q29vcmQueCwgMS4wIC0gYVRleENvb3JkLnkpO1xcbn1cXG5cIjsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/assets/texture-vertex.glsl\n");

/***/ }),

/***/ "./src/event/canvas-event.ts":
/*!***********************************!*\
  !*** ./src/event/canvas-event.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.bindEvents = void 0;\nconst screen_1 = __webpack_require__(/*! ../math/screen */ \"./src/math/screen.ts\");\nconst vec_1 = __webpack_require__(/*! ../math/vec */ \"./src/math/vec.ts\");\n// Aircraft_principal_axes\nfunction bindEvents(canvas, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect, mousePosition) {\n    const eventStack = [];\n    const keyboard = new Uint8Array(128);\n    canvas.addEventListener('keydown', (e) => {\n        if (e.key.charCodeAt(0) < 128) {\n            keyboard[e.key.charCodeAt(0)] = 1;\n        }\n        eventStack.push({\n            type: 'keydown',\n            keyCode: e.key.charCodeAt(0),\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('keyup', (e) => {\n        if (e.key.charCodeAt(0) < 128) {\n            keyboard[e.key.charCodeAt(0)] = 0;\n        }\n        eventStack.push({\n            type: 'keyup',\n            keyCode: e.key.charCodeAt(0),\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('keypress', (e) => {\n        eventStack.push({\n            type: 'keypress',\n            keyCode: -1,\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('mousedown', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        eventStack.push({\n            type: 'mousedown',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    canvas.addEventListener('mousemove', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        mousePosition.x = e.offsetX;\n        mousePosition.y = e.offsetY;\n        eventStack.push({\n            type: 'mousemove',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    canvas.addEventListener('mouseup', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        eventStack.push({\n            type: 'mouseup',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    return { eventStack, keyboard };\n}\nexports.bindEvents = bindEvents;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXZlbnQvY2FudmFzLWV2ZW50LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGtCQUFrQjtBQUNsQixpQkFBaUIsbUJBQU8sQ0FBQyw0Q0FBZ0I7QUFDekMsY0FBYyxtQkFBTyxDQUFDLHNDQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLGFBQWE7QUFDYjtBQUNBLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9ldmVudC9jYW52YXMtZXZlbnQudHM/YWFkOSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuYmluZEV2ZW50cyA9IHZvaWQgMDtcbmNvbnN0IHNjcmVlbl8xID0gcmVxdWlyZShcIi4uL21hdGgvc2NyZWVuXCIpO1xuY29uc3QgdmVjXzEgPSByZXF1aXJlKFwiLi4vbWF0aC92ZWNcIik7XG4vLyBBaXJjcmFmdF9wcmluY2lwYWxfYXhlc1xuZnVuY3Rpb24gYmluZEV2ZW50cyhjYW52YXMsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCwgbW91c2VQb3NpdGlvbikge1xuICAgIGNvbnN0IGV2ZW50U3RhY2sgPSBbXTtcbiAgICBjb25zdCBrZXlib2FyZCA9IG5ldyBVaW50OEFycmF5KDEyOCk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkuY2hhckNvZGVBdCgwKSA8IDEyOCkge1xuICAgICAgICAgICAga2V5Ym9hcmRbZS5rZXkuY2hhckNvZGVBdCgwKV0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAna2V5ZG93bicsXG4gICAgICAgICAgICBrZXlDb2RlOiBlLmtleS5jaGFyQ29kZUF0KDApLFxuICAgICAgICAgICAga2V5OiBlLmtleSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGUpID0+IHtcbiAgICAgICAgaWYgKGUua2V5LmNoYXJDb2RlQXQoMCkgPCAxMjgpIHtcbiAgICAgICAgICAgIGtleWJvYXJkW2Uua2V5LmNoYXJDb2RlQXQoMCldID0gMDtcbiAgICAgICAgfVxuICAgICAgICBldmVudFN0YWNrLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2tleXVwJyxcbiAgICAgICAgICAgIGtleUNvZGU6IGUua2V5LmNoYXJDb2RlQXQoMCksXG4gICAgICAgICAgICBrZXk6IGUua2V5LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgICBldmVudFN0YWNrLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2tleXByZXNzJyxcbiAgICAgICAgICAgIGtleUNvZGU6IC0xLFxuICAgICAgICAgICAga2V5OiBlLmtleSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvb3JkID0gKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgKDAsIHNjcmVlbl8xLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCkoY29vcmQsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHg6IGNvb3JkLngsXG4gICAgICAgICAgICB5OiBjb29yZC55LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpID0+IHtcbiAgICAgICAgY29uc3QgY29vcmQgPSAoMCwgdmVjXzEuY3JlYXRlVmVjMikoZS5vZmZzZXRYLCBlLm9mZnNldFkpO1xuICAgICAgICAoMCwgc2NyZWVuXzEuY29udmVydFNjcmVlbkNvb3JkVG9Xb3JsZENvb3JkKShjb29yZCwgY2FtZXJhUG9zaXRpb24sIHBhaXRpbmdMYXllciwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCwgZm92eSwgYXNwZWN0KTtcbiAgICAgICAgbW91c2VQb3NpdGlvbi54ID0gZS5vZmZzZXRYO1xuICAgICAgICBtb3VzZVBvc2l0aW9uLnkgPSBlLm9mZnNldFk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2Vtb3ZlJyxcbiAgICAgICAgICAgIHg6IGNvb3JkLngsXG4gICAgICAgICAgICB5OiBjb29yZC55LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvb3JkID0gKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgKDAsIHNjcmVlbl8xLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCkoY29vcmQsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2V1cCcsXG4gICAgICAgICAgICB4OiBjb29yZC54LFxuICAgICAgICAgICAgeTogY29vcmQueSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgZXZlbnRTdGFjaywga2V5Ym9hcmQgfTtcbn1cbmV4cG9ydHMuYmluZEV2ZW50cyA9IGJpbmRFdmVudHM7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/event/canvas-event.ts\n");

/***/ }),

/***/ "./src/event/const.ts":
/*!****************************!*\
  !*** ./src/event/const.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.KeyboardKeyCode = void 0;\nvar KeyboardKeyCode;\n(function (KeyboardKeyCode) {\n    KeyboardKeyCode[KeyboardKeyCode[\"spaceKey\"] = 32] = \"spaceKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"aKey\"] = 97] = \"aKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"dKey\"] = 100] = \"dKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"sKey\"] = 115] = \"sKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"wKey\"] = 119] = \"wKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"zKey\"] = 122] = \"zKey\";\n})(KeyboardKeyCode = exports.KeyboardKeyCode || (exports.KeyboardKeyCode = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXZlbnQvY29uc3QudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdEQUFnRCx1QkFBdUIsS0FBSyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9ldmVudC9jb25zdC50cz9iMTQyIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5LZXlib2FyZEtleUNvZGUgPSB2b2lkIDA7XG52YXIgS2V5Ym9hcmRLZXlDb2RlO1xuKGZ1bmN0aW9uIChLZXlib2FyZEtleUNvZGUpIHtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wic3BhY2VLZXlcIl0gPSAzMl0gPSBcInNwYWNlS2V5XCI7XG4gICAgS2V5Ym9hcmRLZXlDb2RlW0tleWJvYXJkS2V5Q29kZVtcImFLZXlcIl0gPSA5N10gPSBcImFLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wiZEtleVwiXSA9IDEwMF0gPSBcImRLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wic0tleVwiXSA9IDExNV0gPSBcInNLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wid0tleVwiXSA9IDExOV0gPSBcIndLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wiektleVwiXSA9IDEyMl0gPSBcInpLZXlcIjtcbn0pKEtleWJvYXJkS2V5Q29kZSA9IGV4cG9ydHMuS2V5Ym9hcmRLZXlDb2RlIHx8IChleHBvcnRzLktleWJvYXJkS2V5Q29kZSA9IHt9KSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/event/const.ts\n");

/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst vec_1 = __webpack_require__(/*! ./math/vec */ \"./src/math/vec.ts\");\nconst matix_1 = __webpack_require__(/*! ./math/matix */ \"./src/math/matix.ts\");\nconst utils_1 = __webpack_require__(/*! ./math/utils */ \"./src/math/utils.ts\");\nconst screen_1 = __webpack_require__(/*! ./math/screen */ \"./src/math/screen.ts\");\nconst canvas_event_1 = __webpack_require__(/*! ./event/canvas-event */ \"./src/event/canvas-event.ts\");\nconst const_1 = __webpack_require__(/*! ./event/const */ \"./src/event/const.ts\");\nconst renderer_1 = __webpack_require__(/*! ./render/renderer */ \"./src/render/renderer.ts\");\nconst components_1 = __webpack_require__(/*! ./render/components */ \"./src/render/components.ts\");\nconst const_2 = __webpack_require__(/*! ./render/const */ \"./src/render/const.ts\");\nconst uniqeId_1 = __webpack_require__(/*! ./utils/uniqeId */ \"./src/utils/uniqeId.ts\");\nconst memory_1 = __webpack_require__(/*! ./utils/memory */ \"./src/utils/memory.ts\");\nconst shader_store_1 = __webpack_require__(/*! ./render/shader-store */ \"./src/render/shader-store.ts\");\nconst shader_1 = __webpack_require__(/*! ./render/shader */ \"./src/render/shader.ts\");\nconst gl_api_1 = __webpack_require__(/*! ./render/gl-api */ \"./src/render/gl-api.ts\");\nconst array_1 = __webpack_require__(/*! ./utils/array */ \"./src/utils/array.ts\");\nconst line_vertex_glsl_1 = __webpack_require__(/*! ./assets/line-vertex.glsl */ \"./src/assets/line-vertex.glsl\");\nconst circle_vertex_glsl_1 = __webpack_require__(/*! ./assets/circle-vertex.glsl */ \"./src/assets/circle-vertex.glsl\");\nconst line_pixel_glsl_1 = __webpack_require__(/*! ./assets/line-pixel.glsl */ \"./src/assets/line-pixel.glsl\");\nconst circle_pixel_glsl_1 = __webpack_require__(/*! ./assets/circle-pixel.glsl */ \"./src/assets/circle-pixel.glsl\");\nconst texture_vertex_glsl_1 = __webpack_require__(/*! ./assets/texture-vertex.glsl */ \"./src/assets/texture-vertex.glsl\");\nconst texture_pixel_glsl_1 = __webpack_require__(/*! ./assets/texture-pixel.glsl */ \"./src/assets/texture-pixel.glsl\");\nconst getNewId = (0, uniqeId_1.createUniqeIdGenerator)(1);\nlet prevComponentId = -1;\nlet prevLineSegment = -1;\nlet prevRendererStat = {\n    flushedSqures: -1,\n    flushedCircles: -1,\n    flushedBatchSquresCount: -1,\n    flushedBatchCirclesCount: -1,\n};\nlet currentComonentId = 0;\nlet currentLineStart = -1;\nconst prevMousePosition = (0, vec_1.createVec2)(-1, -1);\nconst mousePosition = (0, vec_1.createVec2)(0, 0);\nvar DrawMode;\n(function (DrawMode) {\n    DrawMode[\"select\"] = \"select\";\n    DrawMode[\"line\"] = \"line\";\n    DrawMode[\"circle\"] = \"circle\";\n})(DrawMode || (DrawMode = {}));\nlet mode = DrawMode.select;\nconst lines = [];\nconst circles = [];\nconst screenWidth = 600;\nconst screenHeight = 400;\nconst canvas = document.getElementById('canvas');\nconst componentIdViewer = document.getElementById('component-id');\nconst mousePostionViewer = document.getElementById('mouse-position');\nconst lineCountViewer = document.getElementById('line-count');\nconst lineSegmentViewer = document.getElementById('line-segment-id');\nconst circleCountViewer = document.getElementById('circle-count');\nconst lineSegmentColorInputRed = document.getElementById('line-segment-color-input-red');\nconst lineSegmentColorViewerRed = document.getElementById('line-segment-color-viewer-red');\nconst lineSegmentColorInputGreen = document.getElementById('line-segment-color-input-green');\nconst lineSegmentColorViewerGreen = document.getElementById('line-segment-color-viewer-green');\nconst lineSegmentColorInputBlue = document.getElementById('line-segment-color-input-blue');\nconst lineSegmentColorViewerBlue = document.getElementById('line-segment-color-viewer-blue');\nconst lineSegmentColorViewerResult = document.getElementById('line-segment-color-viewer-result');\nconst buttonSelectMode = document.getElementById('select-mode-select');\nconst buttonLineMode = document.getElementById('select-mode-drawline');\nconst buttonCircleMode = document.getElementById('select-mode-drawcircle');\nbuttonSelectMode.disabled = mode === DrawMode.select;\nbuttonLineMode.disabled = mode === DrawMode.line;\nbuttonCircleMode.disabled = mode === DrawMode.circle;\ncanvas.width = screenWidth;\ncanvas.height = screenHeight;\ncanvas.style.width = `${screenWidth}px`;\ncanvas.style.height = `${screenHeight}px`;\nconst gl = canvas.getContext('webgl2', { antialias: false });\nshader_store_1.shaderStore.setProgram(shader_store_1.ShaderProgramIndex.texture, new shader_1.GLProgram(gl, (0, gl_api_1.createVertexGLShader)(gl, texture_vertex_glsl_1.default), (0, gl_api_1.createFragmentGLShader)(gl, texture_pixel_glsl_1.default)));\nshader_store_1.shaderStore.setProgram(shader_store_1.ShaderProgramIndex.square, new shader_1.GLProgram(gl, (0, gl_api_1.createVertexGLShader)(gl, line_vertex_glsl_1.default), (0, gl_api_1.createFragmentGLShader)(gl, line_pixel_glsl_1.default)));\nshader_store_1.shaderStore.setProgram(shader_store_1.ShaderProgramIndex.circle, new shader_1.GLProgram(gl, (0, gl_api_1.createVertexGLShader)(gl, circle_vertex_glsl_1.default), (0, gl_api_1.createFragmentGLShader)(gl, circle_pixel_glsl_1.default)));\nconst renderer = new renderer_1.Renderer(gl, screenWidth, screenHeight);\nconst near = 0.1;\nconst far = 10.0;\nconst fovy = (0, utils_1.toRadians)(45);\nconst aspect = screenWidth / screenHeight;\nconst cameraPosition = (0, vec_1.createVec3)(0, 0, 0);\nconst { keyboard, eventStack } = (0, canvas_event_1.bindEvents)(canvas, cameraPosition, const_2.paitingLayer, screenWidth, screenHeight, fovy, aspect, mousePosition);\nlet drawingLine = false;\nlet drawingCirle = false;\nlet lineCount = 0;\nfunction findLineStartIndex(lineIndex, lineId) {\n    var _a;\n    while (lineIndex > 0 && ((_a = lines[lineIndex - 1]) === null || _a === void 0 ? void 0 : _a.line) === lineId) {\n        lineIndex -= 1;\n    }\n    return lineIndex;\n}\nfunction updateCamera() {\n    let isUpdated = false;\n    // TODO: use more convinient func\n    let updateValue = Math.sin((0, utils_1.toRadians)(((cameraPosition.z + 2.8) / 9.0 * 8.0) + 270.0 + 11.0)) + 1.0;\n    updateValue = Math.max(updateValue, 0.005);\n    // TODO: change line end while drawing line and zooming in/out\n    if (keyboard[const_1.KeyboardKeyCode.wKey]) {\n        cameraPosition.z = cameraPosition.z - updateValue < -2.8 ? -2.8 : cameraPosition.z - updateValue;\n        isUpdated = true;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.sKey]) {\n        cameraPosition.z = cameraPosition.z + updateValue > 6.0 ? 6.0 : cameraPosition.z + updateValue;\n        isUpdated = true;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.dKey]) {\n        cameraPosition.x += updateValue;\n        isUpdated = true;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.aKey]) {\n        cameraPosition.x -= updateValue;\n        isUpdated = true;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.spaceKey]) {\n        cameraPosition.y += updateValue;\n        isUpdated = true;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.zKey]) {\n        cameraPosition.y -= updateValue;\n        isUpdated = true;\n    }\n    return isUpdated;\n}\nfunction renderLines() {\n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        renderer.drawLine(line);\n    }\n    for (let i = 0; i < lines.length - 1; i++) {\n        const line = lines[i];\n        const nextLines = lines[i + 1];\n        if (line.line === nextLines.line) {\n            const circle = {\n                position: nextLines.position, color: line.color, radius: 0.1 / 2, id: line.id\n            };\n            renderer.drawCircle(circle);\n        }\n    }\n}\nfunction renderCircles() {\n    for (let i = 0; i < circles.length; i++) {\n        const circle = circles[i];\n        renderer.drawCircle(circle);\n    }\n}\nfunction handleMouseMoveForLineDrawing(coord) {\n    const lastLine = lines[lines.length - 1];\n    const lengthX = coord.x - lastLine.position.x;\n    const lengthY = coord.y - lastLine.position.y;\n    let angle = (0, screen_1.getAngleFromLineProjection)(lengthX, lengthY);\n    let lineLength = 0.0;\n    if (angle === 90 || angle === 270) {\n        lineLength = lengthY;\n    }\n    else {\n        lineLength = (lengthX) / Math.cos((0, utils_1.toRadians)(angle));\n    }\n    lastLine.length = lineLength;\n    lastLine.rotate = angle;\n}\nfunction handleEvents() {\n    let i = 0;\n    while (i < eventStack.length) {\n        const event = eventStack[i];\n        if (mode === DrawMode.select) {\n            if (event.type === 'mousedown') {\n                prevComponentId = currentComonentId;\n                const idDataReader = renderer.getIdDataReader();\n                idDataReader.bind();\n                const b = renderer.getIdDataReader().readPixel(mousePosition.x, screenHeight - mousePosition.y);\n                idDataReader.unbind();\n                currentComonentId = (0, memory_1.interpretAsInt32)(b[0], b[1], b[2], b[3]);\n            }\n        }\n        if (mode === DrawMode.line) {\n            if (event.type === 'mousedown' && !drawingLine) {\n                drawingLine = true;\n                const length = 0.01;\n                lines.push((0, components_1.createLine)((0, vec_1.createVec2)(event.x, event.y), length, getNewId()));\n                lines[lines.length - 1].line = lineCount;\n            }\n            else if (event.type === 'mousedown' && drawingLine) {\n                const lastLine = lines[lines.length - 1];\n                const lengthX = event.x - lastLine.position.x;\n                const lengthY = event.y - lastLine.position.y;\n                let angle = (0, screen_1.getAngleFromLineProjection)(lengthX, lengthY);\n                let lineLength = 0.0;\n                if (angle === 90 || angle === 270) {\n                    lineLength = lengthY;\n                }\n                else {\n                    lineLength = (lengthX) / Math.cos((0, utils_1.toRadians)(angle));\n                }\n                // TODO: find out linear transformation, transform screen cordination to world (use inverse projection matrix)\n                lastLine.length = lineLength;\n                lastLine.rotate = angle;\n                const length = 0.01;\n                lines.push((0, components_1.createLine)((0, vec_1.createVec2)(event.x, event.y), length, getNewId()));\n                lines[lines.length - 1].line = lineCount;\n            }\n            if (event.type === 'mousemove' && drawingLine) {\n                handleMouseMoveForLineDrawing(event);\n            }\n            if (event.type === 'keypress' && event.key === 'Enter' && drawingLine) {\n                drawingLine = false;\n                lines.pop();\n                lineCount += 1;\n            }\n        }\n        if (mode === DrawMode.circle) {\n            if (event.type === 'mousedown' && !drawingCirle) {\n                circles.push({\n                    position: (0, vec_1.createVec2)(event.x, event.y),\n                    color: (0, vec_1.createVec3)(1.0, 1.0, 1.0),\n                    radius: 0.1,\n                    id: getNewId()\n                });\n                drawingCirle = true;\n            }\n            if (event.type === 'mousemove' && drawingCirle) {\n                circles.push({\n                    position: (0, vec_1.createVec2)(event.x, event.y),\n                    color: (0, vec_1.createVec3)(1.0, 1.0, 1.0),\n                    radius: 0.1,\n                    id: getNewId()\n                });\n            }\n            if (event.type === 'mouseup' && drawingCirle) {\n                drawingCirle = false;\n            }\n        }\n        i++;\n    }\n    let length = eventStack.length;\n    for (let i = 0; i < length; i++) {\n        eventStack.pop();\n    }\n}\nfunction onCamerUpdate() {\n    if (drawingLine) {\n        const coord = (0, vec_1.createVec2)(mousePosition.x, mousePosition.y);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, const_2.paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        handleMouseMoveForLineDrawing(coord);\n    }\n}\nfunction updateHTML() {\n    var _a, _b;\n    if (prevComponentId !== currentComonentId && currentComonentId === 0) {\n        prevLineSegment = -1;\n        currentLineStart = -1;\n        lineSegmentViewer.innerText = `current line segment: ${prevLineSegment}`;\n        lineSegmentColorInputRed.value = '0';\n        lineSegmentColorViewerRed.style.backgroundColor = 'rgb(0, 0, 0)';\n        lineSegmentColorInputGreen.value = '0';\n        lineSegmentColorViewerGreen.style.backgroundColor = 'rgb(0, 0, 0)';\n        lineSegmentColorInputBlue.value = '0';\n        lineSegmentColorViewerBlue.style.backgroundColor = 'rgb(0, 0, 0)';\n        lineSegmentColorViewerResult.style.backgroundColor = 'rgb(0, 0, 0)';\n    }\n    if (prevComponentId !== currentComonentId) {\n        componentIdViewer.innerText = `current component id: ${currentComonentId === 0 ? 'no selected component' : currentComonentId}`;\n        prevComponentId = currentComonentId;\n    }\n    if (prevMousePosition.x !== mousePosition.x || prevMousePosition.y !== mousePosition.y) {\n        mousePostionViewer.innerText = `mouse position x: ${mousePosition.x} y: ${mousePosition.y}`;\n        prevMousePosition.x = mousePosition.x;\n        prevMousePosition.y = mousePosition.y;\n    }\n    const componentIndex = currentComonentId !== 0 ? (_a = (0, array_1.binaryFind)(lines, 0, lines.length, l => currentComonentId - l.id)) !== null && _a !== void 0 ? _a : -1 : -1;\n    if (currentComonentId !== 0 &&\n        componentIndex !== -1 &&\n        prevLineSegment !== ((_b = lines[componentIndex]) === null || _b === void 0 ? void 0 : _b.line)) {\n        const line = lines[componentIndex];\n        lineSegmentViewer.innerText = `current line segment: ${line.line}`;\n        prevLineSegment = line.line;\n        const lineStartIndex = findLineStartIndex(componentIndex, line.line);\n        const lineStart = lines[lineStartIndex];\n        lineSegmentColorInputRed.value = String(lineStart.color.x * 255);\n        lineSegmentColorViewerRed.style.backgroundColor = `rgb(${lineStart.color.x * 255}, ${0}, ${0})`;\n        lineSegmentColorInputGreen.value = String(lineStart.color.y * 255);\n        lineSegmentColorViewerGreen.style.backgroundColor = `rgb(${0}, ${lineStart.color.y * 255}, ${0})`;\n        lineSegmentColorInputBlue.value = String(lineStart.color.z * 255);\n        lineSegmentColorViewerBlue.style.backgroundColor = `rgb(${0}, ${0}, ${lineStart.color.z * 255})`;\n        lineSegmentColorViewerResult.style.backgroundColor = `rgb(${lineStart.color.x * 255}, ${lineStart.color.y * 255}, ${lineStart.color.z * 255})`;\n        currentLineStart = lineStartIndex;\n    }\n    const rendererStat = renderer.getDrawStat();\n    if (prevRendererStat.flushedSqures !== rendererStat.flushedSqures ||\n        prevRendererStat.flushedCircles !== rendererStat.flushedCircles ||\n        prevRendererStat.flushedBatchSquresCount !== rendererStat.flushedBatchSquresCount ||\n        prevRendererStat.flushedBatchCirclesCount !== rendererStat.flushedBatchCirclesCount) {\n        lineCountViewer.innerText = `square count: ${rendererStat.flushedSqures} flushed square batch count: ${rendererStat.flushedBatchSquresCount}`;\n        circleCountViewer.innerText = `circle count: ${rendererStat.flushedCircles} flushed circle batch count: ${rendererStat.flushedBatchCirclesCount}`;\n        prevRendererStat = rendererStat;\n    }\n}\nlineSegmentColorInputRed.addEventListener('change', (e) => {\n    var _a, _b;\n    const value = (_a = Number(e.target.value)) !== null && _a !== void 0 ? _a : -1;\n    if (currentComonentId !== 0 &&\n        (value >= 0 || value < 256)) {\n        let lineStart = currentLineStart;\n        lineSegmentColorViewerRed.style.backgroundColor = `rgb(${value}, ${0}, ${0})`;\n        lineSegmentColorViewerResult.style.backgroundColor = `rgb(${value}, ${lines[lineStart].color.y * 255}, ${lines[lineStart].color.z * 255})`;\n        while (lineStart < lines.length && ((_b = lines[lineStart]) === null || _b === void 0 ? void 0 : _b.line) === prevLineSegment) {\n            lines[lineStart].color.x = value / 255;\n            lineStart += 1;\n        }\n    }\n});\nlineSegmentColorInputGreen.addEventListener('change', (e) => {\n    var _a, _b;\n    const value = (_a = Number(e.target.value)) !== null && _a !== void 0 ? _a : -1;\n    if (currentComonentId !== 0 &&\n        (value >= 0 || value < 256)) {\n        let lineStart = currentLineStart;\n        lineSegmentColorViewerGreen.style.backgroundColor = `rgb(${0}, ${value}, ${0})`;\n        lineSegmentColorViewerResult.style.backgroundColor = `rgb(${lines[lineStart].color.x * 255}, ${value}, ${lines[lineStart].color.z * 255})`;\n        while (lineStart < lines.length && ((_b = lines[lineStart]) === null || _b === void 0 ? void 0 : _b.line) === prevLineSegment) {\n            lines[lineStart].color.y = value / 255;\n            lineStart += 1;\n        }\n    }\n});\nlineSegmentColorInputBlue.addEventListener('change', (e) => {\n    var _a, _b;\n    const value = (_a = Number(e.target.value)) !== null && _a !== void 0 ? _a : -1;\n    if (currentComonentId !== 0 &&\n        (value >= 0 || value < 256)) {\n        let lineStart = currentLineStart;\n        lineSegmentColorViewerBlue.style.backgroundColor = `rgb(${0}, ${0}, ${value})`;\n        lineSegmentColorViewerResult.style.backgroundColor = `rgb(${lines[lineStart].color.x * 255}, ${lines[lineStart].color.y * 255}, ${value})`;\n        while (lineStart < lines.length && ((_b = lines[lineStart]) === null || _b === void 0 ? void 0 : _b.line) === prevLineSegment) {\n            lines[lineStart].color.z = value / 255;\n            lineStart += 1;\n        }\n    }\n});\nbuttonSelectMode.addEventListener('click', () => {\n    buttonSelectMode.disabled = true;\n    buttonLineMode.disabled = false;\n    buttonCircleMode.disabled = false;\n    if (drawingLine) {\n        drawingLine = false;\n        lines.pop();\n        lineCount += 1;\n    }\n    drawingCirle = false;\n    mode = DrawMode.select;\n});\nbuttonLineMode.addEventListener('click', () => {\n    buttonSelectMode.disabled = false;\n    buttonLineMode.disabled = true;\n    buttonCircleMode.disabled = false;\n    drawingCirle = false;\n    mode = DrawMode.line;\n});\nbuttonCircleMode.addEventListener('click', () => {\n    buttonSelectMode.disabled = false;\n    buttonLineMode.disabled = false;\n    buttonCircleMode.disabled = true;\n    if (drawingLine) {\n        drawingLine = false;\n        lines.pop();\n        lineCount += 1;\n    }\n    mode = DrawMode.circle;\n});\n// let cancel = null;\n// TODO: check with glm about transpose projection\nconst projectionMatrix = ((0, matix_1.createPerspectiveMatrix)(fovy, aspect, near, far));\nfunction loop() {\n    requestAnimationFrame(loop);\n    handleEvents();\n    let viewMatrix = (0, matix_1.createUnitMatrix)(1.0);\n    viewMatrix = (0, matix_1.multiplyMatrix)(viewMatrix, (0, matix_1.createRotationMatrix)(0, 0, 0)); // rotate\n    viewMatrix = (0, matix_1.multiplyMatrix)(viewMatrix, (0, matix_1.createTranslationMatrix)(cameraPosition.x, cameraPosition.y, cameraPosition.z)); // translate\n    const isCameraUpdated = updateCamera();\n    if (isCameraUpdated) {\n        onCamerUpdate();\n    }\n    renderer.beginScene(projectionMatrix, (0, matix_1.transposeMatrix)(viewMatrix));\n    renderLines();\n    renderCircles();\n    renderer.endScene();\n    updateHTML();\n}\n// setTimeout(() => {\n//   cancelAnimationFrame(cancel);\n// }, 3000);\nloop();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWFpbi50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxjQUFjLG1CQUFPLENBQUMscUNBQVk7QUFDbEMsZ0JBQWdCLG1CQUFPLENBQUMseUNBQWM7QUFDdEMsZ0JBQWdCLG1CQUFPLENBQUMseUNBQWM7QUFDdEMsaUJBQWlCLG1CQUFPLENBQUMsMkNBQWU7QUFDeEMsdUJBQXVCLG1CQUFPLENBQUMseURBQXNCO0FBQ3JELGdCQUFnQixtQkFBTyxDQUFDLDJDQUFlO0FBQ3ZDLG1CQUFtQixtQkFBTyxDQUFDLG1EQUFtQjtBQUM5QyxxQkFBcUIsbUJBQU8sQ0FBQyx1REFBcUI7QUFDbEQsZ0JBQWdCLG1CQUFPLENBQUMsNkNBQWdCO0FBQ3hDLGtCQUFrQixtQkFBTyxDQUFDLCtDQUFpQjtBQUMzQyxpQkFBaUIsbUJBQU8sQ0FBQyw2Q0FBZ0I7QUFDekMsdUJBQXVCLG1CQUFPLENBQUMsMkRBQXVCO0FBQ3RELGlCQUFpQixtQkFBTyxDQUFDLCtDQUFpQjtBQUMxQyxpQkFBaUIsbUJBQU8sQ0FBQywrQ0FBaUI7QUFDMUMsZ0JBQWdCLG1CQUFPLENBQUMsMkNBQWU7QUFDdkMsMkJBQTJCLG1CQUFPLENBQUMsZ0VBQTJCO0FBQzlELDZCQUE2QixtQkFBTyxDQUFDLG9FQUE2QjtBQUNsRSwwQkFBMEIsbUJBQU8sQ0FBQyw4REFBMEI7QUFDNUQsNEJBQTRCLG1CQUFPLENBQUMsa0VBQTRCO0FBQ2hFLDhCQUE4QixtQkFBTyxDQUFDLHNFQUE4QjtBQUNwRSw2QkFBNkIsbUJBQU8sQ0FBQyxvRUFBNkI7QUFDbEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyw0QkFBNEI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixZQUFZO0FBQ3BDLHlCQUF5QixhQUFhO0FBQ3RDLHlDQUF5QyxrQkFBa0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1QkFBdUI7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isa0JBQWtCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvQkFBb0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixZQUFZO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxnQkFBZ0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELHNFQUFzRTtBQUNySTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsaUJBQWlCLEtBQUssZ0JBQWdCO0FBQ2xHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrREFBK0QsVUFBVTtBQUN6RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSx3QkFBd0IsSUFBSSxFQUFFLElBQUksRUFBRTtBQUNyRztBQUNBLG1FQUFtRSxFQUFFLElBQUksd0JBQXdCLElBQUksRUFBRTtBQUN2RztBQUNBLGtFQUFrRSxFQUFFLElBQUksRUFBRSxJQUFJLHdCQUF3QjtBQUN0RyxvRUFBb0Usd0JBQXdCLElBQUksd0JBQXdCLElBQUksd0JBQXdCO0FBQ3BKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELDRCQUE0Qiw4QkFBOEIscUNBQXFDO0FBQ3BKLHVEQUF1RCw2QkFBNkIsOEJBQThCLHNDQUFzQztBQUN4SjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsTUFBTSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQ25GLG9FQUFvRSxNQUFNLElBQUksK0JBQStCLElBQUksK0JBQStCO0FBQ2hKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUVBQW1FLEVBQUUsSUFBSSxNQUFNLElBQUksRUFBRTtBQUNyRixvRUFBb0UsK0JBQStCLElBQUksTUFBTSxJQUFJLCtCQUErQjtBQUNoSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtFQUFrRSxFQUFFLElBQUksRUFBRSxJQUFJLE1BQU07QUFDcEYsb0VBQW9FLCtCQUErQixJQUFJLCtCQUErQixJQUFJLE1BQU07QUFDaEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNHQUFzRztBQUN0RyxzSkFBc0o7QUFDdEo7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL21haW4udHM/MzRkMyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNvbnN0IHZlY18xID0gcmVxdWlyZShcIi4vbWF0aC92ZWNcIik7XG5jb25zdCBtYXRpeF8xID0gcmVxdWlyZShcIi4vbWF0aC9tYXRpeFwiKTtcbmNvbnN0IHV0aWxzXzEgPSByZXF1aXJlKFwiLi9tYXRoL3V0aWxzXCIpO1xuY29uc3Qgc2NyZWVuXzEgPSByZXF1aXJlKFwiLi9tYXRoL3NjcmVlblwiKTtcbmNvbnN0IGNhbnZhc19ldmVudF8xID0gcmVxdWlyZShcIi4vZXZlbnQvY2FudmFzLWV2ZW50XCIpO1xuY29uc3QgY29uc3RfMSA9IHJlcXVpcmUoXCIuL2V2ZW50L2NvbnN0XCIpO1xuY29uc3QgcmVuZGVyZXJfMSA9IHJlcXVpcmUoXCIuL3JlbmRlci9yZW5kZXJlclwiKTtcbmNvbnN0IGNvbXBvbmVudHNfMSA9IHJlcXVpcmUoXCIuL3JlbmRlci9jb21wb25lbnRzXCIpO1xuY29uc3QgY29uc3RfMiA9IHJlcXVpcmUoXCIuL3JlbmRlci9jb25zdFwiKTtcbmNvbnN0IHVuaXFlSWRfMSA9IHJlcXVpcmUoXCIuL3V0aWxzL3VuaXFlSWRcIik7XG5jb25zdCBtZW1vcnlfMSA9IHJlcXVpcmUoXCIuL3V0aWxzL21lbW9yeVwiKTtcbmNvbnN0IHNoYWRlcl9zdG9yZV8xID0gcmVxdWlyZShcIi4vcmVuZGVyL3NoYWRlci1zdG9yZVwiKTtcbmNvbnN0IHNoYWRlcl8xID0gcmVxdWlyZShcIi4vcmVuZGVyL3NoYWRlclwiKTtcbmNvbnN0IGdsX2FwaV8xID0gcmVxdWlyZShcIi4vcmVuZGVyL2dsLWFwaVwiKTtcbmNvbnN0IGFycmF5XzEgPSByZXF1aXJlKFwiLi91dGlscy9hcnJheVwiKTtcbmNvbnN0IGxpbmVfdmVydGV4X2dsc2xfMSA9IHJlcXVpcmUoXCIuL2Fzc2V0cy9saW5lLXZlcnRleC5nbHNsXCIpO1xuY29uc3QgY2lyY2xlX3ZlcnRleF9nbHNsXzEgPSByZXF1aXJlKFwiLi9hc3NldHMvY2lyY2xlLXZlcnRleC5nbHNsXCIpO1xuY29uc3QgbGluZV9waXhlbF9nbHNsXzEgPSByZXF1aXJlKFwiLi9hc3NldHMvbGluZS1waXhlbC5nbHNsXCIpO1xuY29uc3QgY2lyY2xlX3BpeGVsX2dsc2xfMSA9IHJlcXVpcmUoXCIuL2Fzc2V0cy9jaXJjbGUtcGl4ZWwuZ2xzbFwiKTtcbmNvbnN0IHRleHR1cmVfdmVydGV4X2dsc2xfMSA9IHJlcXVpcmUoXCIuL2Fzc2V0cy90ZXh0dXJlLXZlcnRleC5nbHNsXCIpO1xuY29uc3QgdGV4dHVyZV9waXhlbF9nbHNsXzEgPSByZXF1aXJlKFwiLi9hc3NldHMvdGV4dHVyZS1waXhlbC5nbHNsXCIpO1xuY29uc3QgZ2V0TmV3SWQgPSAoMCwgdW5pcWVJZF8xLmNyZWF0ZVVuaXFlSWRHZW5lcmF0b3IpKDEpO1xubGV0IHByZXZDb21wb25lbnRJZCA9IC0xO1xubGV0IHByZXZMaW5lU2VnbWVudCA9IC0xO1xubGV0IHByZXZSZW5kZXJlclN0YXQgPSB7XG4gICAgZmx1c2hlZFNxdXJlczogLTEsXG4gICAgZmx1c2hlZENpcmNsZXM6IC0xLFxuICAgIGZsdXNoZWRCYXRjaFNxdXJlc0NvdW50OiAtMSxcbiAgICBmbHVzaGVkQmF0Y2hDaXJjbGVzQ291bnQ6IC0xLFxufTtcbmxldCBjdXJyZW50Q29tb25lbnRJZCA9IDA7XG5sZXQgY3VycmVudExpbmVTdGFydCA9IC0xO1xuY29uc3QgcHJldk1vdXNlUG9zaXRpb24gPSAoMCwgdmVjXzEuY3JlYXRlVmVjMikoLTEsIC0xKTtcbmNvbnN0IG1vdXNlUG9zaXRpb24gPSAoMCwgdmVjXzEuY3JlYXRlVmVjMikoMCwgMCk7XG52YXIgRHJhd01vZGU7XG4oZnVuY3Rpb24gKERyYXdNb2RlKSB7XG4gICAgRHJhd01vZGVbXCJzZWxlY3RcIl0gPSBcInNlbGVjdFwiO1xuICAgIERyYXdNb2RlW1wibGluZVwiXSA9IFwibGluZVwiO1xuICAgIERyYXdNb2RlW1wiY2lyY2xlXCJdID0gXCJjaXJjbGVcIjtcbn0pKERyYXdNb2RlIHx8IChEcmF3TW9kZSA9IHt9KSk7XG5sZXQgbW9kZSA9IERyYXdNb2RlLnNlbGVjdDtcbmNvbnN0IGxpbmVzID0gW107XG5jb25zdCBjaXJjbGVzID0gW107XG5jb25zdCBzY3JlZW5XaWR0aCA9IDYwMDtcbmNvbnN0IHNjcmVlbkhlaWdodCA9IDQwMDtcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKTtcbmNvbnN0IGNvbXBvbmVudElkVmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbXBvbmVudC1pZCcpO1xuY29uc3QgbW91c2VQb3N0aW9uVmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vdXNlLXBvc2l0aW9uJyk7XG5jb25zdCBsaW5lQ291bnRWaWV3ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1jb3VudCcpO1xuY29uc3QgbGluZVNlZ21lbnRWaWV3ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1zZWdtZW50LWlkJyk7XG5jb25zdCBjaXJjbGVDb3VudFZpZXdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaXJjbGUtY291bnQnKTtcbmNvbnN0IGxpbmVTZWdtZW50Q29sb3JJbnB1dFJlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLXNlZ21lbnQtY29sb3ItaW5wdXQtcmVkJyk7XG5jb25zdCBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtc2VnbWVudC1jb2xvci12aWV3ZXItcmVkJyk7XG5jb25zdCBsaW5lU2VnbWVudENvbG9ySW5wdXRHcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLXNlZ21lbnQtY29sb3ItaW5wdXQtZ3JlZW4nKTtcbmNvbnN0IGxpbmVTZWdtZW50Q29sb3JWaWV3ZXJHcmVlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLXNlZ21lbnQtY29sb3Itdmlld2VyLWdyZWVuJyk7XG5jb25zdCBsaW5lU2VnbWVudENvbG9ySW5wdXRCbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpbmUtc2VnbWVudC1jb2xvci1pbnB1dC1ibHVlJyk7XG5jb25zdCBsaW5lU2VnbWVudENvbG9yVmlld2VyQmx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaW5lLXNlZ21lbnQtY29sb3Itdmlld2VyLWJsdWUnKTtcbmNvbnN0IGxpbmVTZWdtZW50Q29sb3JWaWV3ZXJSZXN1bHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGluZS1zZWdtZW50LWNvbG9yLXZpZXdlci1yZXN1bHQnKTtcbmNvbnN0IGJ1dHRvblNlbGVjdE1vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0LW1vZGUtc2VsZWN0Jyk7XG5jb25zdCBidXR0b25MaW5lTW9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3QtbW9kZS1kcmF3bGluZScpO1xuY29uc3QgYnV0dG9uQ2lyY2xlTW9kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3QtbW9kZS1kcmF3Y2lyY2xlJyk7XG5idXR0b25TZWxlY3RNb2RlLmRpc2FibGVkID0gbW9kZSA9PT0gRHJhd01vZGUuc2VsZWN0O1xuYnV0dG9uTGluZU1vZGUuZGlzYWJsZWQgPSBtb2RlID09PSBEcmF3TW9kZS5saW5lO1xuYnV0dG9uQ2lyY2xlTW9kZS5kaXNhYmxlZCA9IG1vZGUgPT09IERyYXdNb2RlLmNpcmNsZTtcbmNhbnZhcy53aWR0aCA9IHNjcmVlbldpZHRoO1xuY2FudmFzLmhlaWdodCA9IHNjcmVlbkhlaWdodDtcbmNhbnZhcy5zdHlsZS53aWR0aCA9IGAke3NjcmVlbldpZHRofXB4YDtcbmNhbnZhcy5zdHlsZS5oZWlnaHQgPSBgJHtzY3JlZW5IZWlnaHR9cHhgO1xuY29uc3QgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wyJywgeyBhbnRpYWxpYXM6IGZhbHNlIH0pO1xuc2hhZGVyX3N0b3JlXzEuc2hhZGVyU3RvcmUuc2V0UHJvZ3JhbShzaGFkZXJfc3RvcmVfMS5TaGFkZXJQcm9ncmFtSW5kZXgudGV4dHVyZSwgbmV3IHNoYWRlcl8xLkdMUHJvZ3JhbShnbCwgKDAsIGdsX2FwaV8xLmNyZWF0ZVZlcnRleEdMU2hhZGVyKShnbCwgdGV4dHVyZV92ZXJ0ZXhfZ2xzbF8xLmRlZmF1bHQpLCAoMCwgZ2xfYXBpXzEuY3JlYXRlRnJhZ21lbnRHTFNoYWRlcikoZ2wsIHRleHR1cmVfcGl4ZWxfZ2xzbF8xLmRlZmF1bHQpKSk7XG5zaGFkZXJfc3RvcmVfMS5zaGFkZXJTdG9yZS5zZXRQcm9ncmFtKHNoYWRlcl9zdG9yZV8xLlNoYWRlclByb2dyYW1JbmRleC5zcXVhcmUsIG5ldyBzaGFkZXJfMS5HTFByb2dyYW0oZ2wsICgwLCBnbF9hcGlfMS5jcmVhdGVWZXJ0ZXhHTFNoYWRlcikoZ2wsIGxpbmVfdmVydGV4X2dsc2xfMS5kZWZhdWx0KSwgKDAsIGdsX2FwaV8xLmNyZWF0ZUZyYWdtZW50R0xTaGFkZXIpKGdsLCBsaW5lX3BpeGVsX2dsc2xfMS5kZWZhdWx0KSkpO1xuc2hhZGVyX3N0b3JlXzEuc2hhZGVyU3RvcmUuc2V0UHJvZ3JhbShzaGFkZXJfc3RvcmVfMS5TaGFkZXJQcm9ncmFtSW5kZXguY2lyY2xlLCBuZXcgc2hhZGVyXzEuR0xQcm9ncmFtKGdsLCAoMCwgZ2xfYXBpXzEuY3JlYXRlVmVydGV4R0xTaGFkZXIpKGdsLCBjaXJjbGVfdmVydGV4X2dsc2xfMS5kZWZhdWx0KSwgKDAsIGdsX2FwaV8xLmNyZWF0ZUZyYWdtZW50R0xTaGFkZXIpKGdsLCBjaXJjbGVfcGl4ZWxfZ2xzbF8xLmRlZmF1bHQpKSk7XG5jb25zdCByZW5kZXJlciA9IG5ldyByZW5kZXJlcl8xLlJlbmRlcmVyKGdsLCBzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0KTtcbmNvbnN0IG5lYXIgPSAwLjE7XG5jb25zdCBmYXIgPSAxMC4wO1xuY29uc3QgZm92eSA9ICgwLCB1dGlsc18xLnRvUmFkaWFucykoNDUpO1xuY29uc3QgYXNwZWN0ID0gc2NyZWVuV2lkdGggLyBzY3JlZW5IZWlnaHQ7XG5jb25zdCBjYW1lcmFQb3NpdGlvbiA9ICgwLCB2ZWNfMS5jcmVhdGVWZWMzKSgwLCAwLCAwKTtcbmNvbnN0IHsga2V5Ym9hcmQsIGV2ZW50U3RhY2sgfSA9ICgwLCBjYW52YXNfZXZlbnRfMS5iaW5kRXZlbnRzKShjYW52YXMsIGNhbWVyYVBvc2l0aW9uLCBjb25zdF8yLnBhaXRpbmdMYXllciwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCwgZm92eSwgYXNwZWN0LCBtb3VzZVBvc2l0aW9uKTtcbmxldCBkcmF3aW5nTGluZSA9IGZhbHNlO1xubGV0IGRyYXdpbmdDaXJsZSA9IGZhbHNlO1xubGV0IGxpbmVDb3VudCA9IDA7XG5mdW5jdGlvbiBmaW5kTGluZVN0YXJ0SW5kZXgobGluZUluZGV4LCBsaW5lSWQpIHtcbiAgICB2YXIgX2E7XG4gICAgd2hpbGUgKGxpbmVJbmRleCA+IDAgJiYgKChfYSA9IGxpbmVzW2xpbmVJbmRleCAtIDFdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGluZSkgPT09IGxpbmVJZCkge1xuICAgICAgICBsaW5lSW5kZXggLT0gMTtcbiAgICB9XG4gICAgcmV0dXJuIGxpbmVJbmRleDtcbn1cbmZ1bmN0aW9uIHVwZGF0ZUNhbWVyYSgpIHtcbiAgICBsZXQgaXNVcGRhdGVkID0gZmFsc2U7XG4gICAgLy8gVE9ETzogdXNlIG1vcmUgY29udmluaWVudCBmdW5jXG4gICAgbGV0IHVwZGF0ZVZhbHVlID0gTWF0aC5zaW4oKDAsIHV0aWxzXzEudG9SYWRpYW5zKSgoKGNhbWVyYVBvc2l0aW9uLnogKyAyLjgpIC8gOS4wICogOC4wKSArIDI3MC4wICsgMTEuMCkpICsgMS4wO1xuICAgIHVwZGF0ZVZhbHVlID0gTWF0aC5tYXgodXBkYXRlVmFsdWUsIDAuMDA1KTtcbiAgICAvLyBUT0RPOiBjaGFuZ2UgbGluZSBlbmQgd2hpbGUgZHJhd2luZyBsaW5lIGFuZCB6b29taW5nIGluL291dFxuICAgIGlmIChrZXlib2FyZFtjb25zdF8xLktleWJvYXJkS2V5Q29kZS53S2V5XSkge1xuICAgICAgICBjYW1lcmFQb3NpdGlvbi56ID0gY2FtZXJhUG9zaXRpb24ueiAtIHVwZGF0ZVZhbHVlIDwgLTIuOCA/IC0yLjggOiBjYW1lcmFQb3NpdGlvbi56IC0gdXBkYXRlVmFsdWU7XG4gICAgICAgIGlzVXBkYXRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChrZXlib2FyZFtjb25zdF8xLktleWJvYXJkS2V5Q29kZS5zS2V5XSkge1xuICAgICAgICBjYW1lcmFQb3NpdGlvbi56ID0gY2FtZXJhUG9zaXRpb24ueiArIHVwZGF0ZVZhbHVlID4gNi4wID8gNi4wIDogY2FtZXJhUG9zaXRpb24ueiArIHVwZGF0ZVZhbHVlO1xuICAgICAgICBpc1VwZGF0ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAoa2V5Ym9hcmRbY29uc3RfMS5LZXlib2FyZEtleUNvZGUuZEtleV0pIHtcbiAgICAgICAgY2FtZXJhUG9zaXRpb24ueCArPSB1cGRhdGVWYWx1ZTtcbiAgICAgICAgaXNVcGRhdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGtleWJvYXJkW2NvbnN0XzEuS2V5Ym9hcmRLZXlDb2RlLmFLZXldKSB7XG4gICAgICAgIGNhbWVyYVBvc2l0aW9uLnggLT0gdXBkYXRlVmFsdWU7XG4gICAgICAgIGlzVXBkYXRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChrZXlib2FyZFtjb25zdF8xLktleWJvYXJkS2V5Q29kZS5zcGFjZUtleV0pIHtcbiAgICAgICAgY2FtZXJhUG9zaXRpb24ueSArPSB1cGRhdGVWYWx1ZTtcbiAgICAgICAgaXNVcGRhdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKGtleWJvYXJkW2NvbnN0XzEuS2V5Ym9hcmRLZXlDb2RlLnpLZXldKSB7XG4gICAgICAgIGNhbWVyYVBvc2l0aW9uLnkgLT0gdXBkYXRlVmFsdWU7XG4gICAgICAgIGlzVXBkYXRlZCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBpc1VwZGF0ZWQ7XG59XG5mdW5jdGlvbiByZW5kZXJMaW5lcygpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgcmVuZGVyZXIuZHJhd0xpbmUobGluZSk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgY29uc3QgbmV4dExpbmVzID0gbGluZXNbaSArIDFdO1xuICAgICAgICBpZiAobGluZS5saW5lID09PSBuZXh0TGluZXMubGluZSkge1xuICAgICAgICAgICAgY29uc3QgY2lyY2xlID0ge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXh0TGluZXMucG9zaXRpb24sIGNvbG9yOiBsaW5lLmNvbG9yLCByYWRpdXM6IDAuMSAvIDIsIGlkOiBsaW5lLmlkXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVuZGVyZXIuZHJhd0NpcmNsZShjaXJjbGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcmVuZGVyQ2lyY2xlcygpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNpcmNsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2lyY2xlID0gY2lyY2xlc1tpXTtcbiAgICAgICAgcmVuZGVyZXIuZHJhd0NpcmNsZShjaXJjbGUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGhhbmRsZU1vdXNlTW92ZUZvckxpbmVEcmF3aW5nKGNvb3JkKSB7XG4gICAgY29uc3QgbGFzdExpbmUgPSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBsZW5ndGhYID0gY29vcmQueCAtIGxhc3RMaW5lLnBvc2l0aW9uLng7XG4gICAgY29uc3QgbGVuZ3RoWSA9IGNvb3JkLnkgLSBsYXN0TGluZS5wb3NpdGlvbi55O1xuICAgIGxldCBhbmdsZSA9ICgwLCBzY3JlZW5fMS5nZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbikobGVuZ3RoWCwgbGVuZ3RoWSk7XG4gICAgbGV0IGxpbmVMZW5ndGggPSAwLjA7XG4gICAgaWYgKGFuZ2xlID09PSA5MCB8fCBhbmdsZSA9PT0gMjcwKSB7XG4gICAgICAgIGxpbmVMZW5ndGggPSBsZW5ndGhZO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbGluZUxlbmd0aCA9IChsZW5ndGhYKSAvIE1hdGguY29zKCgwLCB1dGlsc18xLnRvUmFkaWFucykoYW5nbGUpKTtcbiAgICB9XG4gICAgbGFzdExpbmUubGVuZ3RoID0gbGluZUxlbmd0aDtcbiAgICBsYXN0TGluZS5yb3RhdGUgPSBhbmdsZTtcbn1cbmZ1bmN0aW9uIGhhbmRsZUV2ZW50cygpIHtcbiAgICBsZXQgaSA9IDA7XG4gICAgd2hpbGUgKGkgPCBldmVudFN0YWNrLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBldmVudCA9IGV2ZW50U3RhY2tbaV07XG4gICAgICAgIGlmIChtb2RlID09PSBEcmF3TW9kZS5zZWxlY3QpIHtcbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vkb3duJykge1xuICAgICAgICAgICAgICAgIHByZXZDb21wb25lbnRJZCA9IGN1cnJlbnRDb21vbmVudElkO1xuICAgICAgICAgICAgICAgIGNvbnN0IGlkRGF0YVJlYWRlciA9IHJlbmRlcmVyLmdldElkRGF0YVJlYWRlcigpO1xuICAgICAgICAgICAgICAgIGlkRGF0YVJlYWRlci5iaW5kKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgYiA9IHJlbmRlcmVyLmdldElkRGF0YVJlYWRlcigpLnJlYWRQaXhlbChtb3VzZVBvc2l0aW9uLngsIHNjcmVlbkhlaWdodCAtIG1vdXNlUG9zaXRpb24ueSk7XG4gICAgICAgICAgICAgICAgaWREYXRhUmVhZGVyLnVuYmluZCgpO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDb21vbmVudElkID0gKDAsIG1lbW9yeV8xLmludGVycHJldEFzSW50MzIpKGJbMF0sIGJbMV0sIGJbMl0sIGJbM10pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlID09PSBEcmF3TW9kZS5saW5lKSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ21vdXNlZG93bicgJiYgIWRyYXdpbmdMaW5lKSB7XG4gICAgICAgICAgICAgICAgZHJhd2luZ0xpbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IDAuMDE7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaCgoMCwgY29tcG9uZW50c18xLmNyZWF0ZUxpbmUpKCgwLCB2ZWNfMS5jcmVhdGVWZWMyKShldmVudC54LCBldmVudC55KSwgbGVuZ3RoLCBnZXROZXdJZCgpKSk7XG4gICAgICAgICAgICAgICAgbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGluZSA9IGxpbmVDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGV2ZW50LnR5cGUgPT09ICdtb3VzZWRvd24nICYmIGRyYXdpbmdMaW5lKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdExpbmUgPSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBjb25zdCBsZW5ndGhYID0gZXZlbnQueCAtIGxhc3RMaW5lLnBvc2l0aW9uLng7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuZ3RoWSA9IGV2ZW50LnkgLSBsYXN0TGluZS5wb3NpdGlvbi55O1xuICAgICAgICAgICAgICAgIGxldCBhbmdsZSA9ICgwLCBzY3JlZW5fMS5nZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbikobGVuZ3RoWCwgbGVuZ3RoWSk7XG4gICAgICAgICAgICAgICAgbGV0IGxpbmVMZW5ndGggPSAwLjA7XG4gICAgICAgICAgICAgICAgaWYgKGFuZ2xlID09PSA5MCB8fCBhbmdsZSA9PT0gMjcwKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVMZW5ndGggPSBsZW5ndGhZO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZUxlbmd0aCA9IChsZW5ndGhYKSAvIE1hdGguY29zKCgwLCB1dGlsc18xLnRvUmFkaWFucykoYW5nbGUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gVE9ETzogZmluZCBvdXQgbGluZWFyIHRyYW5zZm9ybWF0aW9uLCB0cmFuc2Zvcm0gc2NyZWVuIGNvcmRpbmF0aW9uIHRvIHdvcmxkICh1c2UgaW52ZXJzZSBwcm9qZWN0aW9uIG1hdHJpeClcbiAgICAgICAgICAgICAgICBsYXN0TGluZS5sZW5ndGggPSBsaW5lTGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxhc3RMaW5lLnJvdGF0ZSA9IGFuZ2xlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IDAuMDE7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaCgoMCwgY29tcG9uZW50c18xLmNyZWF0ZUxpbmUpKCgwLCB2ZWNfMS5jcmVhdGVWZWMyKShldmVudC54LCBldmVudC55KSwgbGVuZ3RoLCBnZXROZXdJZCgpKSk7XG4gICAgICAgICAgICAgICAgbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGluZSA9IGxpbmVDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vtb3ZlJyAmJiBkcmF3aW5nTGluZSkge1xuICAgICAgICAgICAgICAgIGhhbmRsZU1vdXNlTW92ZUZvckxpbmVEcmF3aW5nKGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAna2V5cHJlc3MnICYmIGV2ZW50LmtleSA9PT0gJ0VudGVyJyAmJiBkcmF3aW5nTGluZSkge1xuICAgICAgICAgICAgICAgIGRyYXdpbmdMaW5lID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgbGluZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgbGluZUNvdW50ICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vZGUgPT09IERyYXdNb2RlLmNpcmNsZSkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdtb3VzZWRvd24nICYmICFkcmF3aW5nQ2lybGUpIHtcbiAgICAgICAgICAgICAgICBjaXJjbGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGV2ZW50LngsIGV2ZW50LnkpLFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogKDAsIHZlY18xLmNyZWF0ZVZlYzMpKDEuMCwgMS4wLCAxLjApLFxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDAuMSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGdldE5ld0lkKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBkcmF3aW5nQ2lybGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdtb3VzZW1vdmUnICYmIGRyYXdpbmdDaXJsZSkge1xuICAgICAgICAgICAgICAgIGNpcmNsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAoMCwgdmVjXzEuY3JlYXRlVmVjMikoZXZlbnQueCwgZXZlbnQueSksXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAoMCwgdmVjXzEuY3JlYXRlVmVjMykoMS4wLCAxLjAsIDEuMCksXG4gICAgICAgICAgICAgICAgICAgIHJhZGl1czogMC4xLFxuICAgICAgICAgICAgICAgICAgICBpZDogZ2V0TmV3SWQoKVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdtb3VzZXVwJyAmJiBkcmF3aW5nQ2lybGUpIHtcbiAgICAgICAgICAgICAgICBkcmF3aW5nQ2lybGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpKys7XG4gICAgfVxuICAgIGxldCBsZW5ndGggPSBldmVudFN0YWNrLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGV2ZW50U3RhY2sucG9wKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gb25DYW1lclVwZGF0ZSgpIHtcbiAgICBpZiAoZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgY29uc3QgY29vcmQgPSAoMCwgdmVjXzEuY3JlYXRlVmVjMikobW91c2VQb3NpdGlvbi54LCBtb3VzZVBvc2l0aW9uLnkpO1xuICAgICAgICAoMCwgc2NyZWVuXzEuY29udmVydFNjcmVlbkNvb3JkVG9Xb3JsZENvb3JkKShjb29yZCwgY2FtZXJhUG9zaXRpb24sIGNvbnN0XzIucGFpdGluZ0xheWVyLCBzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0LCBmb3Z5LCBhc3BlY3QpO1xuICAgICAgICBoYW5kbGVNb3VzZU1vdmVGb3JMaW5lRHJhd2luZyhjb29yZCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlSFRNTCgpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGlmIChwcmV2Q29tcG9uZW50SWQgIT09IGN1cnJlbnRDb21vbmVudElkICYmIGN1cnJlbnRDb21vbmVudElkID09PSAwKSB7XG4gICAgICAgIHByZXZMaW5lU2VnbWVudCA9IC0xO1xuICAgICAgICBjdXJyZW50TGluZVN0YXJ0ID0gLTE7XG4gICAgICAgIGxpbmVTZWdtZW50Vmlld2VyLmlubmVyVGV4dCA9IGBjdXJyZW50IGxpbmUgc2VnbWVudDogJHtwcmV2TGluZVNlZ21lbnR9YDtcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvcklucHV0UmVkLnZhbHVlID0gJzAnO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMCwgMCwgMCknO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9ySW5wdXRHcmVlbi52YWx1ZSA9ICcwJztcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvclZpZXdlckdyZWVuLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZ2IoMCwgMCwgMCknO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9ySW5wdXRCbHVlLnZhbHVlID0gJzAnO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyQmx1ZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKDAsIDAsIDApJztcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvclZpZXdlclJlc3VsdC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmdiKDAsIDAsIDApJztcbiAgICB9XG4gICAgaWYgKHByZXZDb21wb25lbnRJZCAhPT0gY3VycmVudENvbW9uZW50SWQpIHtcbiAgICAgICAgY29tcG9uZW50SWRWaWV3ZXIuaW5uZXJUZXh0ID0gYGN1cnJlbnQgY29tcG9uZW50IGlkOiAke2N1cnJlbnRDb21vbmVudElkID09PSAwID8gJ25vIHNlbGVjdGVkIGNvbXBvbmVudCcgOiBjdXJyZW50Q29tb25lbnRJZH1gO1xuICAgICAgICBwcmV2Q29tcG9uZW50SWQgPSBjdXJyZW50Q29tb25lbnRJZDtcbiAgICB9XG4gICAgaWYgKHByZXZNb3VzZVBvc2l0aW9uLnggIT09IG1vdXNlUG9zaXRpb24ueCB8fCBwcmV2TW91c2VQb3NpdGlvbi55ICE9PSBtb3VzZVBvc2l0aW9uLnkpIHtcbiAgICAgICAgbW91c2VQb3N0aW9uVmlld2VyLmlubmVyVGV4dCA9IGBtb3VzZSBwb3NpdGlvbiB4OiAke21vdXNlUG9zaXRpb24ueH0geTogJHttb3VzZVBvc2l0aW9uLnl9YDtcbiAgICAgICAgcHJldk1vdXNlUG9zaXRpb24ueCA9IG1vdXNlUG9zaXRpb24ueDtcbiAgICAgICAgcHJldk1vdXNlUG9zaXRpb24ueSA9IG1vdXNlUG9zaXRpb24ueTtcbiAgICB9XG4gICAgY29uc3QgY29tcG9uZW50SW5kZXggPSBjdXJyZW50Q29tb25lbnRJZCAhPT0gMCA/IChfYSA9ICgwLCBhcnJheV8xLmJpbmFyeUZpbmQpKGxpbmVzLCAwLCBsaW5lcy5sZW5ndGgsIGwgPT4gY3VycmVudENvbW9uZW50SWQgLSBsLmlkKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogLTEgOiAtMTtcbiAgICBpZiAoY3VycmVudENvbW9uZW50SWQgIT09IDAgJiZcbiAgICAgICAgY29tcG9uZW50SW5kZXggIT09IC0xICYmXG4gICAgICAgIHByZXZMaW5lU2VnbWVudCAhPT0gKChfYiA9IGxpbmVzW2NvbXBvbmVudEluZGV4XSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmxpbmUpKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tjb21wb25lbnRJbmRleF07XG4gICAgICAgIGxpbmVTZWdtZW50Vmlld2VyLmlubmVyVGV4dCA9IGBjdXJyZW50IGxpbmUgc2VnbWVudDogJHtsaW5lLmxpbmV9YDtcbiAgICAgICAgcHJldkxpbmVTZWdtZW50ID0gbGluZS5saW5lO1xuICAgICAgICBjb25zdCBsaW5lU3RhcnRJbmRleCA9IGZpbmRMaW5lU3RhcnRJbmRleChjb21wb25lbnRJbmRleCwgbGluZS5saW5lKTtcbiAgICAgICAgY29uc3QgbGluZVN0YXJ0ID0gbGluZXNbbGluZVN0YXJ0SW5kZXhdO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9ySW5wdXRSZWQudmFsdWUgPSBTdHJpbmcobGluZVN0YXJ0LmNvbG9yLnggKiAyNTUpO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2IoJHtsaW5lU3RhcnQuY29sb3IueCAqIDI1NX0sICR7MH0sICR7MH0pYDtcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvcklucHV0R3JlZW4udmFsdWUgPSBTdHJpbmcobGluZVN0YXJ0LmNvbG9yLnkgKiAyNTUpO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyR3JlZW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYigkezB9LCAke2xpbmVTdGFydC5jb2xvci55ICogMjU1fSwgJHswfSlgO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9ySW5wdXRCbHVlLnZhbHVlID0gU3RyaW5nKGxpbmVTdGFydC5jb2xvci56ICogMjU1KTtcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvclZpZXdlckJsdWUuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYigkezB9LCAkezB9LCAke2xpbmVTdGFydC5jb2xvci56ICogMjU1fSlgO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVzdWx0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2IoJHtsaW5lU3RhcnQuY29sb3IueCAqIDI1NX0sICR7bGluZVN0YXJ0LmNvbG9yLnkgKiAyNTV9LCAke2xpbmVTdGFydC5jb2xvci56ICogMjU1fSlgO1xuICAgICAgICBjdXJyZW50TGluZVN0YXJ0ID0gbGluZVN0YXJ0SW5kZXg7XG4gICAgfVxuICAgIGNvbnN0IHJlbmRlcmVyU3RhdCA9IHJlbmRlcmVyLmdldERyYXdTdGF0KCk7XG4gICAgaWYgKHByZXZSZW5kZXJlclN0YXQuZmx1c2hlZFNxdXJlcyAhPT0gcmVuZGVyZXJTdGF0LmZsdXNoZWRTcXVyZXMgfHxcbiAgICAgICAgcHJldlJlbmRlcmVyU3RhdC5mbHVzaGVkQ2lyY2xlcyAhPT0gcmVuZGVyZXJTdGF0LmZsdXNoZWRDaXJjbGVzIHx8XG4gICAgICAgIHByZXZSZW5kZXJlclN0YXQuZmx1c2hlZEJhdGNoU3F1cmVzQ291bnQgIT09IHJlbmRlcmVyU3RhdC5mbHVzaGVkQmF0Y2hTcXVyZXNDb3VudCB8fFxuICAgICAgICBwcmV2UmVuZGVyZXJTdGF0LmZsdXNoZWRCYXRjaENpcmNsZXNDb3VudCAhPT0gcmVuZGVyZXJTdGF0LmZsdXNoZWRCYXRjaENpcmNsZXNDb3VudCkge1xuICAgICAgICBsaW5lQ291bnRWaWV3ZXIuaW5uZXJUZXh0ID0gYHNxdWFyZSBjb3VudDogJHtyZW5kZXJlclN0YXQuZmx1c2hlZFNxdXJlc30gZmx1c2hlZCBzcXVhcmUgYmF0Y2ggY291bnQ6ICR7cmVuZGVyZXJTdGF0LmZsdXNoZWRCYXRjaFNxdXJlc0NvdW50fWA7XG4gICAgICAgIGNpcmNsZUNvdW50Vmlld2VyLmlubmVyVGV4dCA9IGBjaXJjbGUgY291bnQ6ICR7cmVuZGVyZXJTdGF0LmZsdXNoZWRDaXJjbGVzfSBmbHVzaGVkIGNpcmNsZSBiYXRjaCBjb3VudDogJHtyZW5kZXJlclN0YXQuZmx1c2hlZEJhdGNoQ2lyY2xlc0NvdW50fWA7XG4gICAgICAgIHByZXZSZW5kZXJlclN0YXQgPSByZW5kZXJlclN0YXQ7XG4gICAgfVxufVxubGluZVNlZ21lbnRDb2xvcklucHV0UmVkLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCB2YWx1ZSA9IChfYSA9IE51bWJlcihlLnRhcmdldC52YWx1ZSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IC0xO1xuICAgIGlmIChjdXJyZW50Q29tb25lbnRJZCAhPT0gMCAmJlxuICAgICAgICAodmFsdWUgPj0gMCB8fCB2YWx1ZSA8IDI1NikpIHtcbiAgICAgICAgbGV0IGxpbmVTdGFydCA9IGN1cnJlbnRMaW5lU3RhcnQ7XG4gICAgICAgIGxpbmVTZWdtZW50Q29sb3JWaWV3ZXJSZWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYigke3ZhbHVlfSwgJHswfSwgJHswfSlgO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVzdWx0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2IoJHt2YWx1ZX0sICR7bGluZXNbbGluZVN0YXJ0XS5jb2xvci55ICogMjU1fSwgJHtsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnogKiAyNTV9KWA7XG4gICAgICAgIHdoaWxlIChsaW5lU3RhcnQgPCBsaW5lcy5sZW5ndGggJiYgKChfYiA9IGxpbmVzW2xpbmVTdGFydF0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5saW5lKSA9PT0gcHJldkxpbmVTZWdtZW50KSB7XG4gICAgICAgICAgICBsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnggPSB2YWx1ZSAvIDI1NTtcbiAgICAgICAgICAgIGxpbmVTdGFydCArPSAxO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5saW5lU2VnbWVudENvbG9ySW5wdXRHcmVlbi5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc3QgdmFsdWUgPSAoX2EgPSBOdW1iZXIoZS50YXJnZXQudmFsdWUpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAtMTtcbiAgICBpZiAoY3VycmVudENvbW9uZW50SWQgIT09IDAgJiZcbiAgICAgICAgKHZhbHVlID49IDAgfHwgdmFsdWUgPCAyNTYpKSB7XG4gICAgICAgIGxldCBsaW5lU3RhcnQgPSBjdXJyZW50TGluZVN0YXJ0O1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyR3JlZW4uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gYHJnYigkezB9LCAke3ZhbHVlfSwgJHswfSlgO1xuICAgICAgICBsaW5lU2VnbWVudENvbG9yVmlld2VyUmVzdWx0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2IoJHtsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnggKiAyNTV9LCAke3ZhbHVlfSwgJHtsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnogKiAyNTV9KWA7XG4gICAgICAgIHdoaWxlIChsaW5lU3RhcnQgPCBsaW5lcy5sZW5ndGggJiYgKChfYiA9IGxpbmVzW2xpbmVTdGFydF0pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5saW5lKSA9PT0gcHJldkxpbmVTZWdtZW50KSB7XG4gICAgICAgICAgICBsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnkgPSB2YWx1ZSAvIDI1NTtcbiAgICAgICAgICAgIGxpbmVTdGFydCArPSAxO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5saW5lU2VnbWVudENvbG9ySW5wdXRCbHVlLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChlKSA9PiB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICBjb25zdCB2YWx1ZSA9IChfYSA9IE51bWJlcihlLnRhcmdldC52YWx1ZSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IC0xO1xuICAgIGlmIChjdXJyZW50Q29tb25lbnRJZCAhPT0gMCAmJlxuICAgICAgICAodmFsdWUgPj0gMCB8fCB2YWx1ZSA8IDI1NikpIHtcbiAgICAgICAgbGV0IGxpbmVTdGFydCA9IGN1cnJlbnRMaW5lU3RhcnQ7XG4gICAgICAgIGxpbmVTZWdtZW50Q29sb3JWaWV3ZXJCbHVlLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGByZ2IoJHswfSwgJHswfSwgJHt2YWx1ZX0pYDtcbiAgICAgICAgbGluZVNlZ21lbnRDb2xvclZpZXdlclJlc3VsdC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgcmdiKCR7bGluZXNbbGluZVN0YXJ0XS5jb2xvci54ICogMjU1fSwgJHtsaW5lc1tsaW5lU3RhcnRdLmNvbG9yLnkgKiAyNTV9LCAke3ZhbHVlfSlgO1xuICAgICAgICB3aGlsZSAobGluZVN0YXJ0IDwgbGluZXMubGVuZ3RoICYmICgoX2IgPSBsaW5lc1tsaW5lU3RhcnRdKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IubGluZSkgPT09IHByZXZMaW5lU2VnbWVudCkge1xuICAgICAgICAgICAgbGluZXNbbGluZVN0YXJ0XS5jb2xvci56ID0gdmFsdWUgLyAyNTU7XG4gICAgICAgICAgICBsaW5lU3RhcnQgKz0gMTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYnV0dG9uU2VsZWN0TW9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBidXR0b25TZWxlY3RNb2RlLmRpc2FibGVkID0gdHJ1ZTtcbiAgICBidXR0b25MaW5lTW9kZS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkNpcmNsZU1vZGUuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBpZiAoZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgZHJhd2luZ0xpbmUgPSBmYWxzZTtcbiAgICAgICAgbGluZXMucG9wKCk7XG4gICAgICAgIGxpbmVDb3VudCArPSAxO1xuICAgIH1cbiAgICBkcmF3aW5nQ2lybGUgPSBmYWxzZTtcbiAgICBtb2RlID0gRHJhd01vZGUuc2VsZWN0O1xufSk7XG5idXR0b25MaW5lTW9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBidXR0b25TZWxlY3RNb2RlLmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uTGluZU1vZGUuZGlzYWJsZWQgPSB0cnVlO1xuICAgIGJ1dHRvbkNpcmNsZU1vZGUuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBkcmF3aW5nQ2lybGUgPSBmYWxzZTtcbiAgICBtb2RlID0gRHJhd01vZGUubGluZTtcbn0pO1xuYnV0dG9uQ2lyY2xlTW9kZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBidXR0b25TZWxlY3RNb2RlLmRpc2FibGVkID0gZmFsc2U7XG4gICAgYnV0dG9uTGluZU1vZGUuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25DaXJjbGVNb2RlLmRpc2FibGVkID0gdHJ1ZTtcbiAgICBpZiAoZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgZHJhd2luZ0xpbmUgPSBmYWxzZTtcbiAgICAgICAgbGluZXMucG9wKCk7XG4gICAgICAgIGxpbmVDb3VudCArPSAxO1xuICAgIH1cbiAgICBtb2RlID0gRHJhd01vZGUuY2lyY2xlO1xufSk7XG4vLyBsZXQgY2FuY2VsID0gbnVsbDtcbi8vIFRPRE86IGNoZWNrIHdpdGggZ2xtIGFib3V0IHRyYW5zcG9zZSBwcm9qZWN0aW9uXG5jb25zdCBwcm9qZWN0aW9uTWF0cml4ID0gKCgwLCBtYXRpeF8xLmNyZWF0ZVBlcnNwZWN0aXZlTWF0cml4KShmb3Z5LCBhc3BlY3QsIG5lYXIsIGZhcikpO1xuZnVuY3Rpb24gbG9vcCgpIHtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG4gICAgaGFuZGxlRXZlbnRzKCk7XG4gICAgbGV0IHZpZXdNYXRyaXggPSAoMCwgbWF0aXhfMS5jcmVhdGVVbml0TWF0cml4KSgxLjApO1xuICAgIHZpZXdNYXRyaXggPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodmlld01hdHJpeCwgKDAsIG1hdGl4XzEuY3JlYXRlUm90YXRpb25NYXRyaXgpKDAsIDAsIDApKTsgLy8gcm90YXRlXG4gICAgdmlld01hdHJpeCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh2aWV3TWF0cml4LCAoMCwgbWF0aXhfMS5jcmVhdGVUcmFuc2xhdGlvbk1hdHJpeCkoY2FtZXJhUG9zaXRpb24ueCwgY2FtZXJhUG9zaXRpb24ueSwgY2FtZXJhUG9zaXRpb24ueikpOyAvLyB0cmFuc2xhdGVcbiAgICBjb25zdCBpc0NhbWVyYVVwZGF0ZWQgPSB1cGRhdGVDYW1lcmEoKTtcbiAgICBpZiAoaXNDYW1lcmFVcGRhdGVkKSB7XG4gICAgICAgIG9uQ2FtZXJVcGRhdGUoKTtcbiAgICB9XG4gICAgcmVuZGVyZXIuYmVnaW5TY2VuZShwcm9qZWN0aW9uTWF0cml4LCAoMCwgbWF0aXhfMS50cmFuc3Bvc2VNYXRyaXgpKHZpZXdNYXRyaXgpKTtcbiAgICByZW5kZXJMaW5lcygpO1xuICAgIHJlbmRlckNpcmNsZXMoKTtcbiAgICByZW5kZXJlci5lbmRTY2VuZSgpO1xuICAgIHVwZGF0ZUhUTUwoKTtcbn1cbi8vIHNldFRpbWVvdXQoKCkgPT4ge1xuLy8gICBjYW5jZWxBbmltYXRpb25GcmFtZShjYW5jZWwpO1xuLy8gfSwgMzAwMCk7XG5sb29wKCk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/main.ts\n");

/***/ }),

/***/ "./src/math/matix.ts":
/*!***************************!*\
  !*** ./src/math/matix.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.multiplyMatrix = exports.createRotationMatrix = exports.createScaleMatrix = exports.createTranslationMatrix = exports.createPerspectiveMatrix = exports.transposeMatrix = exports.createUnitMatrix = exports.printMatrix = exports.setMatrixValue = exports.getMatrixValue = exports.getRawValues = exports.createMatrix = void 0;\nfunction createMatrix(values, n = 4, m = 4) {\n    return ({\n        n: n,\n        m: m,\n        values: Float32Array.from(values.slice(0, n * m))\n    });\n}\nexports.createMatrix = createMatrix;\nfunction getRawValues(matrix) {\n    return matrix.values;\n}\nexports.getRawValues = getRawValues;\nfunction getMatrixValue(matrix, j, i) {\n    return matrix.values[i + matrix.m * j];\n}\nexports.getMatrixValue = getMatrixValue;\nfunction setMatrixValue(matrix, j, i, value) {\n    matrix.values[i + matrix.m * j] = value;\n}\nexports.setMatrixValue = setMatrixValue;\nfunction printMatrix(matrix) {\n    let res = '';\n    for (let j = 0; j < matrix.n; j++) {\n        res += `(${getMatrixValue(matrix, j, 0)}`;\n        for (let i = 1; i < matrix.m; i++) {\n            res += `|${getMatrixValue(matrix, j, i)}`;\n        }\n        res += ')\\n';\n    }\n    return res;\n}\nexports.printMatrix = printMatrix;\nfunction createUnitMatrix(value) {\n    return createMatrix([\n        value, 0, 0, 0,\n        0, value, 0, 0,\n        0, 0, value, 0,\n        0, 0, 0, value,\n    ]);\n}\nexports.createUnitMatrix = createUnitMatrix;\nfunction transposeMatrix(matrix) {\n    for (let j = 0; j < matrix.m; j++) {\n        for (let i = j + 1; i < matrix.n; i++) {\n            const temp = getMatrixValue(matrix, j, i);\n            setMatrixValue(matrix, j, i, getMatrixValue(matrix, i, j));\n            setMatrixValue(matrix, i, j, temp);\n        }\n    }\n    return matrix;\n}\nexports.transposeMatrix = transposeMatrix;\nfunction createPerspectiveMatrix(fov, aspect, near, far) {\n    const matrix = createUnitMatrix(0.0);\n    const tan = Math.tan(fov / 2);\n    setMatrixValue(matrix, 0, 0, 1 / (aspect * tan));\n    setMatrixValue(matrix, 1, 1, 1 / tan);\n    setMatrixValue(matrix, 2, 2, -((far + near) / (far - near)));\n    setMatrixValue(matrix, 2, 3, -1);\n    setMatrixValue(matrix, 3, 2, -(2 * (far * near) / (far - near)));\n    return matrix;\n}\nexports.createPerspectiveMatrix = createPerspectiveMatrix;\nfunction createTranslationMatrix(x, y, z) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 3, x);\n    setMatrixValue(matrix, 1, 3, y);\n    setMatrixValue(matrix, 2, 3, z);\n    return matrix;\n}\nexports.createTranslationMatrix = createTranslationMatrix;\nfunction createScaleMatrix(x, y, z) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 0, x);\n    setMatrixValue(matrix, 1, 1, y);\n    setMatrixValue(matrix, 2, 2, z);\n    return matrix;\n}\nexports.createScaleMatrix = createScaleMatrix;\nfunction createRotationMatrix(a, b, g) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 0, Math.cos(a) * Math.cos(b));\n    setMatrixValue(matrix, 0, 1, Math.cos(a) * Math.sin(b) * Math.sin(g) - Math.sin(a) * Math.cos(g));\n    setMatrixValue(matrix, 0, 2, Math.cos(a) * Math.sin(b) * Math.cos(g) + Math.sin(a) * Math.sin(g));\n    setMatrixValue(matrix, 1, 0, Math.sin(a) * Math.cos(b));\n    setMatrixValue(matrix, 1, 1, Math.sin(a) * Math.sin(b) * Math.sin(g) + Math.cos(a) * Math.cos(g));\n    setMatrixValue(matrix, 1, 2, Math.sin(a) * Math.sin(b) * Math.cos(g) - Math.cos(a) * Math.sin(g));\n    setMatrixValue(matrix, 2, 0, -Math.sin(b));\n    setMatrixValue(matrix, 2, 1, Math.cos(b) * Math.sin(g));\n    setMatrixValue(matrix, 2, 2, Math.cos(b) * Math.cos(g));\n    return matrix;\n}\nexports.createRotationMatrix = createRotationMatrix;\nfunction multiplyMatrix(m1, m2) {\n    // m1.n x m2.m\n    let value = 0;\n    const src = createMatrix(new Array(m1.n * m2.m).fill(0), m1.n, m2.m);\n    for (let j = 0; j < m1.n; j++) {\n        for (let i = 0; i < m2.m; i++) {\n            value = 0;\n            for (let m = 0; m < m1.m; m++) {\n                value += getMatrixValue(m1, j, m) * getMatrixValue(m2, m, i);\n            }\n            setMatrixValue(src, j, i, value);\n        }\n    }\n    return src;\n}\nexports.multiplyMatrix = multiplyMatrix;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC9tYXRpeC50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxzQkFBc0IsR0FBRyw0QkFBNEIsR0FBRyx5QkFBeUIsR0FBRywrQkFBK0IsR0FBRywrQkFBK0IsR0FBRyx1QkFBdUIsR0FBRyx3QkFBd0IsR0FBRyxtQkFBbUIsR0FBRyxzQkFBc0IsR0FBRyxzQkFBc0IsR0FBRyxvQkFBb0IsR0FBRyxvQkFBb0I7QUFDaFU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEMsbUJBQW1CLDZCQUE2QjtBQUNoRCx3QkFBd0IsY0FBYztBQUN0Qyx1QkFBdUIsNkJBQTZCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLG9CQUFvQixjQUFjO0FBQ2xDLDRCQUE0QixjQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUIsd0JBQXdCLFVBQVU7QUFDbEM7QUFDQSw0QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9tYXRoL21hdGl4LnRzPzQ4OTQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm11bHRpcGx5TWF0cml4ID0gZXhwb3J0cy5jcmVhdGVSb3RhdGlvbk1hdHJpeCA9IGV4cG9ydHMuY3JlYXRlU2NhbGVNYXRyaXggPSBleHBvcnRzLmNyZWF0ZVRyYW5zbGF0aW9uTWF0cml4ID0gZXhwb3J0cy5jcmVhdGVQZXJzcGVjdGl2ZU1hdHJpeCA9IGV4cG9ydHMudHJhbnNwb3NlTWF0cml4ID0gZXhwb3J0cy5jcmVhdGVVbml0TWF0cml4ID0gZXhwb3J0cy5wcmludE1hdHJpeCA9IGV4cG9ydHMuc2V0TWF0cml4VmFsdWUgPSBleHBvcnRzLmdldE1hdHJpeFZhbHVlID0gZXhwb3J0cy5nZXRSYXdWYWx1ZXMgPSBleHBvcnRzLmNyZWF0ZU1hdHJpeCA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWF0ZU1hdHJpeCh2YWx1ZXMsIG4gPSA0LCBtID0gNCkge1xuICAgIHJldHVybiAoe1xuICAgICAgICBuOiBuLFxuICAgICAgICBtOiBtLFxuICAgICAgICB2YWx1ZXM6IEZsb2F0MzJBcnJheS5mcm9tKHZhbHVlcy5zbGljZSgwLCBuICogbSkpXG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZU1hdHJpeCA9IGNyZWF0ZU1hdHJpeDtcbmZ1bmN0aW9uIGdldFJhd1ZhbHVlcyhtYXRyaXgpIHtcbiAgICByZXR1cm4gbWF0cml4LnZhbHVlcztcbn1cbmV4cG9ydHMuZ2V0UmF3VmFsdWVzID0gZ2V0UmF3VmFsdWVzO1xuZnVuY3Rpb24gZ2V0TWF0cml4VmFsdWUobWF0cml4LCBqLCBpKSB7XG4gICAgcmV0dXJuIG1hdHJpeC52YWx1ZXNbaSArIG1hdHJpeC5tICogal07XG59XG5leHBvcnRzLmdldE1hdHJpeFZhbHVlID0gZ2V0TWF0cml4VmFsdWU7XG5mdW5jdGlvbiBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGosIGksIHZhbHVlKSB7XG4gICAgbWF0cml4LnZhbHVlc1tpICsgbWF0cml4Lm0gKiBqXSA9IHZhbHVlO1xufVxuZXhwb3J0cy5zZXRNYXRyaXhWYWx1ZSA9IHNldE1hdHJpeFZhbHVlO1xuZnVuY3Rpb24gcHJpbnRNYXRyaXgobWF0cml4KSB7XG4gICAgbGV0IHJlcyA9ICcnO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWF0cml4Lm47IGorKykge1xuICAgICAgICByZXMgKz0gYCgke2dldE1hdHJpeFZhbHVlKG1hdHJpeCwgaiwgMCl9YDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXRyaXgubTsgaSsrKSB7XG4gICAgICAgICAgICByZXMgKz0gYHwke2dldE1hdHJpeFZhbHVlKG1hdHJpeCwgaiwgaSl9YDtcbiAgICAgICAgfVxuICAgICAgICByZXMgKz0gJylcXG4nO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuZXhwb3J0cy5wcmludE1hdHJpeCA9IHByaW50TWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlVW5pdE1hdHJpeCh2YWx1ZSkge1xuICAgIHJldHVybiBjcmVhdGVNYXRyaXgoW1xuICAgICAgICB2YWx1ZSwgMCwgMCwgMCxcbiAgICAgICAgMCwgdmFsdWUsIDAsIDAsXG4gICAgICAgIDAsIDAsIHZhbHVlLCAwLFxuICAgICAgICAwLCAwLCAwLCB2YWx1ZSxcbiAgICBdKTtcbn1cbmV4cG9ydHMuY3JlYXRlVW5pdE1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXg7XG5mdW5jdGlvbiB0cmFuc3Bvc2VNYXRyaXgobWF0cml4KSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBtYXRyaXgubTsgaisrKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBqICsgMTsgaSA8IG1hdHJpeC5uOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBnZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGosIGkpO1xuICAgICAgICAgICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCBqLCBpLCBnZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGksIGopKTtcbiAgICAgICAgICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgaSwgaiwgdGVtcCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hdHJpeDtcbn1cbmV4cG9ydHMudHJhbnNwb3NlTWF0cml4ID0gdHJhbnNwb3NlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlUGVyc3BlY3RpdmVNYXRyaXgoZm92LCBhc3BlY3QsIG5lYXIsIGZhcikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMC4wKTtcbiAgICBjb25zdCB0YW4gPSBNYXRoLnRhbihmb3YgLyAyKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIDEgLyAoYXNwZWN0ICogdGFuKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAxLCAxLCAxIC8gdGFuKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDIsIC0oKGZhciArIG5lYXIpIC8gKGZhciAtIG5lYXIpKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAzLCAtMSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAzLCAyLCAtKDIgKiAoZmFyICogbmVhcikgLyAoZmFyIC0gbmVhcikpKTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVQZXJzcGVjdGl2ZU1hdHJpeCA9IGNyZWF0ZVBlcnNwZWN0aXZlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlVHJhbnNsYXRpb25NYXRyaXgoeCwgeSwgeikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDMsIHgpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMywgeSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAzLCB6KTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVUcmFuc2xhdGlvbk1hdHJpeCA9IGNyZWF0ZVRyYW5zbGF0aW9uTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlU2NhbGVNYXRyaXgoeCwgeSwgeikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIHgpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMSwgeSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAyLCB6KTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVTY2FsZU1hdHJpeCA9IGNyZWF0ZVNjYWxlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlUm90YXRpb25NYXRyaXgoYSwgYiwgZykge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIE1hdGguY29zKGEpICogTWF0aC5jb3MoYikpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMCwgMSwgTWF0aC5jb3MoYSkgKiBNYXRoLnNpbihiKSAqIE1hdGguc2luKGcpIC0gTWF0aC5zaW4oYSkgKiBNYXRoLmNvcyhnKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAwLCAyLCBNYXRoLmNvcyhhKSAqIE1hdGguc2luKGIpICogTWF0aC5jb3MoZykgKyBNYXRoLnNpbihhKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDEsIDAsIE1hdGguc2luKGEpICogTWF0aC5jb3MoYikpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMSwgTWF0aC5zaW4oYSkgKiBNYXRoLnNpbihiKSAqIE1hdGguc2luKGcpICsgTWF0aC5jb3MoYSkgKiBNYXRoLmNvcyhnKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAxLCAyLCBNYXRoLnNpbihhKSAqIE1hdGguc2luKGIpICogTWF0aC5jb3MoZykgLSBNYXRoLmNvcyhhKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDAsIC1NYXRoLnNpbihiKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAxLCBNYXRoLmNvcyhiKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDIsIE1hdGguY29zKGIpICogTWF0aC5jb3MoZykpO1xuICAgIHJldHVybiBtYXRyaXg7XG59XG5leHBvcnRzLmNyZWF0ZVJvdGF0aW9uTWF0cml4ID0gY3JlYXRlUm90YXRpb25NYXRyaXg7XG5mdW5jdGlvbiBtdWx0aXBseU1hdHJpeChtMSwgbTIpIHtcbiAgICAvLyBtMS5uIHggbTIubVxuICAgIGxldCB2YWx1ZSA9IDA7XG4gICAgY29uc3Qgc3JjID0gY3JlYXRlTWF0cml4KG5ldyBBcnJheShtMS5uICogbTIubSkuZmlsbCgwKSwgbTEubiwgbTIubSk7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBtMS5uOyBqKyspIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtMi5tOyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgbTEubTsgbSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgKz0gZ2V0TWF0cml4VmFsdWUobTEsIGosIG0pICogZ2V0TWF0cml4VmFsdWUobTIsIG0sIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0TWF0cml4VmFsdWUoc3JjLCBqLCBpLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNyYztcbn1cbmV4cG9ydHMubXVsdGlwbHlNYXRyaXggPSBtdWx0aXBseU1hdHJpeDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/math/matix.ts\n");

/***/ }),

/***/ "./src/math/screen.ts":
/*!****************************!*\
  !*** ./src/math/screen.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.convertScreenCoordToWorldCoord = exports.getAngleFromLineProjection = exports.normalizeYCoord = exports.normalizeXCoord = void 0;\nconst utils_1 = __webpack_require__(/*! ./utils */ \"./src/math/utils.ts\");\nfunction normalizeXCoord(x, screenWidth) {\n    return ((x / screenWidth) * 2 - 1);\n}\nexports.normalizeXCoord = normalizeXCoord;\nfunction normalizeYCoord(y, screenHeight) {\n    return ((y / screenHeight) * 2 - 1) * -1;\n}\nexports.normalizeYCoord = normalizeYCoord;\nfunction getAngleFromLineProjection(projectionX, projectionY) {\n    let angel = (0, utils_1.toDegrees)(Math.atan(projectionY / projectionX));\n    if (projectionX < 0 && projectionY > 0) {\n        angel = 180 + angel;\n    }\n    if (projectionX < 0 && projectionY < 0) {\n        angel = 180 + angel;\n    }\n    if (projectionX > 0 && projectionY < 0) {\n        angel = 360 + angel;\n    }\n    angel = Math.abs(angel);\n    return angel;\n}\nexports.getAngleFromLineProjection = getAngleFromLineProjection;\nfunction convertScreenCoordToWorldCoord(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect) {\n    const offsetXNormalized = normalizeXCoord(coord.x, screenWidth);\n    const offsetYNormalized = normalizeYCoord(coord.y, screenHeight);\n    const tan = Math.tan(fovy / 2);\n    // TODO: use inverse projection matrix to calculate this\n    const projectCoefX = (aspect * tan * (-paitingLayer + cameraPosition.z));\n    const projectCoefY = (tan * (-paitingLayer + cameraPosition.z));\n    const startX = cameraPosition.x + (offsetXNormalized * projectCoefX);\n    const startY = cameraPosition.y + (offsetYNormalized * projectCoefY);\n    coord.x = startX;\n    coord.y = startY;\n}\nexports.convertScreenCoordToWorldCoord = convertScreenCoordToWorldCoord;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC9zY3JlZW4udHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsc0NBQXNDLEdBQUcsa0NBQWtDLEdBQUcsdUJBQXVCLEdBQUcsdUJBQXVCO0FBQy9ILGdCQUFnQixtQkFBTyxDQUFDLG9DQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvbWF0aC9zY3JlZW4udHM/ZGJhNSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY29udmVydFNjcmVlbkNvb3JkVG9Xb3JsZENvb3JkID0gZXhwb3J0cy5nZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbiA9IGV4cG9ydHMubm9ybWFsaXplWUNvb3JkID0gZXhwb3J0cy5ub3JtYWxpemVYQ29vcmQgPSB2b2lkIDA7XG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5mdW5jdGlvbiBub3JtYWxpemVYQ29vcmQoeCwgc2NyZWVuV2lkdGgpIHtcbiAgICByZXR1cm4gKCh4IC8gc2NyZWVuV2lkdGgpICogMiAtIDEpO1xufVxuZXhwb3J0cy5ub3JtYWxpemVYQ29vcmQgPSBub3JtYWxpemVYQ29vcmQ7XG5mdW5jdGlvbiBub3JtYWxpemVZQ29vcmQoeSwgc2NyZWVuSGVpZ2h0KSB7XG4gICAgcmV0dXJuICgoeSAvIHNjcmVlbkhlaWdodCkgKiAyIC0gMSkgKiAtMTtcbn1cbmV4cG9ydHMubm9ybWFsaXplWUNvb3JkID0gbm9ybWFsaXplWUNvb3JkO1xuZnVuY3Rpb24gZ2V0QW5nbGVGcm9tTGluZVByb2plY3Rpb24ocHJvamVjdGlvblgsIHByb2plY3Rpb25ZKSB7XG4gICAgbGV0IGFuZ2VsID0gKDAsIHV0aWxzXzEudG9EZWdyZWVzKShNYXRoLmF0YW4ocHJvamVjdGlvblkgLyBwcm9qZWN0aW9uWCkpO1xuICAgIGlmIChwcm9qZWN0aW9uWCA8IDAgJiYgcHJvamVjdGlvblkgPiAwKSB7XG4gICAgICAgIGFuZ2VsID0gMTgwICsgYW5nZWw7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0aW9uWCA8IDAgJiYgcHJvamVjdGlvblkgPCAwKSB7XG4gICAgICAgIGFuZ2VsID0gMTgwICsgYW5nZWw7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0aW9uWCA+IDAgJiYgcHJvamVjdGlvblkgPCAwKSB7XG4gICAgICAgIGFuZ2VsID0gMzYwICsgYW5nZWw7XG4gICAgfVxuICAgIGFuZ2VsID0gTWF0aC5hYnMoYW5nZWwpO1xuICAgIHJldHVybiBhbmdlbDtcbn1cbmV4cG9ydHMuZ2V0QW5nbGVGcm9tTGluZVByb2plY3Rpb24gPSBnZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbjtcbmZ1bmN0aW9uIGNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZChjb29yZCwgY2FtZXJhUG9zaXRpb24sIHBhaXRpbmdMYXllciwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCwgZm92eSwgYXNwZWN0KSB7XG4gICAgY29uc3Qgb2Zmc2V0WE5vcm1hbGl6ZWQgPSBub3JtYWxpemVYQ29vcmQoY29vcmQueCwgc2NyZWVuV2lkdGgpO1xuICAgIGNvbnN0IG9mZnNldFlOb3JtYWxpemVkID0gbm9ybWFsaXplWUNvb3JkKGNvb3JkLnksIHNjcmVlbkhlaWdodCk7XG4gICAgY29uc3QgdGFuID0gTWF0aC50YW4oZm92eSAvIDIpO1xuICAgIC8vIFRPRE86IHVzZSBpbnZlcnNlIHByb2plY3Rpb24gbWF0cml4IHRvIGNhbGN1bGF0ZSB0aGlzXG4gICAgY29uc3QgcHJvamVjdENvZWZYID0gKGFzcGVjdCAqIHRhbiAqICgtcGFpdGluZ0xheWVyICsgY2FtZXJhUG9zaXRpb24ueikpO1xuICAgIGNvbnN0IHByb2plY3RDb2VmWSA9ICh0YW4gKiAoLXBhaXRpbmdMYXllciArIGNhbWVyYVBvc2l0aW9uLnopKTtcbiAgICBjb25zdCBzdGFydFggPSBjYW1lcmFQb3NpdGlvbi54ICsgKG9mZnNldFhOb3JtYWxpemVkICogcHJvamVjdENvZWZYKTtcbiAgICBjb25zdCBzdGFydFkgPSBjYW1lcmFQb3NpdGlvbi55ICsgKG9mZnNldFlOb3JtYWxpemVkICogcHJvamVjdENvZWZZKTtcbiAgICBjb29yZC54ID0gc3RhcnRYO1xuICAgIGNvb3JkLnkgPSBzdGFydFk7XG59XG5leHBvcnRzLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCA9IGNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/math/screen.ts\n");

/***/ }),

/***/ "./src/math/utils.ts":
/*!***************************!*\
  !*** ./src/math/utils.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.smootsptep = exports.clamp = exports.toDegrees = exports.toRadians = void 0;\nconst toRaduansCof = Math.PI / 180.0;\nfunction toRadians(angle) {\n    return angle * toRaduansCof;\n}\nexports.toRadians = toRadians;\nfunction toDegrees(angle) {\n    return angle / toRaduansCof;\n}\nexports.toDegrees = toDegrees;\nfunction clamp(n, l, u) {\n    return Math.min(Math.max(n, l), u);\n}\nexports.clamp = clamp;\nfunction smootsptep(edge0, edge1, x) {\n    let t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return t * t * (3.0 - 2.0 * t);\n}\nexports.smootsptep = smootsptep;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC91dGlscy50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxrQkFBa0IsR0FBRyxhQUFhLEdBQUcsaUJBQWlCLEdBQUcsaUJBQWlCO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvbWF0aC91dGlscy50cz8xMjgyIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5zbW9vdHNwdGVwID0gZXhwb3J0cy5jbGFtcCA9IGV4cG9ydHMudG9EZWdyZWVzID0gZXhwb3J0cy50b1JhZGlhbnMgPSB2b2lkIDA7XG5jb25zdCB0b1JhZHVhbnNDb2YgPSBNYXRoLlBJIC8gMTgwLjA7XG5mdW5jdGlvbiB0b1JhZGlhbnMoYW5nbGUpIHtcbiAgICByZXR1cm4gYW5nbGUgKiB0b1JhZHVhbnNDb2Y7XG59XG5leHBvcnRzLnRvUmFkaWFucyA9IHRvUmFkaWFucztcbmZ1bmN0aW9uIHRvRGVncmVlcyhhbmdsZSkge1xuICAgIHJldHVybiBhbmdsZSAvIHRvUmFkdWFuc0NvZjtcbn1cbmV4cG9ydHMudG9EZWdyZWVzID0gdG9EZWdyZWVzO1xuZnVuY3Rpb24gY2xhbXAobiwgbCwgdSkge1xuICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChuLCBsKSwgdSk7XG59XG5leHBvcnRzLmNsYW1wID0gY2xhbXA7XG5mdW5jdGlvbiBzbW9vdHNwdGVwKGVkZ2UwLCBlZGdlMSwgeCkge1xuICAgIGxldCB0ID0gY2xhbXAoKHggLSBlZGdlMCkgLyAoZWRnZTEgLSBlZGdlMCksIDAuMCwgMS4wKTtcbiAgICByZXR1cm4gdCAqIHQgKiAoMy4wIC0gMi4wICogdCk7XG59XG5leHBvcnRzLnNtb290c3B0ZXAgPSBzbW9vdHNwdGVwO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/math/utils.ts\n");

/***/ }),

/***/ "./src/math/vec.ts":
/*!*************************!*\
  !*** ./src/math/vec.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createVec4 = exports.createVec3 = exports.createVec2 = void 0;\nfunction createVec2(x, y) {\n    return ({\n        x, y\n    });\n}\nexports.createVec2 = createVec2;\nfunction createVec3(x, y, z) {\n    return ({\n        x, y, z\n    });\n}\nexports.createVec3 = createVec3;\nfunction createVec4(x, y, z, w) {\n    return ({\n        x, y, z, w\n    });\n}\nexports.createVec4 = createVec4;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC92ZWMudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0JBQWtCLEdBQUcsa0JBQWtCLEdBQUcsa0JBQWtCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0JBQWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL21hdGgvdmVjLnRzP2IyYzgiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmNyZWF0ZVZlYzQgPSBleHBvcnRzLmNyZWF0ZVZlYzMgPSBleHBvcnRzLmNyZWF0ZVZlYzIgPSB2b2lkIDA7XG5mdW5jdGlvbiBjcmVhdGVWZWMyKHgsIHkpIHtcbiAgICByZXR1cm4gKHtcbiAgICAgICAgeCwgeVxuICAgIH0pO1xufVxuZXhwb3J0cy5jcmVhdGVWZWMyID0gY3JlYXRlVmVjMjtcbmZ1bmN0aW9uIGNyZWF0ZVZlYzMoeCwgeSwgeikge1xuICAgIHJldHVybiAoe1xuICAgICAgICB4LCB5LCB6XG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZVZlYzMgPSBjcmVhdGVWZWMzO1xuZnVuY3Rpb24gY3JlYXRlVmVjNCh4LCB5LCB6LCB3KSB7XG4gICAgcmV0dXJuICh7XG4gICAgICAgIHgsIHksIHosIHdcbiAgICB9KTtcbn1cbmV4cG9ydHMuY3JlYXRlVmVjNCA9IGNyZWF0ZVZlYzQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/math/vec.ts\n");

/***/ }),

/***/ "./src/render/components.ts":
/*!**********************************!*\
  !*** ./src/render/components.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createLine = void 0;\nconst vec_1 = __webpack_require__(/*! ../math/vec */ \"./src/math/vec.ts\");\nfunction createLine(position, length, id, color) {\n    color = color !== null && color !== void 0 ? color : (0, vec_1.createVec3)(1.0, 1.0, 1.0);\n    return ({\n        position,\n        color,\n        length,\n        scale: 1.0,\n        rotate: 0.0,\n        line: -1,\n        id\n    });\n}\nexports.createLine = createLine;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2NvbXBvbmVudHMudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0JBQWtCO0FBQ2xCLGNBQWMsbUJBQU8sQ0FBQyxzQ0FBYTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvY29tcG9uZW50cy50cz9jYmVhIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jcmVhdGVMaW5lID0gdm9pZCAwO1xuY29uc3QgdmVjXzEgPSByZXF1aXJlKFwiLi4vbWF0aC92ZWNcIik7XG5mdW5jdGlvbiBjcmVhdGVMaW5lKHBvc2l0aW9uLCBsZW5ndGgsIGlkLCBjb2xvcikge1xuICAgIGNvbG9yID0gY29sb3IgIT09IG51bGwgJiYgY29sb3IgIT09IHZvaWQgMCA/IGNvbG9yIDogKDAsIHZlY18xLmNyZWF0ZVZlYzMpKDEuMCwgMS4wLCAxLjApO1xuICAgIHJldHVybiAoe1xuICAgICAgICBwb3NpdGlvbixcbiAgICAgICAgY29sb3IsXG4gICAgICAgIGxlbmd0aCxcbiAgICAgICAgc2NhbGU6IDEuMCxcbiAgICAgICAgcm90YXRlOiAwLjAsXG4gICAgICAgIGxpbmU6IC0xLFxuICAgICAgICBpZFxuICAgIH0pO1xufVxuZXhwb3J0cy5jcmVhdGVMaW5lID0gY3JlYXRlTGluZTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/components.ts\n");

/***/ }),

/***/ "./src/render/const.ts":
/*!*****************************!*\
  !*** ./src/render/const.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.QUAD_WITH_TEXTURE_COORD_DATA = exports.paitingLayer = void 0;\nexports.paitingLayer = -3.0;\nexports.QUAD_WITH_TEXTURE_COORD_DATA = Float32Array.from([\n    // first triangle\n    -1.0, 1.0, 0.0,\n    0.0, 0.0,\n    1.0, 1.0, 0.0,\n    1.0, 0.0,\n    -1.0, -1.0, 0.0,\n    0.0, 1.0,\n    // second triangle\n    1.0, 1.0, 0.0,\n    1.0, 0.0,\n    1.0, -1.0, 0.0,\n    1.0, 1.0,\n    -1.0, -1.0, 0.0,\n    0.0, 1.0, // texCoord v2\n]);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2NvbnN0LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG9DQUFvQyxHQUFHLG9CQUFvQjtBQUMzRCxvQkFBb0I7QUFDcEIsb0NBQW9DO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvY29uc3QudHM/NWQyNyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUVVBRF9XSVRIX1RFWFRVUkVfQ09PUkRfREFUQSA9IGV4cG9ydHMucGFpdGluZ0xheWVyID0gdm9pZCAwO1xuZXhwb3J0cy5wYWl0aW5nTGF5ZXIgPSAtMy4wO1xuZXhwb3J0cy5RVUFEX1dJVEhfVEVYVFVSRV9DT09SRF9EQVRBID0gRmxvYXQzMkFycmF5LmZyb20oW1xuICAgIC8vIGZpcnN0IHRyaWFuZ2xlXG4gICAgLTEuMCwgMS4wLCAwLjAsXG4gICAgMC4wLCAwLjAsXG4gICAgMS4wLCAxLjAsIDAuMCxcbiAgICAxLjAsIDAuMCxcbiAgICAtMS4wLCAtMS4wLCAwLjAsXG4gICAgMC4wLCAxLjAsXG4gICAgLy8gc2Vjb25kIHRyaWFuZ2xlXG4gICAgMS4wLCAxLjAsIDAuMCxcbiAgICAxLjAsIDAuMCxcbiAgICAxLjAsIC0xLjAsIDAuMCxcbiAgICAxLjAsIDEuMCxcbiAgICAtMS4wLCAtMS4wLCAwLjAsXG4gICAgMC4wLCAxLjAsIC8vIHRleENvb3JkIHYyXG5dKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/const.ts\n");

/***/ }),

/***/ "./src/render/framebuffer.ts":
/*!***********************************!*\
  !*** ./src/render/framebuffer.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.GLFramebuffer = exports.BufferAttacment = void 0;\nvar BufferAttacment;\n(function (BufferAttacment) {\n    BufferAttacment[BufferAttacment[\"color\"] = 0] = \"color\";\n    BufferAttacment[BufferAttacment[\"depth\"] = 1] = \"depth\";\n})(BufferAttacment = exports.BufferAttacment || (exports.BufferAttacment = {}));\nclass GLFramebuffer {\n    constructor(gl, options) {\n        this.colorAttachmentCount = 0;\n        this.colorAttachmentMap = new Map();\n        const frameBuffer = gl.createFramebuffer();\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        for (let i = 0; i < options.length; i++) {\n            const option = options[i];\n            if (option.type === BufferAttacment.color) {\n                gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + this.colorAttachmentCount, gl.TEXTURE_2D, option.buffer.getGLTexture(), 0);\n                if (option.name) {\n                    this.colorAttachmentMap.set(option.name, this.colorAttachmentCount);\n                }\n                this.colorAttachmentCount += 1;\n            }\n            else {\n                gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, option.buffer);\n            }\n        }\n        gl.drawBuffers((new Array(this.colorAttachmentCount).fill(0)).map((_, i) => gl.COLOR_ATTACHMENT0 + i));\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        this.frameBuffer = frameBuffer;\n        this.gl = gl;\n        this.options = options;\n        if (this.colorAttachmentCount === 0) {\n            console.warn('Framebuffer should have at least one color attachment');\n        }\n    }\n    bind() {\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.frameBuffer);\n    }\n    unbind() {\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\n    }\n    clearDepthBuffer() {\n        this.gl.clearBufferfi(this.gl.DEPTH_STENCIL, 0, 1.0, 0); // TODO: why depth = 1.0\n    }\n    // TODO: think how to make logic for selection func for clearing (clearBufferfv, clearBufferuiv, etc) base on texture type\n    clearColorBufferFloat(name, r, g, b, a) {\n        let location = this.colorAttachmentMap.get(name);\n        if (location === undefined) {\n            console.warn('Unknown color attachment name');\n            location = -1;\n        }\n        this.gl.clearBufferfv(this.gl.COLOR, location, new Float32Array([r, g, b, a]));\n    }\n    // TODO: think how to make logic for selection func for clearing (clearBufferfv, clearBufferuiv, etc) base on texture type\n    clearColorBufferUInt(name, r, g, b, a) {\n        let location = this.colorAttachmentMap.get(name);\n        if (location === undefined) {\n            console.warn('Unknown color attachment name');\n            location = -1;\n        }\n        this.gl.clearBufferuiv(this.gl.COLOR, location, new Uint32Array([r, g, b, a]));\n    }\n    getGLFramebuffer() {\n        return this.frameBuffer;\n    }\n    getAttachmentReader(name) {\n        var _a;\n        let location = this.colorAttachmentMap.get(name);\n        const texutre = (_a = this.options.filter(option => option.type === BufferAttacment.color)[location !== null && location !== void 0 ? location : 0]) === null || _a === void 0 ? void 0 : _a.buffer;\n        const width = texutre.getWidth();\n        const height = texutre.getHeight();\n        const gl = this.gl;\n        const readPixels = (x, y, width, height) => {\n            if (location === undefined) {\n                console.warn('Unknown color attachment name');\n                location = -1;\n            }\n            const b = new Uint8Array(width * height * 4);\n            gl.readBuffer(gl.COLOR_ATTACHMENT0 + location);\n            gl.readPixels(x, y, width, height, gl.RGBA_INTEGER, gl.UNSIGNED_BYTE, b);\n            return b;\n        };\n        return {\n            bind: () => this.bind(),\n            readBuffer: () => readPixels(0, 0, width, height), readPixel: (x, y) => readPixels(x, y, 1, 1),\n            unbind: () => this.unbind(),\n        };\n    }\n}\nexports.GLFramebuffer = GLFramebuffer;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2ZyYW1lYnVmZmVyLnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHFCQUFxQixHQUFHLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0RBQWdELHVCQUF1QixLQUFLO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixvQkFBb0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBaUU7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvcmVuZGVyL2ZyYW1lYnVmZmVyLnRzPzg4MTUiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkdMRnJhbWVidWZmZXIgPSBleHBvcnRzLkJ1ZmZlckF0dGFjbWVudCA9IHZvaWQgMDtcbnZhciBCdWZmZXJBdHRhY21lbnQ7XG4oZnVuY3Rpb24gKEJ1ZmZlckF0dGFjbWVudCkge1xuICAgIEJ1ZmZlckF0dGFjbWVudFtCdWZmZXJBdHRhY21lbnRbXCJjb2xvclwiXSA9IDBdID0gXCJjb2xvclwiO1xuICAgIEJ1ZmZlckF0dGFjbWVudFtCdWZmZXJBdHRhY21lbnRbXCJkZXB0aFwiXSA9IDFdID0gXCJkZXB0aFwiO1xufSkoQnVmZmVyQXR0YWNtZW50ID0gZXhwb3J0cy5CdWZmZXJBdHRhY21lbnQgfHwgKGV4cG9ydHMuQnVmZmVyQXR0YWNtZW50ID0ge30pKTtcbmNsYXNzIEdMRnJhbWVidWZmZXIge1xuICAgIGNvbnN0cnVjdG9yKGdsLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuY29sb3JBdHRhY2htZW50Q291bnQgPSAwO1xuICAgICAgICB0aGlzLmNvbG9yQXR0YWNobWVudE1hcCA9IG5ldyBNYXAoKTtcbiAgICAgICAgY29uc3QgZnJhbWVCdWZmZXIgPSBnbC5jcmVhdGVGcmFtZWJ1ZmZlcigpO1xuICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIGZyYW1lQnVmZmVyKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBvcHRpb24gPSBvcHRpb25zW2ldO1xuICAgICAgICAgICAgaWYgKG9wdGlvbi50eXBlID09PSBCdWZmZXJBdHRhY21lbnQuY29sb3IpIHtcbiAgICAgICAgICAgICAgICBnbC5mcmFtZWJ1ZmZlclRleHR1cmUyRChnbC5GUkFNRUJVRkZFUiwgZ2wuQ09MT1JfQVRUQUNITUVOVDAgKyB0aGlzLmNvbG9yQXR0YWNobWVudENvdW50LCBnbC5URVhUVVJFXzJELCBvcHRpb24uYnVmZmVyLmdldEdMVGV4dHVyZSgpLCAwKTtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9uLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb2xvckF0dGFjaG1lbnRNYXAuc2V0KG9wdGlvbi5uYW1lLCB0aGlzLmNvbG9yQXR0YWNobWVudENvdW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jb2xvckF0dGFjaG1lbnRDb3VudCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2wuZnJhbWVidWZmZXJSZW5kZXJidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIGdsLkRFUFRIX1NURU5DSUxfQVRUQUNITUVOVCwgZ2wuUkVOREVSQlVGRkVSLCBvcHRpb24uYnVmZmVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnbC5kcmF3QnVmZmVycygobmV3IEFycmF5KHRoaXMuY29sb3JBdHRhY2htZW50Q291bnQpLmZpbGwoMCkpLm1hcCgoXywgaSkgPT4gZ2wuQ09MT1JfQVRUQUNITUVOVDAgKyBpKSk7XG4gICAgICAgIGdsLmJpbmRGcmFtZWJ1ZmZlcihnbC5GUkFNRUJVRkZFUiwgbnVsbCk7XG4gICAgICAgIHRoaXMuZnJhbWVCdWZmZXIgPSBmcmFtZUJ1ZmZlcjtcbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuICAgICAgICBpZiAodGhpcy5jb2xvckF0dGFjaG1lbnRDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdGcmFtZWJ1ZmZlciBzaG91bGQgaGF2ZSBhdCBsZWFzdCBvbmUgY29sb3IgYXR0YWNobWVudCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGJpbmQoKSB7XG4gICAgICAgIHRoaXMuZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuZ2wuRlJBTUVCVUZGRVIsIHRoaXMuZnJhbWVCdWZmZXIpO1xuICAgIH1cbiAgICB1bmJpbmQoKSB7XG4gICAgICAgIHRoaXMuZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuZ2wuRlJBTUVCVUZGRVIsIG51bGwpO1xuICAgIH1cbiAgICBjbGVhckRlcHRoQnVmZmVyKCkge1xuICAgICAgICB0aGlzLmdsLmNsZWFyQnVmZmVyZmkodGhpcy5nbC5ERVBUSF9TVEVOQ0lMLCAwLCAxLjAsIDApOyAvLyBUT0RPOiB3aHkgZGVwdGggPSAxLjBcbiAgICB9XG4gICAgLy8gVE9ETzogdGhpbmsgaG93IHRvIG1ha2UgbG9naWMgZm9yIHNlbGVjdGlvbiBmdW5jIGZvciBjbGVhcmluZyAoY2xlYXJCdWZmZXJmdiwgY2xlYXJCdWZmZXJ1aXYsIGV0YykgYmFzZSBvbiB0ZXh0dXJlIHR5cGVcbiAgICBjbGVhckNvbG9yQnVmZmVyRmxvYXQobmFtZSwgciwgZywgYiwgYSkge1xuICAgICAgICBsZXQgbG9jYXRpb24gPSB0aGlzLmNvbG9yQXR0YWNobWVudE1hcC5nZXQobmFtZSk7XG4gICAgICAgIGlmIChsb2NhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Vua25vd24gY29sb3IgYXR0YWNobWVudCBuYW1lJyk7XG4gICAgICAgICAgICBsb2NhdGlvbiA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZ2wuY2xlYXJCdWZmZXJmdih0aGlzLmdsLkNPTE9SLCBsb2NhdGlvbiwgbmV3IEZsb2F0MzJBcnJheShbciwgZywgYiwgYV0pKTtcbiAgICB9XG4gICAgLy8gVE9ETzogdGhpbmsgaG93IHRvIG1ha2UgbG9naWMgZm9yIHNlbGVjdGlvbiBmdW5jIGZvciBjbGVhcmluZyAoY2xlYXJCdWZmZXJmdiwgY2xlYXJCdWZmZXJ1aXYsIGV0YykgYmFzZSBvbiB0ZXh0dXJlIHR5cGVcbiAgICBjbGVhckNvbG9yQnVmZmVyVUludChuYW1lLCByLCBnLCBiLCBhKSB7XG4gICAgICAgIGxldCBsb2NhdGlvbiA9IHRoaXMuY29sb3JBdHRhY2htZW50TWFwLmdldChuYW1lKTtcbiAgICAgICAgaWYgKGxvY2F0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignVW5rbm93biBjb2xvciBhdHRhY2htZW50IG5hbWUnKTtcbiAgICAgICAgICAgIGxvY2F0aW9uID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5nbC5jbGVhckJ1ZmZlcnVpdih0aGlzLmdsLkNPTE9SLCBsb2NhdGlvbiwgbmV3IFVpbnQzMkFycmF5KFtyLCBnLCBiLCBhXSkpO1xuICAgIH1cbiAgICBnZXRHTEZyYW1lYnVmZmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mcmFtZUJ1ZmZlcjtcbiAgICB9XG4gICAgZ2V0QXR0YWNobWVudFJlYWRlcihuYW1lKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgbGV0IGxvY2F0aW9uID0gdGhpcy5jb2xvckF0dGFjaG1lbnRNYXAuZ2V0KG5hbWUpO1xuICAgICAgICBjb25zdCB0ZXh1dHJlID0gKF9hID0gdGhpcy5vcHRpb25zLmZpbHRlcihvcHRpb24gPT4gb3B0aW9uLnR5cGUgPT09IEJ1ZmZlckF0dGFjbWVudC5jb2xvcilbbG9jYXRpb24gIT09IG51bGwgJiYgbG9jYXRpb24gIT09IHZvaWQgMCA/IGxvY2F0aW9uIDogMF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5idWZmZXI7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGV4dXRyZS5nZXRXaWR0aCgpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSB0ZXh1dHJlLmdldEhlaWdodCgpO1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuZ2w7XG4gICAgICAgIGNvbnN0IHJlYWRQaXhlbHMgPSAoeCwgeSwgd2lkdGgsIGhlaWdodCkgPT4ge1xuICAgICAgICAgICAgaWYgKGxvY2F0aW9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1Vua25vd24gY29sb3IgYXR0YWNobWVudCBuYW1lJyk7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24gPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGIgPSBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCAqIDQpO1xuICAgICAgICAgICAgZ2wucmVhZEJ1ZmZlcihnbC5DT0xPUl9BVFRBQ0hNRU5UMCArIGxvY2F0aW9uKTtcbiAgICAgICAgICAgIGdsLnJlYWRQaXhlbHMoeCwgeSwgd2lkdGgsIGhlaWdodCwgZ2wuUkdCQV9JTlRFR0VSLCBnbC5VTlNJR05FRF9CWVRFLCBiKTtcbiAgICAgICAgICAgIHJldHVybiBiO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmluZDogKCkgPT4gdGhpcy5iaW5kKCksXG4gICAgICAgICAgICByZWFkQnVmZmVyOiAoKSA9PiByZWFkUGl4ZWxzKDAsIDAsIHdpZHRoLCBoZWlnaHQpLCByZWFkUGl4ZWw6ICh4LCB5KSA9PiByZWFkUGl4ZWxzKHgsIHksIDEsIDEpLFxuICAgICAgICAgICAgdW5iaW5kOiAoKSA9PiB0aGlzLnVuYmluZCgpLFxuICAgICAgICB9O1xuICAgIH1cbn1cbmV4cG9ydHMuR0xGcmFtZWJ1ZmZlciA9IEdMRnJhbWVidWZmZXI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/render/framebuffer.ts\n");

/***/ }),

/***/ "./src/render/gl-api.ts":
/*!******************************!*\
  !*** ./src/render/gl-api.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n// export function createGLProgram(gl: WebGL2RenderingContext, vertShader: string, fragShader: string) {\n//   const program = gl.createProgram() as WebGLProgram;\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.deleteShader = exports.createFragmentGLShader = exports.createVertexGLShader = exports.createGLProgram = void 0;\n//   gl.attachShader(program, createGLShader(gl, gl.VERTEX_SHADER, vertShader) as WebGLShader);\n//   gl.attachShader(program, createGLShader(gl, gl.FRAGMENT_SHADER, fragShader) as WebGLShader);\n//   gl.linkProgram(program);\n//   if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n//     const info = gl.getProgramInfoLog(program);\n//     console.warn(`Fail to link program: ${info}`);\n//     gl.deleteProgram(program);\n//     return null;\n//   }\n//   return program;\n// }\n// export function createGLShader(gl: WebGL2RenderingContext, type: GLenum, shaderSrc: string) {\n//   const shader = gl.createShader(type) as WebGLShader;\n//   if (shader === 0) console.warn('Fail to create shader');\n//   gl.shaderSource(shader, shaderSrc);\n//   gl.compileShader(shader);\n//   if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n//     const message = gl.getShaderInfoLog(shader);\n//     console.warn(`Fail to compile shader: ${message}`);\n//     gl.deleteShader(shader);\n//     return null;\n//   }\n//   return shader;\n// }\nfunction createGLProgram(gl, vertShader, fragShader) {\n    const program = gl.createProgram();\n    gl.attachShader(program, vertShader);\n    gl.attachShader(program, fragShader);\n    gl.linkProgram(program);\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        const info = gl.getProgramInfoLog(program);\n        console.warn(`Fail to link program: ${info}`);\n        gl.deleteProgram(program);\n        return null;\n    }\n    return program;\n}\nexports.createGLProgram = createGLProgram;\nfunction createGLShader(gl, type, shaderSrc) {\n    const shader = gl.createShader(type);\n    if (shader === 0)\n        console.warn('Fail to create shader');\n    gl.shaderSource(shader, shaderSrc);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        const message = gl.getShaderInfoLog(shader);\n        console.warn(`Fail to compile shader: ${message}`);\n        gl.deleteShader(shader);\n        return null;\n    }\n    return shader;\n}\nfunction createVertexGLShader(gl, shaderSrc) {\n    return createGLShader(gl, gl.VERTEX_SHADER, shaderSrc);\n}\nexports.createVertexGLShader = createVertexGLShader;\nfunction createFragmentGLShader(gl, shaderSrc) {\n    return createGLShader(gl, gl.FRAGMENT_SHADER, shaderSrc);\n}\nexports.createFragmentGLShader = createFragmentGLShader;\nfunction deleteShader(gl, shader) {\n    gl.deleteShader(shader);\n}\nexports.deleteShader = deleteShader;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2dsLWFwaS50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiO0FBQ0E7QUFDQSw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsb0JBQW9CLEdBQUcsOEJBQThCLEdBQUcsNEJBQTRCLEdBQUcsdUJBQXVCO0FBQzlHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsS0FBSztBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsUUFBUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsUUFBUTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvcmVuZGVyL2dsLWFwaS50cz8zYzhlIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuLy8gZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUdMUHJvZ3JhbShnbDogV2ViR0wyUmVuZGVyaW5nQ29udGV4dCwgdmVydFNoYWRlcjogc3RyaW5nLCBmcmFnU2hhZGVyOiBzdHJpbmcpIHtcbi8vICAgY29uc3QgcHJvZ3JhbSA9IGdsLmNyZWF0ZVByb2dyYW0oKSBhcyBXZWJHTFByb2dyYW07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmRlbGV0ZVNoYWRlciA9IGV4cG9ydHMuY3JlYXRlRnJhZ21lbnRHTFNoYWRlciA9IGV4cG9ydHMuY3JlYXRlVmVydGV4R0xTaGFkZXIgPSBleHBvcnRzLmNyZWF0ZUdMUHJvZ3JhbSA9IHZvaWQgMDtcbi8vICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGNyZWF0ZUdMU2hhZGVyKGdsLCBnbC5WRVJURVhfU0hBREVSLCB2ZXJ0U2hhZGVyKSBhcyBXZWJHTFNoYWRlcik7XG4vLyAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBjcmVhdGVHTFNoYWRlcihnbCwgZ2wuRlJBR01FTlRfU0hBREVSLCBmcmFnU2hhZGVyKSBhcyBXZWJHTFNoYWRlcik7XG4vLyAgIGdsLmxpbmtQcm9ncmFtKHByb2dyYW0pO1xuLy8gICBpZiAoIWdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgZ2wuTElOS19TVEFUVVMpKSB7XG4vLyAgICAgY29uc3QgaW5mbyA9IGdsLmdldFByb2dyYW1JbmZvTG9nKHByb2dyYW0pO1xuLy8gICAgIGNvbnNvbGUud2FybihgRmFpbCB0byBsaW5rIHByb2dyYW06ICR7aW5mb31gKTtcbi8vICAgICBnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pO1xuLy8gICAgIHJldHVybiBudWxsO1xuLy8gICB9XG4vLyAgIHJldHVybiBwcm9ncmFtO1xuLy8gfVxuLy8gZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUdMU2hhZGVyKGdsOiBXZWJHTDJSZW5kZXJpbmdDb250ZXh0LCB0eXBlOiBHTGVudW0sIHNoYWRlclNyYzogc3RyaW5nKSB7XG4vLyAgIGNvbnN0IHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcih0eXBlKSBhcyBXZWJHTFNoYWRlcjtcbi8vICAgaWYgKHNoYWRlciA9PT0gMCkgY29uc29sZS53YXJuKCdGYWlsIHRvIGNyZWF0ZSBzaGFkZXInKTtcbi8vICAgZ2wuc2hhZGVyU291cmNlKHNoYWRlciwgc2hhZGVyU3JjKTtcbi8vICAgZ2wuY29tcGlsZVNoYWRlcihzaGFkZXIpO1xuLy8gICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSkge1xuLy8gICAgIGNvbnN0IG1lc3NhZ2UgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcik7XG4vLyAgICAgY29uc29sZS53YXJuKGBGYWlsIHRvIGNvbXBpbGUgc2hhZGVyOiAke21lc3NhZ2V9YCk7XG4vLyAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XG4vLyAgICAgcmV0dXJuIG51bGw7XG4vLyAgIH1cbi8vICAgcmV0dXJuIHNoYWRlcjtcbi8vIH1cbmZ1bmN0aW9uIGNyZWF0ZUdMUHJvZ3JhbShnbCwgdmVydFNoYWRlciwgZnJhZ1NoYWRlcikge1xuICAgIGNvbnN0IHByb2dyYW0gPSBnbC5jcmVhdGVQcm9ncmFtKCk7XG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIHZlcnRTaGFkZXIpO1xuICAgIGdsLmF0dGFjaFNoYWRlcihwcm9ncmFtLCBmcmFnU2hhZGVyKTtcbiAgICBnbC5saW5rUHJvZ3JhbShwcm9ncmFtKTtcbiAgICBpZiAoIWdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgZ2wuTElOS19TVEFUVVMpKSB7XG4gICAgICAgIGNvbnN0IGluZm8gPSBnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKTtcbiAgICAgICAgY29uc29sZS53YXJuKGBGYWlsIHRvIGxpbmsgcHJvZ3JhbTogJHtpbmZvfWApO1xuICAgICAgICBnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHByb2dyYW07XG59XG5leHBvcnRzLmNyZWF0ZUdMUHJvZ3JhbSA9IGNyZWF0ZUdMUHJvZ3JhbTtcbmZ1bmN0aW9uIGNyZWF0ZUdMU2hhZGVyKGdsLCB0eXBlLCBzaGFkZXJTcmMpIHtcbiAgICBjb25zdCBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XG4gICAgaWYgKHNoYWRlciA9PT0gMClcbiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsIHRvIGNyZWF0ZSBzaGFkZXInKTtcbiAgICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzaGFkZXJTcmMpO1xuICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcbiAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSkge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpO1xuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWwgdG8gY29tcGlsZSBzaGFkZXI6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gc2hhZGVyO1xufVxuZnVuY3Rpb24gY3JlYXRlVmVydGV4R0xTaGFkZXIoZ2wsIHNoYWRlclNyYykge1xuICAgIHJldHVybiBjcmVhdGVHTFNoYWRlcihnbCwgZ2wuVkVSVEVYX1NIQURFUiwgc2hhZGVyU3JjKTtcbn1cbmV4cG9ydHMuY3JlYXRlVmVydGV4R0xTaGFkZXIgPSBjcmVhdGVWZXJ0ZXhHTFNoYWRlcjtcbmZ1bmN0aW9uIGNyZWF0ZUZyYWdtZW50R0xTaGFkZXIoZ2wsIHNoYWRlclNyYykge1xuICAgIHJldHVybiBjcmVhdGVHTFNoYWRlcihnbCwgZ2wuRlJBR01FTlRfU0hBREVSLCBzaGFkZXJTcmMpO1xufVxuZXhwb3J0cy5jcmVhdGVGcmFnbWVudEdMU2hhZGVyID0gY3JlYXRlRnJhZ21lbnRHTFNoYWRlcjtcbmZ1bmN0aW9uIGRlbGV0ZVNoYWRlcihnbCwgc2hhZGVyKSB7XG4gICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XG59XG5leHBvcnRzLmRlbGV0ZVNoYWRlciA9IGRlbGV0ZVNoYWRlcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/gl-api.ts\n");

/***/ }),

/***/ "./src/render/render-stat.ts":
/*!***********************************!*\
  !*** ./src/render/render-stat.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.RenderStat = void 0;\nclass RenderStat {\n    constructor() {\n        this.flushedSqures = 0;\n        this.flushedCircles = 0;\n    }\n    clear() {\n        this.flushedSqures = 0;\n        this.flushedCircles = 0;\n    }\n}\nexports.RenderStat = RenderStat;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3JlbmRlci1zdGF0LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvcmVuZGVyLXN0YXQudHM/MmZkZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUmVuZGVyU3RhdCA9IHZvaWQgMDtcbmNsYXNzIFJlbmRlclN0YXQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmZsdXNoZWRTcXVyZXMgPSAwO1xuICAgICAgICB0aGlzLmZsdXNoZWRDaXJjbGVzID0gMDtcbiAgICB9XG4gICAgY2xlYXIoKSB7XG4gICAgICAgIHRoaXMuZmx1c2hlZFNxdXJlcyA9IDA7XG4gICAgICAgIHRoaXMuZmx1c2hlZENpcmNsZXMgPSAwO1xuICAgIH1cbn1cbmV4cG9ydHMuUmVuZGVyU3RhdCA9IFJlbmRlclN0YXQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/render/render-stat.ts\n");

/***/ }),

/***/ "./src/render/renderer.ts":
/*!********************************!*\
  !*** ./src/render/renderer.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.Renderer = void 0;\nconst matix_1 = __webpack_require__(/*! ../math/matix */ \"./src/math/matix.ts\");\nconst const_1 = __webpack_require__(/*! ./const */ \"./src/render/const.ts\");\nconst utils_1 = __webpack_require__(/*! ../math/utils */ \"./src/math/utils.ts\");\nconst shader_store_1 = __webpack_require__(/*! ./shader-store */ \"./src/render/shader-store.ts\");\nconst const_2 = __webpack_require__(/*! ./const */ \"./src/render/const.ts\");\nconst vbo_1 = __webpack_require__(/*! ./vbo */ \"./src/render/vbo.ts\");\nconst texture_1 = __webpack_require__(/*! ./texture */ \"./src/render/texture.ts\");\nconst framebuffer_1 = __webpack_require__(/*! ./framebuffer */ \"./src/render/framebuffer.ts\");\nconst render_stat_1 = __webpack_require__(/*! ./render-stat */ \"./src/render/render-stat.ts\");\nconst circleLayout = [\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 3,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 3,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 2,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 1,\n    },\n];\nconst squareLayout = [\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 3,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 3,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 1,\n    },\n];\nconst outLayout = [\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 3,\n    },\n    {\n        type: vbo_1.AttribType.FLOAT,\n        componentsCount: 2,\n    },\n];\nconst dataPerLineVertex = squareLayout.reduce((prev, curr) => prev + curr.componentsCount, 0);\nconst dataPerLine = dataPerLineVertex * 6;\nconst dataPerCircleVertex = circleLayout.reduce((prev, curr) => prev + curr.componentsCount, 0);\nconst dataPerCircle = dataPerCircleVertex * 6;\nconst lineBufferSize = 10000;\nconst circleBufferSize = 100;\nconst colorTexutureOptions = {\n    imageFormat: { internalFormat: texture_1.TextureFormat.RGBA, format: texture_1.TextureFormat.RGBA }\n};\nconst idTexutureOptions = {\n    imageFormat: { internalFormat: texture_1.TextureFormat.RGBA8UI, format: texture_1.TextureFormat.RGBA_INTEGER }\n};\nclass Renderer {\n    constructor(gl, screenWidth, screenHeight) {\n        this.gl = gl;\n        this.projection = null;\n        this.camera = null;\n        this.squreData = new Float32Array(lineBufferSize * dataPerLine);\n        this.circleData = new Float32Array(circleBufferSize * dataPerCircle);\n        this.squreCount = 0;\n        this.circleCount = 0;\n        this.stat = new render_stat_1.RenderStat();\n        this.squreVBO = new vbo_1.GLVBO(gl, squareLayout);\n        this.squreVBO.bind();\n        this.squreVBO.setData(this.squreData);\n        this.mainVBO = new vbo_1.GLVBO(gl, outLayout);\n        this.circleVBO = new vbo_1.GLVBO(gl, circleLayout);\n        this.circleVBO.bind();\n        this.circleVBO.setData(this.circleData);\n        gl.viewport(0, 0, screenWidth, screenHeight);\n        gl.enable(gl.DEPTH_TEST);\n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        gl.enable(gl.BLEND);\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n        const colorTexture = new texture_1.GLTexture(gl, screenWidth, screenHeight, null, colorTexutureOptions);\n        const idTexture = new texture_1.GLTexture(gl, screenWidth, screenHeight, null, idTexutureOptions);\n        const rbo = gl.createRenderbuffer();\n        gl.bindRenderbuffer(gl.RENDERBUFFER, rbo);\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH24_STENCIL8, screenWidth, screenHeight);\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n        const bufferOptions = [\n            { type: framebuffer_1.BufferAttacment.color, buffer: colorTexture, name: 'color' },\n            { type: framebuffer_1.BufferAttacment.color, buffer: idTexture, name: 'id' },\n            { type: framebuffer_1.BufferAttacment.depth, buffer: rbo, },\n        ];\n        const framebuffer = new framebuffer_1.GLFramebuffer(gl, bufferOptions);\n        this.framebuffer = framebuffer;\n        this.colorTexture = colorTexture;\n        shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.texture).useProgram();\n        shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.texture).setTextureUniform('outTexture', 0); // TODO: why can't use gl.TEXTURE0\n    }\n    beginScene(projection, camera) {\n        this.stat.clear();\n        this.projection = projection;\n        this.camera = camera;\n        if (this.isDataNotFlushed()) {\n            console.warn('Render data was not flushed from prev scene');\n        }\n        this.squreCount = 0;\n        this.circleCount = 0;\n        this.framebuffer.bind();\n        this.framebuffer.clearColorBufferFloat('color', 0, 0, 0, 1.0);\n        this.framebuffer.clearColorBufferUInt('id', 0, 0, 0, 0);\n        this.framebuffer.clearDepthBuffer();\n    }\n    drawLine(line) {\n        const lineLength = line.length;\n        const xProjection = (lineLength * Math.cos((0, utils_1.toRadians)(line.rotate)) / 2);\n        const yProjection = (lineLength * Math.sin((0, utils_1.toRadians)(line.rotate)) / 2);\n        const translate = (0, matix_1.createTranslationMatrix)(line.position.x + xProjection, line.position.y + yProjection, 0);\n        const rotate = (0, matix_1.createRotationMatrix)((0, utils_1.toRadians)(line.rotate), 0, 0);\n        const scale = (0, matix_1.createScaleMatrix)(lineLength, 0.1, 1.0);\n        this.drawSqure(translate, rotate, scale, line.color, line.id);\n    }\n    drawSqure(translate = null, rotate = null, scale = null, color, id) {\n        if (this.squreCount === lineBufferSize) {\n            let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n            this.flushSqure(modelMatrix);\n        }\n        let leftTop = (0, matix_1.createMatrix)([-0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let leftBottom = (0, matix_1.createMatrix)([-0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightTop = (0, matix_1.createMatrix)([0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightBottom = (0, matix_1.createMatrix)([0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        if (scale) {\n            leftTop = (0, matix_1.multiplyMatrix)(scale, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(scale, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(scale, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(scale, rightBottom);\n        }\n        if (rotate) {\n            leftTop = (0, matix_1.multiplyMatrix)(rotate, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(rotate, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(rotate, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(rotate, rightBottom);\n        }\n        if (translate) {\n            leftTop = (0, matix_1.multiplyMatrix)(translate, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(translate, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(translate, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(translate, rightBottom);\n        }\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 0] = (0, matix_1.getMatrixValue)(leftTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 1] = (0, matix_1.getMatrixValue)(leftTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 2] = (0, matix_1.getMatrixValue)(leftTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 0 + 6] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 1 + 6] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 2 + 6] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 0] = (0, matix_1.getMatrixValue)(rightBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 1] = (0, matix_1.getMatrixValue)(rightBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 2] = (0, matix_1.getMatrixValue)(rightBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 3 + 6] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 4 + 6] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 3] = color.x;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 4] = color.y;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 5] = color.z;\n        this.squreData[this.squreCount * dataPerLine + dataPerLineVertex * 5 + 6] = id;\n        this.squreCount += 1;\n    }\n    drawCircle(circle) {\n        if (this.circleCount === circleBufferSize) {\n            let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n            this.flushCircle(modelMatrix);\n        }\n        let leftTop = (0, matix_1.createMatrix)([-0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let leftBottom = (0, matix_1.createMatrix)([-0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightTop = (0, matix_1.createMatrix)([0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightBottom = (0, matix_1.createMatrix)([0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        const translate = (0, matix_1.createTranslationMatrix)(circle.position.x, circle.position.y, 0);\n        // const rotate = createRotationMatrix(0, 0, 0);\n        const scale = (0, matix_1.createScaleMatrix)(circle.radius * 2, circle.radius * 2, 1.0);\n        leftTop = (0, matix_1.multiplyMatrix)(scale, leftTop);\n        leftBottom = (0, matix_1.multiplyMatrix)(scale, leftBottom);\n        rightTop = (0, matix_1.multiplyMatrix)(scale, rightTop);\n        rightBottom = (0, matix_1.multiplyMatrix)(scale, rightBottom);\n        // leftTop =  multiplyMatrix(rotate, leftTop);\n        // leftBottom = multiplyMatrix(rotate, leftBottom);\n        // rightTop =  multiplyMatrix(rotate, rightTop);\n        // rightBottom = multiplyMatrix(rotate, rightBottom);\n        leftTop = (0, matix_1.multiplyMatrix)(translate, leftTop);\n        leftBottom = (0, matix_1.multiplyMatrix)(translate, leftBottom);\n        rightTop = (0, matix_1.multiplyMatrix)(translate, rightTop);\n        rightBottom = (0, matix_1.multiplyMatrix)(translate, rightBottom);\n        const color = circle.color;\n        const id = circle.id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 0] = (0, matix_1.getMatrixValue)(leftTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 1] = (0, matix_1.getMatrixValue)(leftTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 2] = (0, matix_1.getMatrixValue)(leftTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 6] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 7] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 0 + 8] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 6] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 7] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 1 + 8] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 6] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 7] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 2 + 8] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 0] = (0, matix_1.getMatrixValue)(rightBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 1] = (0, matix_1.getMatrixValue)(rightBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 2] = (0, matix_1.getMatrixValue)(rightBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 6] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 7] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 3 + 8] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 6] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 7] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 4 + 8] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 3] = color.x;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 4] = color.y;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 5] = color.z;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 6] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 7] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerCircleVertex * 5 + 8] = id;\n        this.circleCount += 1;\n    }\n    endScene() {\n        this.flush();\n        this.framebuffer.unbind();\n        shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.texture).useProgram();\n        this.gl.activeTexture(this.gl.TEXTURE0);\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.colorTexture.getGLTexture());\n        this.mainVBO.bind();\n        this.mainVBO.setData(const_2.QUAD_WITH_TEXTURE_COORD_DATA);\n        this.mainVBO.activateAllAttribPointers();\n        this.gl.drawArrays(this.gl.TRIANGLES, 0, const_2.QUAD_WITH_TEXTURE_COORD_DATA.length);\n        this.projection = null;\n        this.camera = null;\n        this.squreCount = 0;\n        this.circleCount = 0;\n    }\n    flush() {\n        let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n        this.flushSqure(modelMatrix);\n        this.flushCircle(modelMatrix);\n    }\n    getIdDataReader() {\n        return this.framebuffer.getAttachmentReader('id');\n    }\n    getDrawStat() {\n        return {\n            flushedSqures: this.stat.flushedSqures,\n            flushedCircles: this.stat.flushedCircles,\n            flushedBatchSquresCount: Math.ceil(this.stat.flushedSqures / lineBufferSize),\n            flushedBatchCirclesCount: Math.ceil(this.stat.flushedCircles / circleBufferSize),\n        };\n    }\n    flushSqure(modelMatrix) {\n        if (this.squreCount !== 0) {\n            this.stat.flushedSqures += this.squreCount;\n            shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.square).useProgram();\n            this.squreVBO.bind();\n            this.squreVBO.setData(this.squreData);\n            this.squreVBO.activateAllAttribPointers();\n            if (this.camera) {\n                shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.square).setMatrix44('MV', (0, matix_1.getRawValues)(this.camera));\n            }\n            shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.square).setMatrix44('MM', (0, matix_1.getRawValues)(modelMatrix));\n            if (this.projection) {\n                shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.square).setMatrix44('P', (0, matix_1.getRawValues)(this.projection));\n            }\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.squreCount * 6);\n        }\n        this.squreCount = 0;\n    }\n    flushCircle(modelMatrix) {\n        if (this.circleCount !== 0) {\n            this.stat.flushedCircles += this.circleCount;\n            shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.circle).useProgram();\n            this.circleVBO.bind();\n            this.circleVBO.setData(this.circleData);\n            this.circleVBO.activateAllAttribPointers();\n            if (this.camera) {\n                shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.circle).setMatrix44('MV', (0, matix_1.getRawValues)(this.camera));\n            }\n            shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.circle).setMatrix44('MM', (0, matix_1.getRawValues)(modelMatrix));\n            if (this.projection) {\n                shader_store_1.shaderStore.getProgram(shader_store_1.ShaderProgramIndex.circle).setMatrix44('P', (0, matix_1.getRawValues)(this.projection));\n            }\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.circleCount * 6);\n        }\n        this.circleCount = 0;\n    }\n    isDataNotFlushed() {\n        return this.squreCount !== 0 || this.circleCount !== 0;\n    }\n}\nexports.Renderer = Renderer;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3JlbmRlcmVyLnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGdCQUFnQjtBQUNoQixnQkFBZ0IsbUJBQU8sQ0FBQywwQ0FBZTtBQUN2QyxnQkFBZ0IsbUJBQU8sQ0FBQyxzQ0FBUztBQUNqQyxnQkFBZ0IsbUJBQU8sQ0FBQywwQ0FBZTtBQUN2Qyx1QkFBdUIsbUJBQU8sQ0FBQyxvREFBZ0I7QUFDL0MsZ0JBQWdCLG1CQUFPLENBQUMsc0NBQVM7QUFDakMsY0FBYyxtQkFBTyxDQUFDLGtDQUFPO0FBQzdCLGtCQUFrQixtQkFBTyxDQUFDLDBDQUFXO0FBQ3JDLHNCQUFzQixtQkFBTyxDQUFDLGtEQUFlO0FBQzdDLHNCQUFzQixtQkFBTyxDQUFDLGtEQUFlO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxnRkFBZ0Y7QUFDOUYsY0FBYywwRUFBMEU7QUFDeEYsY0FBYyx5REFBeUQ7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZIQUE2SDtBQUM3SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3JlbmRlci9yZW5kZXJlci50cz9jOGNkIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5SZW5kZXJlciA9IHZvaWQgMDtcbmNvbnN0IG1hdGl4XzEgPSByZXF1aXJlKFwiLi4vbWF0aC9tYXRpeFwiKTtcbmNvbnN0IGNvbnN0XzEgPSByZXF1aXJlKFwiLi9jb25zdFwiKTtcbmNvbnN0IHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vbWF0aC91dGlsc1wiKTtcbmNvbnN0IHNoYWRlcl9zdG9yZV8xID0gcmVxdWlyZShcIi4vc2hhZGVyLXN0b3JlXCIpO1xuY29uc3QgY29uc3RfMiA9IHJlcXVpcmUoXCIuL2NvbnN0XCIpO1xuY29uc3QgdmJvXzEgPSByZXF1aXJlKFwiLi92Ym9cIik7XG5jb25zdCB0ZXh0dXJlXzEgPSByZXF1aXJlKFwiLi90ZXh0dXJlXCIpO1xuY29uc3QgZnJhbWVidWZmZXJfMSA9IHJlcXVpcmUoXCIuL2ZyYW1lYnVmZmVyXCIpO1xuY29uc3QgcmVuZGVyX3N0YXRfMSA9IHJlcXVpcmUoXCIuL3JlbmRlci1zdGF0XCIpO1xuY29uc3QgY2lyY2xlTGF5b3V0ID0gW1xuICAgIHtcbiAgICAgICAgdHlwZTogdmJvXzEuQXR0cmliVHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c0NvdW50OiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgICB0eXBlOiB2Ym9fMS5BdHRyaWJUeXBlLkZMT0FULFxuICAgICAgICBjb21wb25lbnRzQ291bnQ6IDMsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIHR5cGU6IHZib18xLkF0dHJpYlR5cGUuRkxPQVQsXG4gICAgICAgIGNvbXBvbmVudHNDb3VudDogMixcbiAgICB9LFxuICAgIHtcbiAgICAgICAgdHlwZTogdmJvXzEuQXR0cmliVHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c0NvdW50OiAxLFxuICAgIH0sXG5dO1xuY29uc3Qgc3F1YXJlTGF5b3V0ID0gW1xuICAgIHtcbiAgICAgICAgdHlwZTogdmJvXzEuQXR0cmliVHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c0NvdW50OiAzLFxuICAgIH0sXG4gICAge1xuICAgICAgICB0eXBlOiB2Ym9fMS5BdHRyaWJUeXBlLkZMT0FULFxuICAgICAgICBjb21wb25lbnRzQ291bnQ6IDMsXG4gICAgfSxcbiAgICB7XG4gICAgICAgIHR5cGU6IHZib18xLkF0dHJpYlR5cGUuRkxPQVQsXG4gICAgICAgIGNvbXBvbmVudHNDb3VudDogMSxcbiAgICB9LFxuXTtcbmNvbnN0IG91dExheW91dCA9IFtcbiAgICB7XG4gICAgICAgIHR5cGU6IHZib18xLkF0dHJpYlR5cGUuRkxPQVQsXG4gICAgICAgIGNvbXBvbmVudHNDb3VudDogMyxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgdHlwZTogdmJvXzEuQXR0cmliVHlwZS5GTE9BVCxcbiAgICAgICAgY29tcG9uZW50c0NvdW50OiAyLFxuICAgIH0sXG5dO1xuY29uc3QgZGF0YVBlckxpbmVWZXJ0ZXggPSBzcXVhcmVMYXlvdXQucmVkdWNlKChwcmV2LCBjdXJyKSA9PiBwcmV2ICsgY3Vyci5jb21wb25lbnRzQ291bnQsIDApO1xuY29uc3QgZGF0YVBlckxpbmUgPSBkYXRhUGVyTGluZVZlcnRleCAqIDY7XG5jb25zdCBkYXRhUGVyQ2lyY2xlVmVydGV4ID0gY2lyY2xlTGF5b3V0LnJlZHVjZSgocHJldiwgY3VycikgPT4gcHJldiArIGN1cnIuY29tcG9uZW50c0NvdW50LCAwKTtcbmNvbnN0IGRhdGFQZXJDaXJjbGUgPSBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNjtcbmNvbnN0IGxpbmVCdWZmZXJTaXplID0gMTAwMDA7XG5jb25zdCBjaXJjbGVCdWZmZXJTaXplID0gMTAwO1xuY29uc3QgY29sb3JUZXh1dHVyZU9wdGlvbnMgPSB7XG4gICAgaW1hZ2VGb3JtYXQ6IHsgaW50ZXJuYWxGb3JtYXQ6IHRleHR1cmVfMS5UZXh0dXJlRm9ybWF0LlJHQkEsIGZvcm1hdDogdGV4dHVyZV8xLlRleHR1cmVGb3JtYXQuUkdCQSB9XG59O1xuY29uc3QgaWRUZXh1dHVyZU9wdGlvbnMgPSB7XG4gICAgaW1hZ2VGb3JtYXQ6IHsgaW50ZXJuYWxGb3JtYXQ6IHRleHR1cmVfMS5UZXh0dXJlRm9ybWF0LlJHQkE4VUksIGZvcm1hdDogdGV4dHVyZV8xLlRleHR1cmVGb3JtYXQuUkdCQV9JTlRFR0VSIH1cbn07XG5jbGFzcyBSZW5kZXJlciB7XG4gICAgY29uc3RydWN0b3IoZ2wsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpIHtcbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgICAgICB0aGlzLnByb2plY3Rpb24gPSBudWxsO1xuICAgICAgICB0aGlzLmNhbWVyYSA9IG51bGw7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhID0gbmV3IEZsb2F0MzJBcnJheShsaW5lQnVmZmVyU2l6ZSAqIGRhdGFQZXJMaW5lKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhID0gbmV3IEZsb2F0MzJBcnJheShjaXJjbGVCdWZmZXJTaXplICogZGF0YVBlckNpcmNsZSk7XG4gICAgICAgIHRoaXMuc3F1cmVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuY2lyY2xlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLnN0YXQgPSBuZXcgcmVuZGVyX3N0YXRfMS5SZW5kZXJTdGF0KCk7XG4gICAgICAgIHRoaXMuc3F1cmVWQk8gPSBuZXcgdmJvXzEuR0xWQk8oZ2wsIHNxdWFyZUxheW91dCk7XG4gICAgICAgIHRoaXMuc3F1cmVWQk8uYmluZCgpO1xuICAgICAgICB0aGlzLnNxdXJlVkJPLnNldERhdGEodGhpcy5zcXVyZURhdGEpO1xuICAgICAgICB0aGlzLm1haW5WQk8gPSBuZXcgdmJvXzEuR0xWQk8oZ2wsIG91dExheW91dCk7XG4gICAgICAgIHRoaXMuY2lyY2xlVkJPID0gbmV3IHZib18xLkdMVkJPKGdsLCBjaXJjbGVMYXlvdXQpO1xuICAgICAgICB0aGlzLmNpcmNsZVZCTy5iaW5kKCk7XG4gICAgICAgIHRoaXMuY2lyY2xlVkJPLnNldERhdGEodGhpcy5jaXJjbGVEYXRhKTtcbiAgICAgICAgZ2wudmlld3BvcnQoMCwgMCwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCk7XG4gICAgICAgIGdsLmVuYWJsZShnbC5ERVBUSF9URVNUKTtcbiAgICAgICAgZ2wuY2xlYXJDb2xvcigwLjAsIDAuMCwgMC4wLCAxLjApO1xuICAgICAgICBnbC5lbmFibGUoZ2wuQkxFTkQpO1xuICAgICAgICBnbC5ibGVuZEZ1bmMoZ2wuU1JDX0FMUEhBLCBnbC5PTkVfTUlOVVNfU1JDX0FMUEhBKTtcbiAgICAgICAgY29uc3QgY29sb3JUZXh0dXJlID0gbmV3IHRleHR1cmVfMS5HTFRleHR1cmUoZ2wsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIG51bGwsIGNvbG9yVGV4dXR1cmVPcHRpb25zKTtcbiAgICAgICAgY29uc3QgaWRUZXh0dXJlID0gbmV3IHRleHR1cmVfMS5HTFRleHR1cmUoZ2wsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIG51bGwsIGlkVGV4dXR1cmVPcHRpb25zKTtcbiAgICAgICAgY29uc3QgcmJvID0gZ2wuY3JlYXRlUmVuZGVyYnVmZmVyKCk7XG4gICAgICAgIGdsLmJpbmRSZW5kZXJidWZmZXIoZ2wuUkVOREVSQlVGRkVSLCByYm8pO1xuICAgICAgICBnbC5yZW5kZXJidWZmZXJTdG9yYWdlKGdsLlJFTkRFUkJVRkZFUiwgZ2wuREVQVEgyNF9TVEVOQ0lMOCwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCk7XG4gICAgICAgIGdsLmJpbmRSZW5kZXJidWZmZXIoZ2wuUkVOREVSQlVGRkVSLCBudWxsKTtcbiAgICAgICAgY29uc3QgYnVmZmVyT3B0aW9ucyA9IFtcbiAgICAgICAgICAgIHsgdHlwZTogZnJhbWVidWZmZXJfMS5CdWZmZXJBdHRhY21lbnQuY29sb3IsIGJ1ZmZlcjogY29sb3JUZXh0dXJlLCBuYW1lOiAnY29sb3InIH0sXG4gICAgICAgICAgICB7IHR5cGU6IGZyYW1lYnVmZmVyXzEuQnVmZmVyQXR0YWNtZW50LmNvbG9yLCBidWZmZXI6IGlkVGV4dHVyZSwgbmFtZTogJ2lkJyB9LFxuICAgICAgICAgICAgeyB0eXBlOiBmcmFtZWJ1ZmZlcl8xLkJ1ZmZlckF0dGFjbWVudC5kZXB0aCwgYnVmZmVyOiByYm8sIH0sXG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IGZyYW1lYnVmZmVyID0gbmV3IGZyYW1lYnVmZmVyXzEuR0xGcmFtZWJ1ZmZlcihnbCwgYnVmZmVyT3B0aW9ucyk7XG4gICAgICAgIHRoaXMuZnJhbWVidWZmZXIgPSBmcmFtZWJ1ZmZlcjtcbiAgICAgICAgdGhpcy5jb2xvclRleHR1cmUgPSBjb2xvclRleHR1cmU7XG4gICAgICAgIHNoYWRlcl9zdG9yZV8xLnNoYWRlclN0b3JlLmdldFByb2dyYW0oc2hhZGVyX3N0b3JlXzEuU2hhZGVyUHJvZ3JhbUluZGV4LnRleHR1cmUpLnVzZVByb2dyYW0oKTtcbiAgICAgICAgc2hhZGVyX3N0b3JlXzEuc2hhZGVyU3RvcmUuZ2V0UHJvZ3JhbShzaGFkZXJfc3RvcmVfMS5TaGFkZXJQcm9ncmFtSW5kZXgudGV4dHVyZSkuc2V0VGV4dHVyZVVuaWZvcm0oJ291dFRleHR1cmUnLCAwKTsgLy8gVE9ETzogd2h5IGNhbid0IHVzZSBnbC5URVhUVVJFMFxuICAgIH1cbiAgICBiZWdpblNjZW5lKHByb2plY3Rpb24sIGNhbWVyYSkge1xuICAgICAgICB0aGlzLnN0YXQuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5wcm9qZWN0aW9uID0gcHJvamVjdGlvbjtcbiAgICAgICAgdGhpcy5jYW1lcmEgPSBjYW1lcmE7XG4gICAgICAgIGlmICh0aGlzLmlzRGF0YU5vdEZsdXNoZWQoKSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdSZW5kZXIgZGF0YSB3YXMgbm90IGZsdXNoZWQgZnJvbSBwcmV2IHNjZW5lJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcXVyZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuZnJhbWVidWZmZXIuYmluZCgpO1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyLmNsZWFyQ29sb3JCdWZmZXJGbG9hdCgnY29sb3InLCAwLCAwLCAwLCAxLjApO1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyLmNsZWFyQ29sb3JCdWZmZXJVSW50KCdpZCcsIDAsIDAsIDAsIDApO1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyLmNsZWFyRGVwdGhCdWZmZXIoKTtcbiAgICB9XG4gICAgZHJhd0xpbmUobGluZSkge1xuICAgICAgICBjb25zdCBsaW5lTGVuZ3RoID0gbGluZS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHhQcm9qZWN0aW9uID0gKGxpbmVMZW5ndGggKiBNYXRoLmNvcygoMCwgdXRpbHNfMS50b1JhZGlhbnMpKGxpbmUucm90YXRlKSkgLyAyKTtcbiAgICAgICAgY29uc3QgeVByb2plY3Rpb24gPSAobGluZUxlbmd0aCAqIE1hdGguc2luKCgwLCB1dGlsc18xLnRvUmFkaWFucykobGluZS5yb3RhdGUpKSAvIDIpO1xuICAgICAgICBjb25zdCB0cmFuc2xhdGUgPSAoMCwgbWF0aXhfMS5jcmVhdGVUcmFuc2xhdGlvbk1hdHJpeCkobGluZS5wb3NpdGlvbi54ICsgeFByb2plY3Rpb24sIGxpbmUucG9zaXRpb24ueSArIHlQcm9qZWN0aW9uLCAwKTtcbiAgICAgICAgY29uc3Qgcm90YXRlID0gKDAsIG1hdGl4XzEuY3JlYXRlUm90YXRpb25NYXRyaXgpKCgwLCB1dGlsc18xLnRvUmFkaWFucykobGluZS5yb3RhdGUpLCAwLCAwKTtcbiAgICAgICAgY29uc3Qgc2NhbGUgPSAoMCwgbWF0aXhfMS5jcmVhdGVTY2FsZU1hdHJpeCkobGluZUxlbmd0aCwgMC4xLCAxLjApO1xuICAgICAgICB0aGlzLmRyYXdTcXVyZSh0cmFuc2xhdGUsIHJvdGF0ZSwgc2NhbGUsIGxpbmUuY29sb3IsIGxpbmUuaWQpO1xuICAgIH1cbiAgICBkcmF3U3F1cmUodHJhbnNsYXRlID0gbnVsbCwgcm90YXRlID0gbnVsbCwgc2NhbGUgPSBudWxsLCBjb2xvciwgaWQpIHtcbiAgICAgICAgaWYgKHRoaXMuc3F1cmVDb3VudCA9PT0gbGluZUJ1ZmZlclNpemUpIHtcbiAgICAgICAgICAgIGxldCBtb2RlbE1hdHJpeCA9ICgwLCBtYXRpeF8xLnRyYW5zcG9zZU1hdHJpeCkoKDAsIG1hdGl4XzEuY3JlYXRlVW5pdE1hdHJpeCkoMS4wKSk7XG4gICAgICAgICAgICB0aGlzLmZsdXNoU3F1cmUobW9kZWxNYXRyaXgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBsZWZ0VG9wID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgMC41LCBjb25zdF8xLnBhaXRpbmdMYXllciwgMS4wXSwgNCwgMSk7XG4gICAgICAgIGxldCBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgLTAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIDAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIC0wLjUsIGNvbnN0XzEucGFpdGluZ0xheWVyLCAxLjBdLCA0LCAxKTtcbiAgICAgICAgaWYgKHNjYWxlKSB7XG4gICAgICAgICAgICBsZWZ0VG9wID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCBsZWZ0VG9wKTtcbiAgICAgICAgICAgIGxlZnRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIGxlZnRCb3R0b20pO1xuICAgICAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgICAgIHJpZ2h0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0ZSkge1xuICAgICAgICAgICAgbGVmdFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIGxlZnRUb3ApO1xuICAgICAgICAgICAgbGVmdEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIGxlZnRCb3R0b20pO1xuICAgICAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkocm90YXRlLCByaWdodFRvcCk7XG4gICAgICAgICAgICByaWdodEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIHJpZ2h0Qm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJhbnNsYXRlKSB7XG4gICAgICAgICAgICBsZWZ0VG9wID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgbGVmdFRvcCk7XG4gICAgICAgICAgICBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgbGVmdEJvdHRvbSk7XG4gICAgICAgICAgICByaWdodFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgICAgIHJpZ2h0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgcmlnaHRCb3R0b20pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAwICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdFRvcCwgMCwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAwICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdFRvcCwgMSwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAwICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdFRvcCwgMiwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAwICsgM10gPSBjb2xvci54O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMCArIDRdID0gY29sb3IueTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDAgKyA1XSA9IGNvbG9yLno7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAwICsgNl0gPSBpZDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDEgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMCwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAxICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMSArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAyLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDEgKyAzXSA9IGNvbG9yLng7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAxICsgNF0gPSBjb2xvci55O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMSArIDVdID0gY29sb3IuejtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDEgKyA2XSA9IGlkO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMiArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMiArIDFdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMiArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDIsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMiArIDNdID0gY29sb3IueDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDIgKyA0XSA9IGNvbG9yLnk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAyICsgNV0gPSBjb2xvci56O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMiArIDZdID0gaWQ7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAzICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRCb3R0b20sIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMyArIDFdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0Qm90dG9tLCAxLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDMgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAzICsgM10gPSBjb2xvci54O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogMyArIDRdID0gY29sb3IueTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDMgKyA1XSA9IGNvbG9yLno7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiAzICsgNl0gPSBpZDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDQgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMCwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiA0ICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNCArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAyLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDQgKyAzXSA9IGNvbG9yLng7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiA0ICsgNF0gPSBjb2xvci55O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNCArIDVdID0gY29sb3IuejtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDQgKyA2XSA9IGlkO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNSArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNSArIDFdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNSArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDIsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNSArIDNdID0gY29sb3IueDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyTGluZVZlcnRleCAqIDUgKyA0XSA9IGNvbG9yLnk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlckxpbmVWZXJ0ZXggKiA1ICsgNV0gPSBjb2xvci56O1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJMaW5lVmVydGV4ICogNSArIDZdID0gaWQ7XG4gICAgICAgIHRoaXMuc3F1cmVDb3VudCArPSAxO1xuICAgIH1cbiAgICBkcmF3Q2lyY2xlKGNpcmNsZSkge1xuICAgICAgICBpZiAodGhpcy5jaXJjbGVDb3VudCA9PT0gY2lyY2xlQnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgbGV0IG1vZGVsTWF0cml4ID0gKDAsIG1hdGl4XzEudHJhbnNwb3NlTWF0cml4KSgoMCwgbWF0aXhfMS5jcmVhdGVVbml0TWF0cml4KSgxLjApKTtcbiAgICAgICAgICAgIHRoaXMuZmx1c2hDaXJjbGUobW9kZWxNYXRyaXgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBsZWZ0VG9wID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgMC41LCBjb25zdF8xLnBhaXRpbmdMYXllciwgMS4wXSwgNCwgMSk7XG4gICAgICAgIGxldCBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgLTAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIDAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIC0wLjUsIGNvbnN0XzEucGFpdGluZ0xheWVyLCAxLjBdLCA0LCAxKTtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlID0gKDAsIG1hdGl4XzEuY3JlYXRlVHJhbnNsYXRpb25NYXRyaXgpKGNpcmNsZS5wb3NpdGlvbi54LCBjaXJjbGUucG9zaXRpb24ueSwgMCk7XG4gICAgICAgIC8vIGNvbnN0IHJvdGF0ZSA9IGNyZWF0ZVJvdGF0aW9uTWF0cml4KDAsIDAsIDApO1xuICAgICAgICBjb25zdCBzY2FsZSA9ICgwLCBtYXRpeF8xLmNyZWF0ZVNjYWxlTWF0cml4KShjaXJjbGUucmFkaXVzICogMiwgY2lyY2xlLnJhZGl1cyAqIDIsIDEuMCk7XG4gICAgICAgIGxlZnRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIGxlZnRUb3ApO1xuICAgICAgICBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCBsZWZ0Qm90dG9tKTtcbiAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0Qm90dG9tKTtcbiAgICAgICAgLy8gbGVmdFRvcCA9ICBtdWx0aXBseU1hdHJpeChyb3RhdGUsIGxlZnRUb3ApO1xuICAgICAgICAvLyBsZWZ0Qm90dG9tID0gbXVsdGlwbHlNYXRyaXgocm90YXRlLCBsZWZ0Qm90dG9tKTtcbiAgICAgICAgLy8gcmlnaHRUb3AgPSAgbXVsdGlwbHlNYXRyaXgocm90YXRlLCByaWdodFRvcCk7XG4gICAgICAgIC8vIHJpZ2h0Qm90dG9tID0gbXVsdGlwbHlNYXRyaXgocm90YXRlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIGxlZnRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodHJhbnNsYXRlLCBsZWZ0VG9wKTtcbiAgICAgICAgbGVmdEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIGxlZnRCb3R0b20pO1xuICAgICAgICByaWdodFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodHJhbnNsYXRlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIGNvbnN0IGNvbG9yID0gY2lyY2xlLmNvbG9yO1xuICAgICAgICBjb25zdCBpZCA9IGNpcmNsZS5pZDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAxLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAyLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyAzXSA9IGNvbG9yLng7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAwICsgNF0gPSBjb2xvci55O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMCArIDVdID0gY29sb3IuejtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyA2XSA9IDAuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyA3XSA9IDEuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDAgKyA4XSA9IGlkO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMSArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDEgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAxICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMSArIDNdID0gY29sb3IueDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDEgKyA0XSA9IGNvbG9yLnk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAxICsgNV0gPSBjb2xvci56O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMSArIDZdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMSArIDddID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMSArIDhdID0gaWQ7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgM10gPSBjb2xvci54O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMiArIDRdID0gY29sb3IueTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDIgKyA1XSA9IGNvbG9yLno7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgNl0gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgN10gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAyICsgOF0gPSBpZDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDMgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAzICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRCb3R0b20sIDEsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMyArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0Qm90dG9tLCAyLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDMgKyAzXSA9IGNvbG9yLng7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiAzICsgNF0gPSBjb2xvci55O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogMyArIDVdID0gY29sb3IuejtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDMgKyA2XSA9IDEuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDMgKyA3XSA9IDAuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDMgKyA4XSA9IGlkO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNCArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDQgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA0ICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNCArIDNdID0gY29sb3IueDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDQgKyA0XSA9IGNvbG9yLnk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA0ICsgNV0gPSBjb2xvci56O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNCArIDZdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNCArIDddID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNCArIDhdID0gaWQ7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgM10gPSBjb2xvci54O1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyQ2lyY2xlVmVydGV4ICogNSArIDRdID0gY29sb3IueTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlckNpcmNsZVZlcnRleCAqIDUgKyA1XSA9IGNvbG9yLno7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgNl0gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgN10gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJDaXJjbGVWZXJ0ZXggKiA1ICsgOF0gPSBpZDtcbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCArPSAxO1xuICAgIH1cbiAgICBlbmRTY2VuZSgpIHtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyLnVuYmluZCgpO1xuICAgICAgICBzaGFkZXJfc3RvcmVfMS5zaGFkZXJTdG9yZS5nZXRQcm9ncmFtKHNoYWRlcl9zdG9yZV8xLlNoYWRlclByb2dyYW1JbmRleC50ZXh0dXJlKS51c2VQcm9ncmFtKCk7XG4gICAgICAgIHRoaXMuZ2wuYWN0aXZlVGV4dHVyZSh0aGlzLmdsLlRFWFRVUkUwKTtcbiAgICAgICAgdGhpcy5nbC5iaW5kVGV4dHVyZSh0aGlzLmdsLlRFWFRVUkVfMkQsIHRoaXMuY29sb3JUZXh0dXJlLmdldEdMVGV4dHVyZSgpKTtcbiAgICAgICAgdGhpcy5tYWluVkJPLmJpbmQoKTtcbiAgICAgICAgdGhpcy5tYWluVkJPLnNldERhdGEoY29uc3RfMi5RVUFEX1dJVEhfVEVYVFVSRV9DT09SRF9EQVRBKTtcbiAgICAgICAgdGhpcy5tYWluVkJPLmFjdGl2YXRlQWxsQXR0cmliUG9pbnRlcnMoKTtcbiAgICAgICAgdGhpcy5nbC5kcmF3QXJyYXlzKHRoaXMuZ2wuVFJJQU5HTEVTLCAwLCBjb25zdF8yLlFVQURfV0lUSF9URVhUVVJFX0NPT1JEX0RBVEEubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5wcm9qZWN0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5jYW1lcmEgPSBudWxsO1xuICAgICAgICB0aGlzLnNxdXJlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLmNpcmNsZUNvdW50ID0gMDtcbiAgICB9XG4gICAgZmx1c2goKSB7XG4gICAgICAgIGxldCBtb2RlbE1hdHJpeCA9ICgwLCBtYXRpeF8xLnRyYW5zcG9zZU1hdHJpeCkoKDAsIG1hdGl4XzEuY3JlYXRlVW5pdE1hdHJpeCkoMS4wKSk7XG4gICAgICAgIHRoaXMuZmx1c2hTcXVyZShtb2RlbE1hdHJpeCk7XG4gICAgICAgIHRoaXMuZmx1c2hDaXJjbGUobW9kZWxNYXRyaXgpO1xuICAgIH1cbiAgICBnZXRJZERhdGFSZWFkZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZyYW1lYnVmZmVyLmdldEF0dGFjaG1lbnRSZWFkZXIoJ2lkJyk7XG4gICAgfVxuICAgIGdldERyYXdTdGF0KCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZmx1c2hlZFNxdXJlczogdGhpcy5zdGF0LmZsdXNoZWRTcXVyZXMsXG4gICAgICAgICAgICBmbHVzaGVkQ2lyY2xlczogdGhpcy5zdGF0LmZsdXNoZWRDaXJjbGVzLFxuICAgICAgICAgICAgZmx1c2hlZEJhdGNoU3F1cmVzQ291bnQ6IE1hdGguY2VpbCh0aGlzLnN0YXQuZmx1c2hlZFNxdXJlcyAvIGxpbmVCdWZmZXJTaXplKSxcbiAgICAgICAgICAgIGZsdXNoZWRCYXRjaENpcmNsZXNDb3VudDogTWF0aC5jZWlsKHRoaXMuc3RhdC5mbHVzaGVkQ2lyY2xlcyAvIGNpcmNsZUJ1ZmZlclNpemUpLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBmbHVzaFNxdXJlKG1vZGVsTWF0cml4KSB7XG4gICAgICAgIGlmICh0aGlzLnNxdXJlQ291bnQgIT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdC5mbHVzaGVkU3F1cmVzICs9IHRoaXMuc3F1cmVDb3VudDtcbiAgICAgICAgICAgIHNoYWRlcl9zdG9yZV8xLnNoYWRlclN0b3JlLmdldFByb2dyYW0oc2hhZGVyX3N0b3JlXzEuU2hhZGVyUHJvZ3JhbUluZGV4LnNxdWFyZSkudXNlUHJvZ3JhbSgpO1xuICAgICAgICAgICAgdGhpcy5zcXVyZVZCTy5iaW5kKCk7XG4gICAgICAgICAgICB0aGlzLnNxdXJlVkJPLnNldERhdGEodGhpcy5zcXVyZURhdGEpO1xuICAgICAgICAgICAgdGhpcy5zcXVyZVZCTy5hY3RpdmF0ZUFsbEF0dHJpYlBvaW50ZXJzKCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW1lcmEpIHtcbiAgICAgICAgICAgICAgICBzaGFkZXJfc3RvcmVfMS5zaGFkZXJTdG9yZS5nZXRQcm9ncmFtKHNoYWRlcl9zdG9yZV8xLlNoYWRlclByb2dyYW1JbmRleC5zcXVhcmUpLnNldE1hdHJpeDQ0KCdNVicsICgwLCBtYXRpeF8xLmdldFJhd1ZhbHVlcykodGhpcy5jYW1lcmEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNoYWRlcl9zdG9yZV8xLnNoYWRlclN0b3JlLmdldFByb2dyYW0oc2hhZGVyX3N0b3JlXzEuU2hhZGVyUHJvZ3JhbUluZGV4LnNxdWFyZSkuc2V0TWF0cml4NDQoJ01NJywgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKShtb2RlbE1hdHJpeCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvamVjdGlvbikge1xuICAgICAgICAgICAgICAgIHNoYWRlcl9zdG9yZV8xLnNoYWRlclN0b3JlLmdldFByb2dyYW0oc2hhZGVyX3N0b3JlXzEuU2hhZGVyUHJvZ3JhbUluZGV4LnNxdWFyZSkuc2V0TWF0cml4NDQoJ1AnLCAoMCwgbWF0aXhfMS5nZXRSYXdWYWx1ZXMpKHRoaXMucHJvamVjdGlvbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nbC5kcmF3QXJyYXlzKHRoaXMuZ2wuVFJJQU5HTEVTLCAwLCB0aGlzLnNxdXJlQ291bnQgKiA2KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNxdXJlQ291bnQgPSAwO1xuICAgIH1cbiAgICBmbHVzaENpcmNsZShtb2RlbE1hdHJpeCkge1xuICAgICAgICBpZiAodGhpcy5jaXJjbGVDb3VudCAhPT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0LmZsdXNoZWRDaXJjbGVzICs9IHRoaXMuY2lyY2xlQ291bnQ7XG4gICAgICAgICAgICBzaGFkZXJfc3RvcmVfMS5zaGFkZXJTdG9yZS5nZXRQcm9ncmFtKHNoYWRlcl9zdG9yZV8xLlNoYWRlclByb2dyYW1JbmRleC5jaXJjbGUpLnVzZVByb2dyYW0oKTtcbiAgICAgICAgICAgIHRoaXMuY2lyY2xlVkJPLmJpbmQoKTtcbiAgICAgICAgICAgIHRoaXMuY2lyY2xlVkJPLnNldERhdGEodGhpcy5jaXJjbGVEYXRhKTtcbiAgICAgICAgICAgIHRoaXMuY2lyY2xlVkJPLmFjdGl2YXRlQWxsQXR0cmliUG9pbnRlcnMoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbWVyYSkge1xuICAgICAgICAgICAgICAgIHNoYWRlcl9zdG9yZV8xLnNoYWRlclN0b3JlLmdldFByb2dyYW0oc2hhZGVyX3N0b3JlXzEuU2hhZGVyUHJvZ3JhbUluZGV4LmNpcmNsZSkuc2V0TWF0cml4NDQoJ01WJywgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKSh0aGlzLmNhbWVyYSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hhZGVyX3N0b3JlXzEuc2hhZGVyU3RvcmUuZ2V0UHJvZ3JhbShzaGFkZXJfc3RvcmVfMS5TaGFkZXJQcm9ncmFtSW5kZXguY2lyY2xlKS5zZXRNYXRyaXg0NCgnTU0nLCAoMCwgbWF0aXhfMS5nZXRSYXdWYWx1ZXMpKG1vZGVsTWF0cml4KSk7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9qZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgc2hhZGVyX3N0b3JlXzEuc2hhZGVyU3RvcmUuZ2V0UHJvZ3JhbShzaGFkZXJfc3RvcmVfMS5TaGFkZXJQcm9ncmFtSW5kZXguY2lyY2xlKS5zZXRNYXRyaXg0NCgnUCcsICgwLCBtYXRpeF8xLmdldFJhd1ZhbHVlcykodGhpcy5wcm9qZWN0aW9uKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmdsLmRyYXdBcnJheXModGhpcy5nbC5UUklBTkdMRVMsIDAsIHRoaXMuY2lyY2xlQ291bnQgKiA2KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNpcmNsZUNvdW50ID0gMDtcbiAgICB9XG4gICAgaXNEYXRhTm90Rmx1c2hlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3F1cmVDb3VudCAhPT0gMCB8fCB0aGlzLmNpcmNsZUNvdW50ICE9PSAwO1xuICAgIH1cbn1cbmV4cG9ydHMuUmVuZGVyZXIgPSBSZW5kZXJlcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/renderer.ts\n");

/***/ }),

/***/ "./src/render/shader-store.ts":
/*!************************************!*\
  !*** ./src/render/shader-store.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.shaderStore = exports.ShaderStore = exports.ShaderProgramIndex = exports.ShaderStoreMaxSize = void 0;\nexports.ShaderStoreMaxSize = 32;\nvar ShaderProgramIndex;\n(function (ShaderProgramIndex) {\n    ShaderProgramIndex[ShaderProgramIndex[\"texture\"] = 0] = \"texture\";\n    ShaderProgramIndex[ShaderProgramIndex[\"square\"] = 1] = \"square\";\n    ShaderProgramIndex[ShaderProgramIndex[\"circle\"] = 2] = \"circle\";\n})(ShaderProgramIndex = exports.ShaderProgramIndex || (exports.ShaderProgramIndex = {}));\nclass ShaderStore {\n    constructor() {\n        this.store = new Array(exports.ShaderStoreMaxSize).fill(null);\n    }\n    setProgram(index, program) {\n        this.store[index] = program;\n    }\n    getProgram(index) {\n        return this.store[index];\n    }\n}\nexports.ShaderStore = ShaderStore;\nlet shaderStore = new ShaderStore();\nexports.shaderStore = shaderStore;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3NoYWRlci1zdG9yZS50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxtQkFBbUIsR0FBRyxtQkFBbUIsR0FBRywwQkFBMEIsR0FBRywwQkFBMEI7QUFDbkcsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNEQUFzRCwwQkFBMEIsS0FBSztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0EsbUJBQW1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3JlbmRlci9zaGFkZXItc3RvcmUudHM/Y2U1MCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuc2hhZGVyU3RvcmUgPSBleHBvcnRzLlNoYWRlclN0b3JlID0gZXhwb3J0cy5TaGFkZXJQcm9ncmFtSW5kZXggPSBleHBvcnRzLlNoYWRlclN0b3JlTWF4U2l6ZSA9IHZvaWQgMDtcbmV4cG9ydHMuU2hhZGVyU3RvcmVNYXhTaXplID0gMzI7XG52YXIgU2hhZGVyUHJvZ3JhbUluZGV4O1xuKGZ1bmN0aW9uIChTaGFkZXJQcm9ncmFtSW5kZXgpIHtcbiAgICBTaGFkZXJQcm9ncmFtSW5kZXhbU2hhZGVyUHJvZ3JhbUluZGV4W1widGV4dHVyZVwiXSA9IDBdID0gXCJ0ZXh0dXJlXCI7XG4gICAgU2hhZGVyUHJvZ3JhbUluZGV4W1NoYWRlclByb2dyYW1JbmRleFtcInNxdWFyZVwiXSA9IDFdID0gXCJzcXVhcmVcIjtcbiAgICBTaGFkZXJQcm9ncmFtSW5kZXhbU2hhZGVyUHJvZ3JhbUluZGV4W1wiY2lyY2xlXCJdID0gMl0gPSBcImNpcmNsZVwiO1xufSkoU2hhZGVyUHJvZ3JhbUluZGV4ID0gZXhwb3J0cy5TaGFkZXJQcm9ncmFtSW5kZXggfHwgKGV4cG9ydHMuU2hhZGVyUHJvZ3JhbUluZGV4ID0ge30pKTtcbmNsYXNzIFNoYWRlclN0b3JlIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zdG9yZSA9IG5ldyBBcnJheShleHBvcnRzLlNoYWRlclN0b3JlTWF4U2l6ZSkuZmlsbChudWxsKTtcbiAgICB9XG4gICAgc2V0UHJvZ3JhbShpbmRleCwgcHJvZ3JhbSkge1xuICAgICAgICB0aGlzLnN0b3JlW2luZGV4XSA9IHByb2dyYW07XG4gICAgfVxuICAgIGdldFByb2dyYW0oaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmVbaW5kZXhdO1xuICAgIH1cbn1cbmV4cG9ydHMuU2hhZGVyU3RvcmUgPSBTaGFkZXJTdG9yZTtcbmxldCBzaGFkZXJTdG9yZSA9IG5ldyBTaGFkZXJTdG9yZSgpO1xuZXhwb3J0cy5zaGFkZXJTdG9yZSA9IHNoYWRlclN0b3JlO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/render/shader-store.ts\n");

/***/ }),

/***/ "./src/render/shader.ts":
/*!******************************!*\
  !*** ./src/render/shader.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.GLProgram = void 0;\nconst gl_api_1 = __webpack_require__(/*! ./gl-api */ \"./src/render/gl-api.ts\");\nclass GLProgram {\n    constructor(gl, vertShader, fragShader) {\n        this.program = (0, gl_api_1.createGLProgram)(gl, vertShader, fragShader);\n        this.uniformBuffer = new Map();\n        this.gl = gl;\n    }\n    useProgram() {\n        this.gl.useProgram(this.program);\n    }\n    setTextureUniform(location, texture) {\n        this.setUniform1i(location, texture);\n    }\n    setUniform1i(location, value) {\n        let cache = this.getCache(location);\n        this.gl.uniform1i(cache.location, value);\n    }\n    setUniform1f(location, value) {\n        let cache = this.getCache(location);\n        this.gl.uniform1f(cache.location, value);\n    }\n    setUniform1fv(location, x, y, z, w) {\n        let cache = this.getCache(location);\n        const value = new Float32Array(4);\n        value[0] = x;\n        value[1] = y;\n        value[2] = z;\n        value[3] = w;\n        this.gl.uniform4fv(cache.location, value);\n    }\n    setMatrix44(location, matrix) {\n        let cache = this.getCache(location);\n        this.gl.uniformMatrix4fv(cache.location, false, matrix);\n    }\n    getCache(location) {\n        let cache = this.uniformBuffer.get(location);\n        if (!cache) {\n            cache = {\n                location: this.gl.getUniformLocation(this.program, location),\n                value: undefined,\n            };\n        }\n        return cache;\n    }\n}\nexports.GLProgram = GLProgram;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3NoYWRlci50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxpQkFBaUI7QUFDakIsaUJBQWlCLG1CQUFPLENBQUMsd0NBQVU7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvc2hhZGVyLnRzPzBmNjAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkdMUHJvZ3JhbSA9IHZvaWQgMDtcbmNvbnN0IGdsX2FwaV8xID0gcmVxdWlyZShcIi4vZ2wtYXBpXCIpO1xuY2xhc3MgR0xQcm9ncmFtIHtcbiAgICBjb25zdHJ1Y3RvcihnbCwgdmVydFNoYWRlciwgZnJhZ1NoYWRlcikge1xuICAgICAgICB0aGlzLnByb2dyYW0gPSAoMCwgZ2xfYXBpXzEuY3JlYXRlR0xQcm9ncmFtKShnbCwgdmVydFNoYWRlciwgZnJhZ1NoYWRlcik7XG4gICAgICAgIHRoaXMudW5pZm9ybUJ1ZmZlciA9IG5ldyBNYXAoKTtcbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgIH1cbiAgICB1c2VQcm9ncmFtKCkge1xuICAgICAgICB0aGlzLmdsLnVzZVByb2dyYW0odGhpcy5wcm9ncmFtKTtcbiAgICB9XG4gICAgc2V0VGV4dHVyZVVuaWZvcm0obG9jYXRpb24sIHRleHR1cmUpIHtcbiAgICAgICAgdGhpcy5zZXRVbmlmb3JtMWkobG9jYXRpb24sIHRleHR1cmUpO1xuICAgIH1cbiAgICBzZXRVbmlmb3JtMWkobG9jYXRpb24sIHZhbHVlKSB7XG4gICAgICAgIGxldCBjYWNoZSA9IHRoaXMuZ2V0Q2FjaGUobG9jYXRpb24pO1xuICAgICAgICB0aGlzLmdsLnVuaWZvcm0xaShjYWNoZS5sb2NhdGlvbiwgdmFsdWUpO1xuICAgIH1cbiAgICBzZXRVbmlmb3JtMWYobG9jYXRpb24sIHZhbHVlKSB7XG4gICAgICAgIGxldCBjYWNoZSA9IHRoaXMuZ2V0Q2FjaGUobG9jYXRpb24pO1xuICAgICAgICB0aGlzLmdsLnVuaWZvcm0xZihjYWNoZS5sb2NhdGlvbiwgdmFsdWUpO1xuICAgIH1cbiAgICBzZXRVbmlmb3JtMWZ2KGxvY2F0aW9uLCB4LCB5LCB6LCB3KSB7XG4gICAgICAgIGxldCBjYWNoZSA9IHRoaXMuZ2V0Q2FjaGUobG9jYXRpb24pO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IG5ldyBGbG9hdDMyQXJyYXkoNCk7XG4gICAgICAgIHZhbHVlWzBdID0geDtcbiAgICAgICAgdmFsdWVbMV0gPSB5O1xuICAgICAgICB2YWx1ZVsyXSA9IHo7XG4gICAgICAgIHZhbHVlWzNdID0gdztcbiAgICAgICAgdGhpcy5nbC51bmlmb3JtNGZ2KGNhY2hlLmxvY2F0aW9uLCB2YWx1ZSk7XG4gICAgfVxuICAgIHNldE1hdHJpeDQ0KGxvY2F0aW9uLCBtYXRyaXgpIHtcbiAgICAgICAgbGV0IGNhY2hlID0gdGhpcy5nZXRDYWNoZShsb2NhdGlvbik7XG4gICAgICAgIHRoaXMuZ2wudW5pZm9ybU1hdHJpeDRmdihjYWNoZS5sb2NhdGlvbiwgZmFsc2UsIG1hdHJpeCk7XG4gICAgfVxuICAgIGdldENhY2hlKGxvY2F0aW9uKSB7XG4gICAgICAgIGxldCBjYWNoZSA9IHRoaXMudW5pZm9ybUJ1ZmZlci5nZXQobG9jYXRpb24pO1xuICAgICAgICBpZiAoIWNhY2hlKSB7XG4gICAgICAgICAgICBjYWNoZSA9IHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbjogdGhpcy5nbC5nZXRVbmlmb3JtTG9jYXRpb24odGhpcy5wcm9ncmFtLCBsb2NhdGlvbiksXG4gICAgICAgICAgICAgICAgdmFsdWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhY2hlO1xuICAgIH1cbn1cbmV4cG9ydHMuR0xQcm9ncmFtID0gR0xQcm9ncmFtO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/render/shader.ts\n");

/***/ }),

/***/ "./src/render/texture.ts":
/*!*******************************!*\
  !*** ./src/render/texture.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.GLTexture = exports.TextureUnit = exports.TextureType = exports.TextureFormat = exports.TextureFiltering = void 0;\nvar TextureFiltering;\n(function (TextureFiltering) {\n    TextureFiltering[TextureFiltering[\"NEAREST\"] = 0] = \"NEAREST\";\n    TextureFiltering[TextureFiltering[\"LINEAR\"] = 1] = \"LINEAR\";\n})(TextureFiltering = exports.TextureFiltering || (exports.TextureFiltering = {}));\nvar TextureFormat;\n(function (TextureFormat) {\n    TextureFormat[TextureFormat[\"RGB\"] = 0] = \"RGB\";\n    TextureFormat[TextureFormat[\"RGBA\"] = 1] = \"RGBA\";\n    TextureFormat[TextureFormat[\"RGBA8UI\"] = 2] = \"RGBA8UI\";\n    TextureFormat[TextureFormat[\"RGBA_INTEGER\"] = 3] = \"RGBA_INTEGER\";\n    TextureFormat[TextureFormat[\"R8\"] = 4] = \"R8\";\n    TextureFormat[TextureFormat[\"RED\"] = 5] = \"RED\";\n})(TextureFormat = exports.TextureFormat || (exports.TextureFormat = {}));\nvar TextureType;\n(function (TextureType) {\n    TextureType[TextureType[\"UNSIGNED_BYTE\"] = 0] = \"UNSIGNED_BYTE\";\n})(TextureType = exports.TextureType || (exports.TextureType = {}));\nvar TextureUnit;\n(function (TextureUnit) {\n    TextureUnit[TextureUnit[\"TEXTURE0\"] = 0] = \"TEXTURE0\";\n    TextureUnit[TextureUnit[\"TEXTURE1\"] = 1] = \"TEXTURE1\";\n    TextureUnit[TextureUnit[\"TEXTURE2\"] = 2] = \"TEXTURE2\";\n})(TextureUnit = exports.TextureUnit || (exports.TextureUnit = {}));\nfunction convertToGLTextureFiltering(gl, filering) {\n    switch (filering) {\n        case TextureFiltering.NEAREST: return gl.NEAREST;\n        case TextureFiltering.LINEAR: return gl.LINEAR;\n    }\n    return 0;\n}\nfunction convertToGLTextureFormat(gl, format) {\n    switch (format) {\n        case TextureFormat.R8: return gl.R8;\n        case TextureFormat.RED: return gl.RED;\n        case TextureFormat.RGB: return gl.RGB;\n        case TextureFormat.RGBA: return gl.RGBA;\n        case TextureFormat.RGBA8UI: return gl.RGBA8UI;\n        case TextureFormat.RGBA_INTEGER: return gl.RGBA_INTEGER;\n    }\n    return 0;\n}\nfunction convertToGLTextureType(gl, format) {\n    switch (format) {\n        case TextureType.UNSIGNED_BYTE: return gl.UNSIGNED_BYTE;\n    }\n    return 0;\n}\nfunction convertToGLTextureUnit(gl, index) {\n    return gl.TEXTURE0 + index;\n}\nconst DefaultFiltering = {\n    min: TextureFiltering.NEAREST,\n    mag: TextureFiltering.NEAREST,\n};\nconst DefaultImageFormat = {\n    internalFormat: TextureFormat.RGB,\n    format: TextureFormat.RGB,\n    type: TextureType.UNSIGNED_BYTE,\n};\nclass GLTexture {\n    constructor(gl, width, height, data, config = {}) {\n        this.gl = gl;\n        this.texture = gl.createTexture();\n        this.textureUnit = TextureUnit.TEXTURE0;\n        const filtering = { ...DefaultFiltering, ...config.filtering };\n        const imageFormat = { ...DefaultImageFormat, ...config.imageFormat };\n        this.config = { filtering, imageFormat };\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, convertToGLTextureFiltering(gl, filtering.min));\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, convertToGLTextureFiltering(gl, filtering.mag));\n        gl.texImage2D(gl.TEXTURE_2D, 0, convertToGLTextureFormat(gl, imageFormat.internalFormat), width, height, 0, convertToGLTextureFormat(gl, imageFormat.format), convertToGLTextureType(gl, imageFormat.type), data);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        this.width = width;\n        this.height = height;\n    }\n    bind(gl) {\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n    }\n    getTextureUnit() {\n        return this.textureUnit;\n    }\n    setTextureUnit(index) {\n        this.textureUnit = index;\n    }\n    setData(x, y, width, height, data) {\n        const imageFormat = this.config.imageFormat; // TODO: fix type\n        this.gl.texSubImage2D(this.gl.TEXTURE_2D, 0, x, y, width, height, convertToGLTextureFormat(this.gl, imageFormat.format), convertToGLTextureType(this.gl, imageFormat.type), data);\n    }\n    putData(x, y, width, height, data) {\n        const imageFormat = this.config.imageFormat; // TODO: fix type\n        this.gl.texSubImage2D(this.gl.TEXTURE_2D, 0, x, y, width, height, convertToGLTextureFormat(this.gl, imageFormat.format), convertToGLTextureType(this.gl, imageFormat.type), data);\n    }\n    getGLTexture() {\n        return this.texture;\n    }\n    getWidth() {\n        return this.width;\n    }\n    getHeight() {\n        return this.height;\n    }\n    activeTexture() {\n        this.gl.activeTexture(convertToGLTextureUnit(this.gl, this.textureUnit));\n    }\n}\nexports.GLTexture = GLTexture;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3RleHR1cmUudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsaUJBQWlCLEdBQUcsbUJBQW1CLEdBQUcsbUJBQW1CLEdBQUcscUJBQXFCLEdBQUcsd0JBQXdCO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrREFBa0Qsd0JBQXdCLEtBQUs7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNENBQTRDLHFCQUFxQixLQUFLO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLENBQUMsd0NBQXdDLG1CQUFtQixLQUFLO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHdDQUF3QyxtQkFBbUIsS0FBSztBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRDtBQUNwRDtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUIsOEJBQThCO0FBQzlCLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQ7QUFDQTtBQUNBO0FBQ0EscURBQXFEO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvdGV4dHVyZS50cz8xN2NlIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5HTFRleHR1cmUgPSBleHBvcnRzLlRleHR1cmVVbml0ID0gZXhwb3J0cy5UZXh0dXJlVHlwZSA9IGV4cG9ydHMuVGV4dHVyZUZvcm1hdCA9IGV4cG9ydHMuVGV4dHVyZUZpbHRlcmluZyA9IHZvaWQgMDtcbnZhciBUZXh0dXJlRmlsdGVyaW5nO1xuKGZ1bmN0aW9uIChUZXh0dXJlRmlsdGVyaW5nKSB7XG4gICAgVGV4dHVyZUZpbHRlcmluZ1tUZXh0dXJlRmlsdGVyaW5nW1wiTkVBUkVTVFwiXSA9IDBdID0gXCJORUFSRVNUXCI7XG4gICAgVGV4dHVyZUZpbHRlcmluZ1tUZXh0dXJlRmlsdGVyaW5nW1wiTElORUFSXCJdID0gMV0gPSBcIkxJTkVBUlwiO1xufSkoVGV4dHVyZUZpbHRlcmluZyA9IGV4cG9ydHMuVGV4dHVyZUZpbHRlcmluZyB8fCAoZXhwb3J0cy5UZXh0dXJlRmlsdGVyaW5nID0ge30pKTtcbnZhciBUZXh0dXJlRm9ybWF0O1xuKGZ1bmN0aW9uIChUZXh0dXJlRm9ybWF0KSB7XG4gICAgVGV4dHVyZUZvcm1hdFtUZXh0dXJlRm9ybWF0W1wiUkdCXCJdID0gMF0gPSBcIlJHQlwiO1xuICAgIFRleHR1cmVGb3JtYXRbVGV4dHVyZUZvcm1hdFtcIlJHQkFcIl0gPSAxXSA9IFwiUkdCQVwiO1xuICAgIFRleHR1cmVGb3JtYXRbVGV4dHVyZUZvcm1hdFtcIlJHQkE4VUlcIl0gPSAyXSA9IFwiUkdCQThVSVwiO1xuICAgIFRleHR1cmVGb3JtYXRbVGV4dHVyZUZvcm1hdFtcIlJHQkFfSU5URUdFUlwiXSA9IDNdID0gXCJSR0JBX0lOVEVHRVJcIjtcbiAgICBUZXh0dXJlRm9ybWF0W1RleHR1cmVGb3JtYXRbXCJSOFwiXSA9IDRdID0gXCJSOFwiO1xuICAgIFRleHR1cmVGb3JtYXRbVGV4dHVyZUZvcm1hdFtcIlJFRFwiXSA9IDVdID0gXCJSRURcIjtcbn0pKFRleHR1cmVGb3JtYXQgPSBleHBvcnRzLlRleHR1cmVGb3JtYXQgfHwgKGV4cG9ydHMuVGV4dHVyZUZvcm1hdCA9IHt9KSk7XG52YXIgVGV4dHVyZVR5cGU7XG4oZnVuY3Rpb24gKFRleHR1cmVUeXBlKSB7XG4gICAgVGV4dHVyZVR5cGVbVGV4dHVyZVR5cGVbXCJVTlNJR05FRF9CWVRFXCJdID0gMF0gPSBcIlVOU0lHTkVEX0JZVEVcIjtcbn0pKFRleHR1cmVUeXBlID0gZXhwb3J0cy5UZXh0dXJlVHlwZSB8fCAoZXhwb3J0cy5UZXh0dXJlVHlwZSA9IHt9KSk7XG52YXIgVGV4dHVyZVVuaXQ7XG4oZnVuY3Rpb24gKFRleHR1cmVVbml0KSB7XG4gICAgVGV4dHVyZVVuaXRbVGV4dHVyZVVuaXRbXCJURVhUVVJFMFwiXSA9IDBdID0gXCJURVhUVVJFMFwiO1xuICAgIFRleHR1cmVVbml0W1RleHR1cmVVbml0W1wiVEVYVFVSRTFcIl0gPSAxXSA9IFwiVEVYVFVSRTFcIjtcbiAgICBUZXh0dXJlVW5pdFtUZXh0dXJlVW5pdFtcIlRFWFRVUkUyXCJdID0gMl0gPSBcIlRFWFRVUkUyXCI7XG59KShUZXh0dXJlVW5pdCA9IGV4cG9ydHMuVGV4dHVyZVVuaXQgfHwgKGV4cG9ydHMuVGV4dHVyZVVuaXQgPSB7fSkpO1xuZnVuY3Rpb24gY29udmVydFRvR0xUZXh0dXJlRmlsdGVyaW5nKGdsLCBmaWxlcmluZykge1xuICAgIHN3aXRjaCAoZmlsZXJpbmcpIHtcbiAgICAgICAgY2FzZSBUZXh0dXJlRmlsdGVyaW5nLk5FQVJFU1Q6IHJldHVybiBnbC5ORUFSRVNUO1xuICAgICAgICBjYXNlIFRleHR1cmVGaWx0ZXJpbmcuTElORUFSOiByZXR1cm4gZ2wuTElORUFSO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRUb0dMVGV4dHVyZUZvcm1hdChnbCwgZm9ybWF0KSB7XG4gICAgc3dpdGNoIChmb3JtYXQpIHtcbiAgICAgICAgY2FzZSBUZXh0dXJlRm9ybWF0LlI4OiByZXR1cm4gZ2wuUjg7XG4gICAgICAgIGNhc2UgVGV4dHVyZUZvcm1hdC5SRUQ6IHJldHVybiBnbC5SRUQ7XG4gICAgICAgIGNhc2UgVGV4dHVyZUZvcm1hdC5SR0I6IHJldHVybiBnbC5SR0I7XG4gICAgICAgIGNhc2UgVGV4dHVyZUZvcm1hdC5SR0JBOiByZXR1cm4gZ2wuUkdCQTtcbiAgICAgICAgY2FzZSBUZXh0dXJlRm9ybWF0LlJHQkE4VUk6IHJldHVybiBnbC5SR0JBOFVJO1xuICAgICAgICBjYXNlIFRleHR1cmVGb3JtYXQuUkdCQV9JTlRFR0VSOiByZXR1cm4gZ2wuUkdCQV9JTlRFR0VSO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRUb0dMVGV4dHVyZVR5cGUoZ2wsIGZvcm1hdCkge1xuICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICAgIGNhc2UgVGV4dHVyZVR5cGUuVU5TSUdORURfQllURTogcmV0dXJuIGdsLlVOU0lHTkVEX0JZVEU7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZnVuY3Rpb24gY29udmVydFRvR0xUZXh0dXJlVW5pdChnbCwgaW5kZXgpIHtcbiAgICByZXR1cm4gZ2wuVEVYVFVSRTAgKyBpbmRleDtcbn1cbmNvbnN0IERlZmF1bHRGaWx0ZXJpbmcgPSB7XG4gICAgbWluOiBUZXh0dXJlRmlsdGVyaW5nLk5FQVJFU1QsXG4gICAgbWFnOiBUZXh0dXJlRmlsdGVyaW5nLk5FQVJFU1QsXG59O1xuY29uc3QgRGVmYXVsdEltYWdlRm9ybWF0ID0ge1xuICAgIGludGVybmFsRm9ybWF0OiBUZXh0dXJlRm9ybWF0LlJHQixcbiAgICBmb3JtYXQ6IFRleHR1cmVGb3JtYXQuUkdCLFxuICAgIHR5cGU6IFRleHR1cmVUeXBlLlVOU0lHTkVEX0JZVEUsXG59O1xuY2xhc3MgR0xUZXh0dXJlIHtcbiAgICBjb25zdHJ1Y3RvcihnbCwgd2lkdGgsIGhlaWdodCwgZGF0YSwgY29uZmlnID0ge30pIHtcbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgICAgICB0aGlzLnRleHR1cmUgPSBnbC5jcmVhdGVUZXh0dXJlKCk7XG4gICAgICAgIHRoaXMudGV4dHVyZVVuaXQgPSBUZXh0dXJlVW5pdC5URVhUVVJFMDtcbiAgICAgICAgY29uc3QgZmlsdGVyaW5nID0geyAuLi5EZWZhdWx0RmlsdGVyaW5nLCAuLi5jb25maWcuZmlsdGVyaW5nIH07XG4gICAgICAgIGNvbnN0IGltYWdlRm9ybWF0ID0geyAuLi5EZWZhdWx0SW1hZ2VGb3JtYXQsIC4uLmNvbmZpZy5pbWFnZUZvcm1hdCB9O1xuICAgICAgICB0aGlzLmNvbmZpZyA9IHsgZmlsdGVyaW5nLCBpbWFnZUZvcm1hdCB9O1xuICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCB0aGlzLnRleHR1cmUpO1xuICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgY29udmVydFRvR0xUZXh0dXJlRmlsdGVyaW5nKGdsLCBmaWx0ZXJpbmcubWluKSk7XG4gICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBjb252ZXJ0VG9HTFRleHR1cmVGaWx0ZXJpbmcoZ2wsIGZpbHRlcmluZy5tYWcpKTtcbiAgICAgICAgZ2wudGV4SW1hZ2UyRChnbC5URVhUVVJFXzJELCAwLCBjb252ZXJ0VG9HTFRleHR1cmVGb3JtYXQoZ2wsIGltYWdlRm9ybWF0LmludGVybmFsRm9ybWF0KSwgd2lkdGgsIGhlaWdodCwgMCwgY29udmVydFRvR0xUZXh0dXJlRm9ybWF0KGdsLCBpbWFnZUZvcm1hdC5mb3JtYXQpLCBjb252ZXJ0VG9HTFRleHR1cmVUeXBlKGdsLCBpbWFnZUZvcm1hdC50eXBlKSwgZGF0YSk7XG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIG51bGwpO1xuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgIH1cbiAgICBiaW5kKGdsKSB7XG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIHRoaXMudGV4dHVyZSk7XG4gICAgfVxuICAgIGdldFRleHR1cmVVbml0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0dXJlVW5pdDtcbiAgICB9XG4gICAgc2V0VGV4dHVyZVVuaXQoaW5kZXgpIHtcbiAgICAgICAgdGhpcy50ZXh0dXJlVW5pdCA9IGluZGV4O1xuICAgIH1cbiAgICBzZXREYXRhKHgsIHksIHdpZHRoLCBoZWlnaHQsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgaW1hZ2VGb3JtYXQgPSB0aGlzLmNvbmZpZy5pbWFnZUZvcm1hdDsgLy8gVE9ETzogZml4IHR5cGVcbiAgICAgICAgdGhpcy5nbC50ZXhTdWJJbWFnZTJEKHRoaXMuZ2wuVEVYVFVSRV8yRCwgMCwgeCwgeSwgd2lkdGgsIGhlaWdodCwgY29udmVydFRvR0xUZXh0dXJlRm9ybWF0KHRoaXMuZ2wsIGltYWdlRm9ybWF0LmZvcm1hdCksIGNvbnZlcnRUb0dMVGV4dHVyZVR5cGUodGhpcy5nbCwgaW1hZ2VGb3JtYXQudHlwZSksIGRhdGEpO1xuICAgIH1cbiAgICBwdXREYXRhKHgsIHksIHdpZHRoLCBoZWlnaHQsIGRhdGEpIHtcbiAgICAgICAgY29uc3QgaW1hZ2VGb3JtYXQgPSB0aGlzLmNvbmZpZy5pbWFnZUZvcm1hdDsgLy8gVE9ETzogZml4IHR5cGVcbiAgICAgICAgdGhpcy5nbC50ZXhTdWJJbWFnZTJEKHRoaXMuZ2wuVEVYVFVSRV8yRCwgMCwgeCwgeSwgd2lkdGgsIGhlaWdodCwgY29udmVydFRvR0xUZXh0dXJlRm9ybWF0KHRoaXMuZ2wsIGltYWdlRm9ybWF0LmZvcm1hdCksIGNvbnZlcnRUb0dMVGV4dHVyZVR5cGUodGhpcy5nbCwgaW1hZ2VGb3JtYXQudHlwZSksIGRhdGEpO1xuICAgIH1cbiAgICBnZXRHTFRleHR1cmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHR1cmU7XG4gICAgfVxuICAgIGdldFdpZHRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy53aWR0aDtcbiAgICB9XG4gICAgZ2V0SGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7XG4gICAgfVxuICAgIGFjdGl2ZVRleHR1cmUoKSB7XG4gICAgICAgIHRoaXMuZ2wuYWN0aXZlVGV4dHVyZShjb252ZXJ0VG9HTFRleHR1cmVVbml0KHRoaXMuZ2wsIHRoaXMudGV4dHVyZVVuaXQpKTtcbiAgICB9XG59XG5leHBvcnRzLkdMVGV4dHVyZSA9IEdMVGV4dHVyZTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/texture.ts\n");

/***/ }),

/***/ "./src/render/vbo.ts":
/*!***************************!*\
  !*** ./src/render/vbo.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.GLVBO = exports.convertToSize = exports.convertToGLAttribType = exports.AttribType = void 0;\nvar AttribType;\n(function (AttribType) {\n    AttribType[AttribType[\"FLOAT\"] = 0] = \"FLOAT\";\n})(AttribType = exports.AttribType || (exports.AttribType = {}));\nfunction convertToGLAttribType(gl, type) {\n    switch (type) {\n        case AttribType.FLOAT: return gl.FLOAT;\n    }\n    return 0;\n}\nexports.convertToGLAttribType = convertToGLAttribType;\nfunction convertToSize(gl, type) {\n    switch (type) {\n        case gl.FLOAT:\n        case AttribType.FLOAT: return Float32Array.BYTES_PER_ELEMENT;\n    }\n    return 0;\n}\nexports.convertToSize = convertToSize;\nclass GLVBO {\n    constructor(gl, layout) {\n        this.gl = gl;\n        this.vbo = gl.createBuffer();\n        let offset = 0;\n        this.layout = layout.map((v) => {\n            const currentOffset = offset;\n            offset += convertToSize(gl, v.type) * v.componentsCount;\n            return ({\n                type: convertToGLAttribType(gl, v.type),\n                componentsCount: v.componentsCount,\n                offset: currentOffset,\n            });\n        });\n        this.stride = 0;\n        if (layout.length) {\n            const layoutItem = this.layout[layout.length - 1];\n            this.stride = layoutItem.offset + convertToSize(gl, layoutItem.type) * layoutItem.componentsCount;\n        }\n    }\n    bind() {\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vbo);\n    }\n    activateAttribPointer(index) {\n        if (index >= 0 && index < this.layout.length) {\n            this.setAttribPointer(index);\n            this.gl.enableVertexAttribArray(index);\n        }\n    }\n    activateAllAttribPointers() {\n        this.setAllAttribPointers();\n        for (let i = 0; i < this.layout.length; i++) {\n            this.gl.enableVertexAttribArray(i);\n        }\n    }\n    setData(data) {\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, data, this.gl.STATIC_DRAW);\n    }\n    setAttribPointer(index) {\n        if (index >= 0 && index < this.layout.length) {\n            const layoutItem = this.layout[index];\n            this.gl.vertexAttribPointer(index, layoutItem.componentsCount, layoutItem.type, false, this.stride, layoutItem.offset);\n        }\n    }\n    setAllAttribPointers() {\n        for (let i = 0; i < this.layout.length; i++) {\n            const layoutItem = this.layout[i];\n            this.gl.vertexAttribPointer(i, layoutItem.componentsCount, layoutItem.type, false, this.stride, layoutItem.offset);\n        }\n    }\n}\nexports.GLVBO = GLVBO;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3Ziby50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxhQUFhLEdBQUcscUJBQXFCLEdBQUcsNkJBQTZCLEdBQUcsa0JBQWtCO0FBQzFGO0FBQ0E7QUFDQTtBQUNBLENBQUMsc0NBQXNDLGtCQUFrQixLQUFLO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isd0JBQXdCO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHdCQUF3QjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvdmJvLnRzPzk2YmEiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkdMVkJPID0gZXhwb3J0cy5jb252ZXJ0VG9TaXplID0gZXhwb3J0cy5jb252ZXJ0VG9HTEF0dHJpYlR5cGUgPSBleHBvcnRzLkF0dHJpYlR5cGUgPSB2b2lkIDA7XG52YXIgQXR0cmliVHlwZTtcbihmdW5jdGlvbiAoQXR0cmliVHlwZSkge1xuICAgIEF0dHJpYlR5cGVbQXR0cmliVHlwZVtcIkZMT0FUXCJdID0gMF0gPSBcIkZMT0FUXCI7XG59KShBdHRyaWJUeXBlID0gZXhwb3J0cy5BdHRyaWJUeXBlIHx8IChleHBvcnRzLkF0dHJpYlR5cGUgPSB7fSkpO1xuZnVuY3Rpb24gY29udmVydFRvR0xBdHRyaWJUeXBlKGdsLCB0eXBlKSB7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgQXR0cmliVHlwZS5GTE9BVDogcmV0dXJuIGdsLkZMT0FUO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbn1cbmV4cG9ydHMuY29udmVydFRvR0xBdHRyaWJUeXBlID0gY29udmVydFRvR0xBdHRyaWJUeXBlO1xuZnVuY3Rpb24gY29udmVydFRvU2l6ZShnbCwgdHlwZSkge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIGdsLkZMT0FUOlxuICAgICAgICBjYXNlIEF0dHJpYlR5cGUuRkxPQVQ6IHJldHVybiBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQ7XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZXhwb3J0cy5jb252ZXJ0VG9TaXplID0gY29udmVydFRvU2l6ZTtcbmNsYXNzIEdMVkJPIHtcbiAgICBjb25zdHJ1Y3RvcihnbCwgbGF5b3V0KSB7XG4gICAgICAgIHRoaXMuZ2wgPSBnbDtcbiAgICAgICAgdGhpcy52Ym8gPSBnbC5jcmVhdGVCdWZmZXIoKTtcbiAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgIHRoaXMubGF5b3V0ID0gbGF5b3V0Lm1hcCgodikgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudE9mZnNldCA9IG9mZnNldDtcbiAgICAgICAgICAgIG9mZnNldCArPSBjb252ZXJ0VG9TaXplKGdsLCB2LnR5cGUpICogdi5jb21wb25lbnRzQ291bnQ7XG4gICAgICAgICAgICByZXR1cm4gKHtcbiAgICAgICAgICAgICAgICB0eXBlOiBjb252ZXJ0VG9HTEF0dHJpYlR5cGUoZ2wsIHYudHlwZSksXG4gICAgICAgICAgICAgICAgY29tcG9uZW50c0NvdW50OiB2LmNvbXBvbmVudHNDb3VudCxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IGN1cnJlbnRPZmZzZXQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc3RyaWRlID0gMDtcbiAgICAgICAgaWYgKGxheW91dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxheW91dEl0ZW0gPSB0aGlzLmxheW91dFtsYXlvdXQubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB0aGlzLnN0cmlkZSA9IGxheW91dEl0ZW0ub2Zmc2V0ICsgY29udmVydFRvU2l6ZShnbCwgbGF5b3V0SXRlbS50eXBlKSAqIGxheW91dEl0ZW0uY29tcG9uZW50c0NvdW50O1xuICAgICAgICB9XG4gICAgfVxuICAgIGJpbmQoKSB7XG4gICAgICAgIHRoaXMuZ2wuYmluZEJ1ZmZlcih0aGlzLmdsLkFSUkFZX0JVRkZFUiwgdGhpcy52Ym8pO1xuICAgIH1cbiAgICBhY3RpdmF0ZUF0dHJpYlBvaW50ZXIoaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmxheW91dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QXR0cmliUG9pbnRlcihpbmRleCk7XG4gICAgICAgICAgICB0aGlzLmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KGluZGV4KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhY3RpdmF0ZUFsbEF0dHJpYlBvaW50ZXJzKCkge1xuICAgICAgICB0aGlzLnNldEFsbEF0dHJpYlBvaW50ZXJzKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5sYXlvdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoaSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2V0RGF0YShkYXRhKSB7XG4gICAgICAgIHRoaXMuZ2wuYnVmZmVyRGF0YSh0aGlzLmdsLkFSUkFZX0JVRkZFUiwgZGF0YSwgdGhpcy5nbC5TVEFUSUNfRFJBVyk7XG4gICAgfVxuICAgIHNldEF0dHJpYlBvaW50ZXIoaW5kZXgpIHtcbiAgICAgICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLmxheW91dC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGxheW91dEl0ZW0gPSB0aGlzLmxheW91dFtpbmRleF07XG4gICAgICAgICAgICB0aGlzLmdsLnZlcnRleEF0dHJpYlBvaW50ZXIoaW5kZXgsIGxheW91dEl0ZW0uY29tcG9uZW50c0NvdW50LCBsYXlvdXRJdGVtLnR5cGUsIGZhbHNlLCB0aGlzLnN0cmlkZSwgbGF5b3V0SXRlbS5vZmZzZXQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldEFsbEF0dHJpYlBvaW50ZXJzKCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubGF5b3V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsYXlvdXRJdGVtID0gdGhpcy5sYXlvdXRbaV07XG4gICAgICAgICAgICB0aGlzLmdsLnZlcnRleEF0dHJpYlBvaW50ZXIoaSwgbGF5b3V0SXRlbS5jb21wb25lbnRzQ291bnQsIGxheW91dEl0ZW0udHlwZSwgZmFsc2UsIHRoaXMuc3RyaWRlLCBsYXlvdXRJdGVtLm9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLkdMVkJPID0gR0xWQk87XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/render/vbo.ts\n");

/***/ }),

/***/ "./src/utils/array.ts":
/*!****************************!*\
  !*** ./src/utils/array.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.binaryFind = void 0;\nfunction binaryFind(arr, start, end, compare) {\n    let i = start;\n    let j = Math.min(end, arr.length);\n    let mid = 0;\n    for (; j - i > 0;) {\n        mid = (i + j) >>> 1;\n        let compareValue = compare(arr[mid]);\n        if (compareValue === 0)\n            return mid;\n        if (compareValue < 0) {\n            j = mid;\n        }\n        else {\n            i = mid;\n        }\n    }\n    return;\n}\nexports.binaryFind = binaryFind;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvYXJyYXkudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxVQUFVO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3V0aWxzL2FycmF5LnRzP2IxMzAiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmJpbmFyeUZpbmQgPSB2b2lkIDA7XG5mdW5jdGlvbiBiaW5hcnlGaW5kKGFyciwgc3RhcnQsIGVuZCwgY29tcGFyZSkge1xuICAgIGxldCBpID0gc3RhcnQ7XG4gICAgbGV0IGogPSBNYXRoLm1pbihlbmQsIGFyci5sZW5ndGgpO1xuICAgIGxldCBtaWQgPSAwO1xuICAgIGZvciAoOyBqIC0gaSA+IDA7KSB7XG4gICAgICAgIG1pZCA9IChpICsgaikgPj4+IDE7XG4gICAgICAgIGxldCBjb21wYXJlVmFsdWUgPSBjb21wYXJlKGFyclttaWRdKTtcbiAgICAgICAgaWYgKGNvbXBhcmVWYWx1ZSA9PT0gMClcbiAgICAgICAgICAgIHJldHVybiBtaWQ7XG4gICAgICAgIGlmIChjb21wYXJlVmFsdWUgPCAwKSB7XG4gICAgICAgICAgICBqID0gbWlkO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaSA9IG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm47XG59XG5leHBvcnRzLmJpbmFyeUZpbmQgPSBiaW5hcnlGaW5kO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/array.ts\n");

/***/ }),

/***/ "./src/utils/memory.ts":
/*!*****************************!*\
  !*** ./src/utils/memory.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.interpretAsInt32 = void 0;\nfunction interpretAsInt32(a, b, c, d) {\n    return (a) | (b << 8) | (c << 16) | (d << 24);\n}\nexports.interpretAsInt32 = interpretAsInt32;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvbWVtb3J5LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvdXRpbHMvbWVtb3J5LnRzP2RlZWMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmludGVycHJldEFzSW50MzIgPSB2b2lkIDA7XG5mdW5jdGlvbiBpbnRlcnByZXRBc0ludDMyKGEsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gKGEpIHwgKGIgPDwgOCkgfCAoYyA8PCAxNikgfCAoZCA8PCAyNCk7XG59XG5leHBvcnRzLmludGVycHJldEFzSW50MzIgPSBpbnRlcnByZXRBc0ludDMyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/memory.ts\n");

/***/ }),

/***/ "./src/utils/uniqeId.ts":
/*!******************************!*\
  !*** ./src/utils/uniqeId.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createUniqeIdGenerator = void 0;\nfunction createUniqeIdGenerator(start = 0) {\n    return () => start++;\n}\nexports.createUniqeIdGenerator = createUniqeIdGenerator;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvdW5pcWVJZC50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsOEJBQThCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3V0aWxzL3VuaXFlSWQudHM/OWE0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY3JlYXRlVW5pcWVJZEdlbmVyYXRvciA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWF0ZVVuaXFlSWRHZW5lcmF0b3Ioc3RhcnQgPSAwKSB7XG4gICAgcmV0dXJuICgpID0+IHN0YXJ0Kys7XG59XG5leHBvcnRzLmNyZWF0ZVVuaXFlSWRHZW5lcmF0b3IgPSBjcmVhdGVVbmlxZUlkR2VuZXJhdG9yO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/uniqeId.ts\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/main.ts");
/******/ 	
/******/ })()
;