/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/assets/circle-pixel.glsl":
/*!**************************************!*\
  !*** ./src/assets/circle-pixel.glsl ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nin vec2 textureCoord;\\nin float vertexId;\\n\\nlayout(location = 0) out vec4 fragColor;\\nlayout(location = 1) out uvec4 fragId;\\n\\nvoid main()\\n{\\n  vec2 textureCoordOffset = vec2(textureCoord) * 2.0;\\n  textureCoordOffset.x -= 1.0;\\n  textureCoordOffset.y -= 1.0;\\n\\n  float squareDist = 1.0 - length(textureCoordOffset);\\n\\n  // TODO: why is not bleended\\n  // float smoothes = smoothstep(0.0, 0.005, squareDist);\\n  float smoothes = 1.0;\\n  float coef = step(0.0, squareDist) * smoothes;\\n\\n  if (coef == 0.0) {\\n    discard;\\n  }\\n\\n  fragColor = vec4(1.0, 1.0, 1.0, coef);\\n\\n  uint id = uint(vertexId);\\n  fragId = uvec4(id & uint(255), (id >> uint(8)) & uint(255), (id >> uint(16)) & uint(255), (id >> uint(24)) & uint(255));\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2NpcmNsZS1waXhlbC5nbHNsLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpRUFBZSw0Q0FBNEMseUJBQXlCLG9CQUFvQiw0Q0FBNEMsd0NBQXdDLGtCQUFrQix1REFBdUQsZ0NBQWdDLGdDQUFnQywwREFBMEQsNkZBQTZGLHlCQUF5QixrREFBa0Qsd0JBQXdCLGNBQWMsS0FBSyw0Q0FBNEMsK0JBQStCLDRIQUE0SCxHQUFHLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvYXNzZXRzL2NpcmNsZS1waXhlbC5nbHNsP2JlZjYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgXCIjdmVyc2lvbiAzMDAgZXNcXG5cXG5wcmVjaXNpb24gbWVkaXVtcCBmbG9hdDtcXG5cXG5pbiB2ZWMyIHRleHR1cmVDb29yZDtcXG5pbiBmbG9hdCB2ZXJ0ZXhJZDtcXG5cXG5sYXlvdXQobG9jYXRpb24gPSAwKSBvdXQgdmVjNCBmcmFnQ29sb3I7XFxubGF5b3V0KGxvY2F0aW9uID0gMSkgb3V0IHV2ZWM0IGZyYWdJZDtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gIHZlYzIgdGV4dHVyZUNvb3JkT2Zmc2V0ID0gdmVjMih0ZXh0dXJlQ29vcmQpICogMi4wO1xcbiAgdGV4dHVyZUNvb3JkT2Zmc2V0LnggLT0gMS4wO1xcbiAgdGV4dHVyZUNvb3JkT2Zmc2V0LnkgLT0gMS4wO1xcblxcbiAgZmxvYXQgc3F1YXJlRGlzdCA9IDEuMCAtIGxlbmd0aCh0ZXh0dXJlQ29vcmRPZmZzZXQpO1xcblxcbiAgLy8gVE9ETzogd2h5IGlzIG5vdCBibGVlbmRlZFxcbiAgLy8gZmxvYXQgc21vb3RoZXMgPSBzbW9vdGhzdGVwKDAuMCwgMC4wMDUsIHNxdWFyZURpc3QpO1xcbiAgZmxvYXQgc21vb3RoZXMgPSAxLjA7XFxuICBmbG9hdCBjb2VmID0gc3RlcCgwLjAsIHNxdWFyZURpc3QpICogc21vb3RoZXM7XFxuXFxuICBpZiAoY29lZiA9PSAwLjApIHtcXG4gICAgZGlzY2FyZDtcXG4gIH1cXG5cXG4gIGZyYWdDb2xvciA9IHZlYzQoMS4wLCAxLjAsIDEuMCwgY29lZik7XFxuXFxuICB1aW50IGlkID0gdWludCh2ZXJ0ZXhJZCk7XFxuICBmcmFnSWQgPSB1dmVjNChpZCAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoOCkpICYgdWludCgyNTUpLCAoaWQgPj4gdWludCgxNikpICYgdWludCgyNTUpLCAoaWQgPj4gdWludCgyNCkpICYgdWludCgyNTUpKTtcXG59XFxuXCI7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/assets/circle-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/circle-vertex.glsl":
/*!***************************************!*\
  !*** ./src/assets/circle-vertex.glsl ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nuniform mat4x4 P;\\nuniform mat4x4 MV;\\nuniform mat4x4 MM;\\n\\nlayout(location = 0) in vec3 vPosition;\\nlayout(location = 1) in vec2 vTextureCoord;\\nlayout(location = 2) in float vVertexId;\\n\\nout vec2 textureCoord;\\nout float vertexId;\\n\\nvoid main()\\n{\\n  gl_Position = P * inverse(MV) * MM * vec4(vPosition, 1.0);\\n\\n  textureCoord = vTextureCoord;\\n  vertexId = vVertexId;\\n\\n  // radius = vRadius;\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2NpcmNsZS12ZXJ0ZXguZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUscUNBQXFDLG9CQUFvQixvQkFBb0IsMkNBQTJDLDZDQUE2QywwQ0FBMEMsMEJBQTBCLHFCQUFxQixrQkFBa0IsOERBQThELG1DQUFtQyx5QkFBeUIsMEJBQTBCLEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9hc3NldHMvY2lyY2xlLXZlcnRleC5nbHNsPzVmZDMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgXCIjdmVyc2lvbiAzMDAgZXNcXG5cXG51bmlmb3JtIG1hdDR4NCBQO1xcbnVuaWZvcm0gbWF0NHg0IE1WO1xcbnVuaWZvcm0gbWF0NHg0IE1NO1xcblxcbmxheW91dChsb2NhdGlvbiA9IDApIGluIHZlYzMgdlBvc2l0aW9uO1xcbmxheW91dChsb2NhdGlvbiA9IDEpIGluIHZlYzIgdlRleHR1cmVDb29yZDtcXG5sYXlvdXQobG9jYXRpb24gPSAyKSBpbiBmbG9hdCB2VmVydGV4SWQ7XFxuXFxub3V0IHZlYzIgdGV4dHVyZUNvb3JkO1xcbm91dCBmbG9hdCB2ZXJ0ZXhJZDtcXG5cXG52b2lkIG1haW4oKVxcbntcXG4gIGdsX1Bvc2l0aW9uID0gUCAqIGludmVyc2UoTVYpICogTU0gKiB2ZWM0KHZQb3NpdGlvbiwgMS4wKTtcXG5cXG4gIHRleHR1cmVDb29yZCA9IHZUZXh0dXJlQ29vcmQ7XFxuICB2ZXJ0ZXhJZCA9IHZWZXJ0ZXhJZDtcXG5cXG4gIC8vIHJhZGl1cyA9IHZSYWRpdXM7XFxufVxcblwiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/assets/circle-vertex.glsl\n");

/***/ }),

/***/ "./src/assets/line-pixel.glsl":
/*!************************************!*\
  !*** ./src/assets/line-pixel.glsl ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nin float vertexId;\\n\\nlayout(location = 0) out vec4 fragColor;\\nlayout(location = 1) out uvec4 fragId;\\n\\nvoid main()\\n{\\n  fragColor = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n  uint id = uint(vertexId);\\n  fragId = uvec4(id & uint(255), (id >> uint(8)) & uint(255), (id >> uint(16)) & uint(255), (id >> uint(24)) & uint(255));\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2xpbmUtcGl4ZWwuZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsNENBQTRDLHNCQUFzQiw0Q0FBNEMsd0NBQXdDLGtCQUFrQix5Q0FBeUMsK0JBQStCLDRIQUE0SCxHQUFHLEdBQUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvYXNzZXRzL2xpbmUtcGl4ZWwuZ2xzbD8zMmZhIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxuXFxuaW4gZmxvYXQgdmVydGV4SWQ7XFxuXFxubGF5b3V0KGxvY2F0aW9uID0gMCkgb3V0IHZlYzQgZnJhZ0NvbG9yO1xcbmxheW91dChsb2NhdGlvbiA9IDEpIG91dCB1dmVjNCBmcmFnSWQ7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBmcmFnQ29sb3IgPSB2ZWM0KDEuMCwgMS4wLCAxLjAsIDEuMCk7XFxuXFxuICB1aW50IGlkID0gdWludCh2ZXJ0ZXhJZCk7XFxuICBmcmFnSWQgPSB1dmVjNChpZCAmIHVpbnQoMjU1KSwgKGlkID4+IHVpbnQoOCkpICYgdWludCgyNTUpLCAoaWQgPj4gdWludCgxNikpICYgdWludCgyNTUpLCAoaWQgPj4gdWludCgyNCkpICYgdWludCgyNTUpKTtcXG59XFxuXCI7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/assets/line-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/line-vertex.glsl":
/*!*************************************!*\
  !*** ./src/assets/line-vertex.glsl ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nuniform mat4x4 P;\\nuniform mat4x4 MV;\\nuniform mat4x4 MM;\\n\\nlayout(location = 0) in vec3 vPosition;\\nlayout(location = 1) in float vVertexId;\\n\\nout float vertexId;\\n\\nvoid main()\\n{\\n  gl_Position = P * inverse(MV) * MM * vec4(vPosition, 1.0);\\n  vertexId = vVertexId;\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL2xpbmUtdmVydGV4Lmdsc2wuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLHFDQUFxQyxvQkFBb0Isb0JBQW9CLDJDQUEyQywwQ0FBMEMsdUJBQXVCLGtCQUFrQiw4REFBOEQseUJBQXlCLEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9hc3NldHMvbGluZS12ZXJ0ZXguZ2xzbD9hM2E2Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxudW5pZm9ybSBtYXQ0eDQgUDtcXG51bmlmb3JtIG1hdDR4NCBNVjtcXG51bmlmb3JtIG1hdDR4NCBNTTtcXG5cXG5sYXlvdXQobG9jYXRpb24gPSAwKSBpbiB2ZWMzIHZQb3NpdGlvbjtcXG5sYXlvdXQobG9jYXRpb24gPSAxKSBpbiBmbG9hdCB2VmVydGV4SWQ7XFxuXFxub3V0IGZsb2F0IHZlcnRleElkO1xcblxcbnZvaWQgbWFpbigpXFxue1xcbiAgZ2xfUG9zaXRpb24gPSBQICogaW52ZXJzZShNVikgKiBNTSAqIHZlYzQodlBvc2l0aW9uLCAxLjApO1xcbiAgdmVydGV4SWQgPSB2VmVydGV4SWQ7XFxufVxcblwiOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/assets/line-vertex.glsl\n");

/***/ }),

/***/ "./src/assets/texture-pixel.glsl":
/*!***************************************!*\
  !*** ./src/assets/texture-pixel.glsl ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nprecision mediump float;\\n\\nuniform sampler2D outTexture;\\n\\nin vec2 texCoord;\\n\\nout vec4 fragColor;\\n\\nvoid main()\\n{\\n  fragColor = texture(outTexture, texCoord);\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL3RleHR1cmUtcGl4ZWwuZ2xzbC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaUVBQWUsNENBQTRDLGlDQUFpQyxxQkFBcUIsdUJBQXVCLGtCQUFrQiw4Q0FBOEMsR0FBRyxHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL2Fzc2V0cy90ZXh0dXJlLXBpeGVsLmdsc2w/ZDM4ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBcIiN2ZXJzaW9uIDMwMCBlc1xcblxcbnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0O1xcblxcbnVuaWZvcm0gc2FtcGxlcjJEIG91dFRleHR1cmU7XFxuXFxuaW4gdmVjMiB0ZXhDb29yZDtcXG5cXG5vdXQgdmVjNCBmcmFnQ29sb3I7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBmcmFnQ29sb3IgPSB0ZXh0dXJlKG91dFRleHR1cmUsIHRleENvb3JkKTtcXG59XFxuXCI7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/assets/texture-pixel.glsl\n");

/***/ }),

/***/ "./src/assets/texture-vertex.glsl":
/*!****************************************!*\
  !*** ./src/assets/texture-vertex.glsl ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (\"#version 300 es\\n\\nlayout(location = 0) in vec4 vPosition;\\nlayout(location = 1) in vec2 aTexCoord;\\n\\nout vec2 texCoord;\\n\\nvoid main()\\n{\\n  gl_Position = vPosition;\\n  texCoord = vec2(aTexCoord.x, 1.0 - aTexCoord.y);\\n}\\n\");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvYXNzZXRzL3RleHR1cmUtdmVydGV4Lmdsc2wuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLDJEQUEyRCx5Q0FBeUMsc0JBQXNCLGtCQUFrQiw0QkFBNEIsb0RBQW9ELEdBQUcsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9hc3NldHMvdGV4dHVyZS12ZXJ0ZXguZ2xzbD85MDYzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IFwiI3ZlcnNpb24gMzAwIGVzXFxuXFxubGF5b3V0KGxvY2F0aW9uID0gMCkgaW4gdmVjNCB2UG9zaXRpb247XFxubGF5b3V0KGxvY2F0aW9uID0gMSkgaW4gdmVjMiBhVGV4Q29vcmQ7XFxuXFxub3V0IHZlYzIgdGV4Q29vcmQ7XFxuXFxudm9pZCBtYWluKClcXG57XFxuICBnbF9Qb3NpdGlvbiA9IHZQb3NpdGlvbjtcXG4gIHRleENvb3JkID0gdmVjMihhVGV4Q29vcmQueCwgMS4wIC0gYVRleENvb3JkLnkpO1xcbn1cXG5cIjsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/assets/texture-vertex.glsl\n");

/***/ }),

/***/ "./src/event/canvas-event.ts":
/*!***********************************!*\
  !*** ./src/event/canvas-event.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.bindEvents = void 0;\nconst screen_1 = __webpack_require__(/*! ../math/screen */ \"./src/math/screen.ts\");\nconst vec_1 = __webpack_require__(/*! ../math/vec */ \"./src/math/vec.ts\");\n// Aircraft_principal_axes\nfunction bindEvents(canvas, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect, mousePosition) {\n    const eventStack = [];\n    const keyboard = new Uint8Array(128);\n    canvas.addEventListener('keydown', (e) => {\n        if (e.key.charCodeAt(0) < 128) {\n            keyboard[e.key.charCodeAt(0)] = 1;\n        }\n        eventStack.push({\n            type: 'keydown',\n            keyCode: e.key.charCodeAt(0),\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('keyup', (e) => {\n        if (e.key.charCodeAt(0) < 128) {\n            keyboard[e.key.charCodeAt(0)] = 0;\n        }\n        eventStack.push({\n            type: 'keyup',\n            keyCode: e.key.charCodeAt(0),\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('keypress', (e) => {\n        eventStack.push({\n            type: 'keypress',\n            keyCode: -1,\n            key: e.key,\n        });\n    });\n    canvas.addEventListener('mousedown', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        eventStack.push({\n            type: 'mousedown',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    canvas.addEventListener('mousemove', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        mousePosition.x = e.offsetX;\n        mousePosition.y = e.offsetY;\n        eventStack.push({\n            type: 'mousemove',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    canvas.addEventListener('mouseup', (e) => {\n        const coord = (0, vec_1.createVec2)(e.offsetX, e.offsetY);\n        (0, screen_1.convertScreenCoordToWorldCoord)(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect);\n        eventStack.push({\n            type: 'mouseup',\n            x: coord.x,\n            y: coord.y,\n        });\n    });\n    return { eventStack, keyboard };\n}\nexports.bindEvents = bindEvents;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXZlbnQvY2FudmFzLWV2ZW50LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGtCQUFrQjtBQUNsQixpQkFBaUIsbUJBQU8sQ0FBQyw0Q0FBZ0I7QUFDekMsY0FBYyxtQkFBTyxDQUFDLHNDQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsS0FBSztBQUNMLGFBQWE7QUFDYjtBQUNBLGtCQUFrQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9ldmVudC9jYW52YXMtZXZlbnQudHM/YWFkOSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuYmluZEV2ZW50cyA9IHZvaWQgMDtcbmNvbnN0IHNjcmVlbl8xID0gcmVxdWlyZShcIi4uL21hdGgvc2NyZWVuXCIpO1xuY29uc3QgdmVjXzEgPSByZXF1aXJlKFwiLi4vbWF0aC92ZWNcIik7XG4vLyBBaXJjcmFmdF9wcmluY2lwYWxfYXhlc1xuZnVuY3Rpb24gYmluZEV2ZW50cyhjYW52YXMsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCwgbW91c2VQb3NpdGlvbikge1xuICAgIGNvbnN0IGV2ZW50U3RhY2sgPSBbXTtcbiAgICBjb25zdCBrZXlib2FyZCA9IG5ldyBVaW50OEFycmF5KDEyOCk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkuY2hhckNvZGVBdCgwKSA8IDEyOCkge1xuICAgICAgICAgICAga2V5Ym9hcmRbZS5rZXkuY2hhckNvZGVBdCgwKV0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAna2V5ZG93bicsXG4gICAgICAgICAgICBrZXlDb2RlOiBlLmtleS5jaGFyQ29kZUF0KDApLFxuICAgICAgICAgICAga2V5OiBlLmtleSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGUpID0+IHtcbiAgICAgICAgaWYgKGUua2V5LmNoYXJDb2RlQXQoMCkgPCAxMjgpIHtcbiAgICAgICAgICAgIGtleWJvYXJkW2Uua2V5LmNoYXJDb2RlQXQoMCldID0gMDtcbiAgICAgICAgfVxuICAgICAgICBldmVudFN0YWNrLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2tleXVwJyxcbiAgICAgICAgICAgIGtleUNvZGU6IGUua2V5LmNoYXJDb2RlQXQoMCksXG4gICAgICAgICAgICBrZXk6IGUua2V5LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCAoZSkgPT4ge1xuICAgICAgICBldmVudFN0YWNrLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ2tleXByZXNzJyxcbiAgICAgICAgICAgIGtleUNvZGU6IC0xLFxuICAgICAgICAgICAga2V5OiBlLmtleSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvb3JkID0gKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgKDAsIHNjcmVlbl8xLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCkoY29vcmQsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2Vkb3duJyxcbiAgICAgICAgICAgIHg6IGNvb3JkLngsXG4gICAgICAgICAgICB5OiBjb29yZC55LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpID0+IHtcbiAgICAgICAgY29uc3QgY29vcmQgPSAoMCwgdmVjXzEuY3JlYXRlVmVjMikoZS5vZmZzZXRYLCBlLm9mZnNldFkpO1xuICAgICAgICAoMCwgc2NyZWVuXzEuY29udmVydFNjcmVlbkNvb3JkVG9Xb3JsZENvb3JkKShjb29yZCwgY2FtZXJhUG9zaXRpb24sIHBhaXRpbmdMYXllciwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCwgZm92eSwgYXNwZWN0KTtcbiAgICAgICAgbW91c2VQb3NpdGlvbi54ID0gZS5vZmZzZXRYO1xuICAgICAgICBtb3VzZVBvc2l0aW9uLnkgPSBlLm9mZnNldFk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2Vtb3ZlJyxcbiAgICAgICAgICAgIHg6IGNvb3JkLngsXG4gICAgICAgICAgICB5OiBjb29yZC55LFxuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNvb3JkID0gKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGUub2Zmc2V0WCwgZS5vZmZzZXRZKTtcbiAgICAgICAgKDAsIHNjcmVlbl8xLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCkoY29vcmQsIGNhbWVyYVBvc2l0aW9uLCBwYWl0aW5nTGF5ZXIsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQsIGZvdnksIGFzcGVjdCk7XG4gICAgICAgIGV2ZW50U3RhY2sucHVzaCh7XG4gICAgICAgICAgICB0eXBlOiAnbW91c2V1cCcsXG4gICAgICAgICAgICB4OiBjb29yZC54LFxuICAgICAgICAgICAgeTogY29vcmQueSxcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgZXZlbnRTdGFjaywga2V5Ym9hcmQgfTtcbn1cbmV4cG9ydHMuYmluZEV2ZW50cyA9IGJpbmRFdmVudHM7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/event/canvas-event.ts\n");

/***/ }),

/***/ "./src/event/const.ts":
/*!****************************!*\
  !*** ./src/event/const.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.KeyboardKeyCode = void 0;\nvar KeyboardKeyCode;\n(function (KeyboardKeyCode) {\n    KeyboardKeyCode[KeyboardKeyCode[\"spaceKey\"] = 32] = \"spaceKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"aKey\"] = 97] = \"aKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"dKey\"] = 100] = \"dKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"sKey\"] = 115] = \"sKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"wKey\"] = 119] = \"wKey\";\n    KeyboardKeyCode[KeyboardKeyCode[\"zKey\"] = 122] = \"zKey\";\n})(KeyboardKeyCode = exports.KeyboardKeyCode || (exports.KeyboardKeyCode = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZXZlbnQvY29uc3QudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0QsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdEQUFnRCx1QkFBdUIsS0FBSyIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9ldmVudC9jb25zdC50cz9iMTQyIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5LZXlib2FyZEtleUNvZGUgPSB2b2lkIDA7XG52YXIgS2V5Ym9hcmRLZXlDb2RlO1xuKGZ1bmN0aW9uIChLZXlib2FyZEtleUNvZGUpIHtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wic3BhY2VLZXlcIl0gPSAzMl0gPSBcInNwYWNlS2V5XCI7XG4gICAgS2V5Ym9hcmRLZXlDb2RlW0tleWJvYXJkS2V5Q29kZVtcImFLZXlcIl0gPSA5N10gPSBcImFLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wiZEtleVwiXSA9IDEwMF0gPSBcImRLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wic0tleVwiXSA9IDExNV0gPSBcInNLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wid0tleVwiXSA9IDExOV0gPSBcIndLZXlcIjtcbiAgICBLZXlib2FyZEtleUNvZGVbS2V5Ym9hcmRLZXlDb2RlW1wiektleVwiXSA9IDEyMl0gPSBcInpLZXlcIjtcbn0pKEtleWJvYXJkS2V5Q29kZSA9IGV4cG9ydHMuS2V5Ym9hcmRLZXlDb2RlIHx8IChleHBvcnRzLktleWJvYXJkS2V5Q29kZSA9IHt9KSk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/event/const.ts\n");

/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nconst vec_1 = __webpack_require__(/*! ./math/vec */ \"./src/math/vec.ts\");\nconst matix_1 = __webpack_require__(/*! ./math/matix */ \"./src/math/matix.ts\");\nconst utils_1 = __webpack_require__(/*! ./math/utils */ \"./src/math/utils.ts\");\nconst screen_1 = __webpack_require__(/*! ./math/screen */ \"./src/math/screen.ts\");\nconst canvas_event_1 = __webpack_require__(/*! ./event/canvas-event */ \"./src/event/canvas-event.ts\");\nconst const_1 = __webpack_require__(/*! ./event/const */ \"./src/event/const.ts\");\nconst renderer_1 = __webpack_require__(/*! ./render/renderer */ \"./src/render/renderer.ts\");\nconst components_1 = __webpack_require__(/*! ./render/components */ \"./src/render/components.ts\");\nconst const_2 = __webpack_require__(/*! ./render/const */ \"./src/render/const.ts\");\nconst uniqeId_1 = __webpack_require__(/*! ./utils/uniqeId */ \"./src/utils/uniqeId.ts\");\nconst memory_1 = __webpack_require__(/*! ./utils/memory */ \"./src/utils/memory.ts\");\n// import { binaryFind } from './utils/array';\nconst getNewId = (0, uniqeId_1.createUniqeIdGenerator)(1);\nconst mousePosition = (0, vec_1.createVec2)(0, 0);\nvar DrawMode;\n(function (DrawMode) {\n    DrawMode[\"line\"] = \"line\";\n    DrawMode[\"circle\"] = \"circle\";\n})(DrawMode || (DrawMode = {}));\nlet mode = DrawMode.line; // line circle\nconst lines = [];\nconst circles = [];\nconst screenWidth = 600;\nconst screenHeight = 400;\nconst canvas = document.getElementById('canvas');\nconst componentIdViewer = document.getElementById('component-id');\nconst mousePostionViewer = document.getElementById('mouse-position');\nconst circleCountViewer = document.getElementById('circle-count');\ncanvas.width = screenWidth;\ncanvas.height = screenHeight;\ncanvas.style.width = `${screenWidth}px`;\ncanvas.style.height = `${screenHeight}px`;\nconst gl = canvas.getContext('webgl2', { antialias: false });\nconst renderer = new renderer_1.Renderer(gl, screenWidth, screenHeight);\nconst near = 0.1;\nconst far = 10.0;\nconst fovy = (0, utils_1.toRadians)(45);\nconst aspect = screenWidth / screenHeight;\nconst cameraPosition = (0, vec_1.createVec3)(0, 0, 0);\nconst { keyboard, eventStack } = (0, canvas_event_1.bindEvents)(canvas, cameraPosition, const_2.paitingLayer, screenWidth, screenHeight, fovy, aspect, mousePosition);\nlet drawingLine = false;\nlet drawingCirle = false;\nlet lineCount = 0;\nfunction updateCamera() {\n    // TODO: use function\n    // TODO: make it slow when it goes closer to near\n    let updateValue = Math.sin((0, utils_1.toRadians)(((cameraPosition.z + 2.8) / 9.0 * 8.0) + 270.0 + 11.0)) + 1.0;\n    updateValue = Math.max(updateValue, 0.005);\n    // -2.9\n    if (keyboard[const_1.KeyboardKeyCode.wKey]) {\n        cameraPosition.z = cameraPosition.z - updateValue < -2.8 ? -2.8 : cameraPosition.z - updateValue;\n    }\n    // 6.0\n    if (keyboard[const_1.KeyboardKeyCode.sKey]) {\n        cameraPosition.z = cameraPosition.z + updateValue > 6.0 ? 6.0 : cameraPosition.z + updateValue;\n    }\n    // updateValue = updateValue !== 0.1 ? updateValue * 2 : updateValue;\n    if (keyboard[const_1.KeyboardKeyCode.dKey]) {\n        cameraPosition.x += updateValue;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.aKey]) {\n        cameraPosition.x -= updateValue;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.spaceKey]) {\n        cameraPosition.y += updateValue;\n    }\n    if (keyboard[const_1.KeyboardKeyCode.zKey]) {\n        cameraPosition.y -= updateValue;\n    }\n}\nfunction renderLines() {\n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        renderer.drawLine(line);\n    }\n    for (let i = 0; i < lines.length - 1; i++) {\n        const line = lines[i];\n        const nextLines = lines[i + 1];\n        if (line.line === nextLines.line) {\n            const circle = {\n                position: nextLines.position, radius: 0.1 / 2, id: line.id\n            };\n            renderer.drawCircle(circle);\n        }\n    }\n}\nfunction renderCircles() {\n    for (let i = 0; i < circles.length; i++) {\n        const circle = circles[i];\n        renderer.drawCircle(circle);\n    }\n}\nfunction handleEvents() {\n    let i = 0;\n    while (i < eventStack.length) {\n        const event = eventStack[i];\n        if (mode === DrawMode.line) {\n            if (event.type === 'mousedown' && !drawingLine) {\n                drawingLine = true;\n                const length = 0.01;\n                lines.push((0, components_1.createLine)((0, vec_1.createVec2)(event.x, event.y), length, getNewId()));\n                lines[lines.length - 1].line = lineCount;\n            }\n            else if (event.type === 'mousedown' && drawingLine) {\n                const lastLine = lines[lines.length - 1];\n                const lengthX = event.x - lastLine.position.x;\n                const lengthY = event.y - lastLine.position.y;\n                let angle = (0, screen_1.getAngleFromLineProjection)(lengthX, lengthY);\n                let lineLength = 0.0;\n                if (angle === 90 || angle === 270) {\n                    lineLength = lengthY;\n                }\n                else {\n                    lineLength = (lengthX) / Math.cos((0, utils_1.toRadians)(angle));\n                }\n                // TODO: find out linear transformation, transform screen cordination to world\n                lastLine.length = lineLength;\n                lastLine.rotate = angle;\n                const length = 0.01;\n                lines.push((0, components_1.createLine)((0, vec_1.createVec2)(event.x, event.y), length, getNewId()));\n                lines[lines.length - 1].line = lineCount;\n            }\n            if (event.type === 'mousemove' && drawingLine) {\n                const lastLine = lines[lines.length - 1];\n                const lengthX = event.x - lastLine.position.x;\n                const lengthY = event.y - lastLine.position.y;\n                let angle = (0, screen_1.getAngleFromLineProjection)(lengthX, lengthY);\n                let lineLength = 0.0;\n                if (angle === 90 || angle === 270) {\n                    lineLength = lengthY;\n                }\n                else {\n                    lineLength = (lengthX) / Math.cos((0, utils_1.toRadians)(angle));\n                }\n                // TODO: find out linear transformation, transform screen cordination to world\n                lastLine.length = lineLength;\n                lastLine.rotate = angle;\n            }\n            if (event.type === 'keypress' && event.key === 'Enter' && drawingLine) {\n                drawingLine = false;\n                lines.pop();\n                lineCount += 1;\n            }\n        }\n        if (mode === DrawMode.circle) {\n            if (event.type === 'mousedown' && !drawingCirle) {\n                circles.push({\n                    position: (0, vec_1.createVec2)(event.x, event.y),\n                    radius: 0.1,\n                    id: getNewId()\n                });\n                drawingCirle = true;\n            }\n            if (event.type === 'mousemove' && drawingCirle) {\n                circles.push({\n                    position: (0, vec_1.createVec2)(event.x, event.y),\n                    radius: 0.1,\n                    id: getNewId()\n                });\n            }\n            if (event.type === 'mouseup' && drawingCirle) {\n                drawingCirle = false;\n            }\n        }\n        i++;\n    }\n    let length = eventStack.length;\n    for (let i = 0; i < length; i++) {\n        eventStack.pop();\n    }\n}\nfunction updateHTML() {\n    const b = renderer.getIdDataReader().readPixel(mousePosition.x, screenHeight - mousePosition.y);\n    const componentId = (0, memory_1.interpretAsInt32)(b[0], b[1], b[2], b[3]);\n    // const component = componentId !== 0 ? binaryFind(lines, 0, lines.length, l => componentId - l.id) : null;\n    componentIdViewer.innerText = `current component id: ${componentId === 0 ? 'no selected component' : componentId}`;\n    mousePostionViewer.innerText = `mouse position x: ${mousePosition.x} y: ${mousePosition.y}`;\n    circleCountViewer.innerText = `circle count: ${renderer.getDrawStat().drawedCircles} flushed count: ${renderer.getDrawStat().circleFlushed}`;\n}\n// let cancel = null;\n// TODO: check with glm about transpose projection\nconst projectionMatrix = ((0, matix_1.createPerspectiveMatrix)(fovy, aspect, near, far));\nfunction loop() {\n    requestAnimationFrame(loop);\n    handleEvents();\n    let viewMatrix = (0, matix_1.createUnitMatrix)(1.0);\n    viewMatrix = (0, matix_1.multiplyMatrix)(viewMatrix, (0, matix_1.createRotationMatrix)(0, 0, 0)); // rotate\n    viewMatrix = (0, matix_1.multiplyMatrix)(viewMatrix, (0, matix_1.createTranslationMatrix)(cameraPosition.x, cameraPosition.y, cameraPosition.z)); // translate\n    updateCamera();\n    renderer.beginScene(projectionMatrix, (0, matix_1.transposeMatrix)(viewMatrix));\n    renderLines();\n    renderCircles();\n    renderer.endScene();\n    updateHTML();\n}\nwindow.getIds = () => {\n    console.log(renderer.getIdDataReader().readBuffer());\n};\n// setTimeout(() => {\n//   cancelAnimationFrame(cancel);\n// }, 3000);\nloop();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWFpbi50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxjQUFjLG1CQUFPLENBQUMscUNBQVk7QUFDbEMsZ0JBQWdCLG1CQUFPLENBQUMseUNBQWM7QUFDdEMsZ0JBQWdCLG1CQUFPLENBQUMseUNBQWM7QUFDdEMsaUJBQWlCLG1CQUFPLENBQUMsMkNBQWU7QUFDeEMsdUJBQXVCLG1CQUFPLENBQUMseURBQXNCO0FBQ3JELGdCQUFnQixtQkFBTyxDQUFDLDJDQUFlO0FBQ3ZDLG1CQUFtQixtQkFBTyxDQUFDLG1EQUFtQjtBQUM5QyxxQkFBcUIsbUJBQU8sQ0FBQyx1REFBcUI7QUFDbEQsZ0JBQWdCLG1CQUFPLENBQUMsNkNBQWdCO0FBQ3hDLGtCQUFrQixtQkFBTyxDQUFDLCtDQUFpQjtBQUMzQyxpQkFBaUIsbUJBQU8sQ0FBQyw2Q0FBZ0I7QUFDekMsWUFBWSxhQUFhO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNEJBQTRCO0FBQzdCLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixZQUFZO0FBQ3BDLHlCQUF5QixhQUFhO0FBQ3RDLHlDQUF5QyxrQkFBa0I7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1QkFBdUI7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isa0JBQWtCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixzQkFBc0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixvQkFBb0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFlBQVk7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsMERBQTBEO0FBQ3JILHdEQUF3RCxpQkFBaUIsS0FBSyxnQkFBZ0I7QUFDOUYsbURBQW1ELHNDQUFzQyxpQkFBaUIscUNBQXFDO0FBQy9JO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzR0FBc0c7QUFDdEcsc0pBQXNKO0FBQ3RKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9tYWluLnRzPzM0ZDMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5jb25zdCB2ZWNfMSA9IHJlcXVpcmUoXCIuL21hdGgvdmVjXCIpO1xuY29uc3QgbWF0aXhfMSA9IHJlcXVpcmUoXCIuL21hdGgvbWF0aXhcIik7XG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vbWF0aC91dGlsc1wiKTtcbmNvbnN0IHNjcmVlbl8xID0gcmVxdWlyZShcIi4vbWF0aC9zY3JlZW5cIik7XG5jb25zdCBjYW52YXNfZXZlbnRfMSA9IHJlcXVpcmUoXCIuL2V2ZW50L2NhbnZhcy1ldmVudFwiKTtcbmNvbnN0IGNvbnN0XzEgPSByZXF1aXJlKFwiLi9ldmVudC9jb25zdFwiKTtcbmNvbnN0IHJlbmRlcmVyXzEgPSByZXF1aXJlKFwiLi9yZW5kZXIvcmVuZGVyZXJcIik7XG5jb25zdCBjb21wb25lbnRzXzEgPSByZXF1aXJlKFwiLi9yZW5kZXIvY29tcG9uZW50c1wiKTtcbmNvbnN0IGNvbnN0XzIgPSByZXF1aXJlKFwiLi9yZW5kZXIvY29uc3RcIik7XG5jb25zdCB1bmlxZUlkXzEgPSByZXF1aXJlKFwiLi91dGlscy91bmlxZUlkXCIpO1xuY29uc3QgbWVtb3J5XzEgPSByZXF1aXJlKFwiLi91dGlscy9tZW1vcnlcIik7XG4vLyBpbXBvcnQgeyBiaW5hcnlGaW5kIH0gZnJvbSAnLi91dGlscy9hcnJheSc7XG5jb25zdCBnZXROZXdJZCA9ICgwLCB1bmlxZUlkXzEuY3JlYXRlVW5pcWVJZEdlbmVyYXRvcikoMSk7XG5jb25zdCBtb3VzZVBvc2l0aW9uID0gKDAsIHZlY18xLmNyZWF0ZVZlYzIpKDAsIDApO1xudmFyIERyYXdNb2RlO1xuKGZ1bmN0aW9uIChEcmF3TW9kZSkge1xuICAgIERyYXdNb2RlW1wibGluZVwiXSA9IFwibGluZVwiO1xuICAgIERyYXdNb2RlW1wiY2lyY2xlXCJdID0gXCJjaXJjbGVcIjtcbn0pKERyYXdNb2RlIHx8IChEcmF3TW9kZSA9IHt9KSk7XG5sZXQgbW9kZSA9IERyYXdNb2RlLmxpbmU7IC8vIGxpbmUgY2lyY2xlXG5jb25zdCBsaW5lcyA9IFtdO1xuY29uc3QgY2lyY2xlcyA9IFtdO1xuY29uc3Qgc2NyZWVuV2lkdGggPSA2MDA7XG5jb25zdCBzY3JlZW5IZWlnaHQgPSA0MDA7XG5jb25zdCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5jb25zdCBjb21wb25lbnRJZFZpZXdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb21wb25lbnQtaWQnKTtcbmNvbnN0IG1vdXNlUG9zdGlvblZpZXdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb3VzZS1wb3NpdGlvbicpO1xuY29uc3QgY2lyY2xlQ291bnRWaWV3ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2lyY2xlLWNvdW50Jyk7XG5jYW52YXMud2lkdGggPSBzY3JlZW5XaWR0aDtcbmNhbnZhcy5oZWlnaHQgPSBzY3JlZW5IZWlnaHQ7XG5jYW52YXMuc3R5bGUud2lkdGggPSBgJHtzY3JlZW5XaWR0aH1weGA7XG5jYW52YXMuc3R5bGUuaGVpZ2h0ID0gYCR7c2NyZWVuSGVpZ2h0fXB4YDtcbmNvbnN0IGdsID0gY2FudmFzLmdldENvbnRleHQoJ3dlYmdsMicsIHsgYW50aWFsaWFzOiBmYWxzZSB9KTtcbmNvbnN0IHJlbmRlcmVyID0gbmV3IHJlbmRlcmVyXzEuUmVuZGVyZXIoZ2wsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpO1xuY29uc3QgbmVhciA9IDAuMTtcbmNvbnN0IGZhciA9IDEwLjA7XG5jb25zdCBmb3Z5ID0gKDAsIHV0aWxzXzEudG9SYWRpYW5zKSg0NSk7XG5jb25zdCBhc3BlY3QgPSBzY3JlZW5XaWR0aCAvIHNjcmVlbkhlaWdodDtcbmNvbnN0IGNhbWVyYVBvc2l0aW9uID0gKDAsIHZlY18xLmNyZWF0ZVZlYzMpKDAsIDAsIDApO1xuY29uc3QgeyBrZXlib2FyZCwgZXZlbnRTdGFjayB9ID0gKDAsIGNhbnZhc19ldmVudF8xLmJpbmRFdmVudHMpKGNhbnZhcywgY2FtZXJhUG9zaXRpb24sIGNvbnN0XzIucGFpdGluZ0xheWVyLCBzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0LCBmb3Z5LCBhc3BlY3QsIG1vdXNlUG9zaXRpb24pO1xubGV0IGRyYXdpbmdMaW5lID0gZmFsc2U7XG5sZXQgZHJhd2luZ0NpcmxlID0gZmFsc2U7XG5sZXQgbGluZUNvdW50ID0gMDtcbmZ1bmN0aW9uIHVwZGF0ZUNhbWVyYSgpIHtcbiAgICAvLyBUT0RPOiB1c2UgZnVuY3Rpb25cbiAgICAvLyBUT0RPOiBtYWtlIGl0IHNsb3cgd2hlbiBpdCBnb2VzIGNsb3NlciB0byBuZWFyXG4gICAgbGV0IHVwZGF0ZVZhbHVlID0gTWF0aC5zaW4oKDAsIHV0aWxzXzEudG9SYWRpYW5zKSgoKGNhbWVyYVBvc2l0aW9uLnogKyAyLjgpIC8gOS4wICogOC4wKSArIDI3MC4wICsgMTEuMCkpICsgMS4wO1xuICAgIHVwZGF0ZVZhbHVlID0gTWF0aC5tYXgodXBkYXRlVmFsdWUsIDAuMDA1KTtcbiAgICAvLyAtMi45XG4gICAgaWYgKGtleWJvYXJkW2NvbnN0XzEuS2V5Ym9hcmRLZXlDb2RlLndLZXldKSB7XG4gICAgICAgIGNhbWVyYVBvc2l0aW9uLnogPSBjYW1lcmFQb3NpdGlvbi56IC0gdXBkYXRlVmFsdWUgPCAtMi44ID8gLTIuOCA6IGNhbWVyYVBvc2l0aW9uLnogLSB1cGRhdGVWYWx1ZTtcbiAgICB9XG4gICAgLy8gNi4wXG4gICAgaWYgKGtleWJvYXJkW2NvbnN0XzEuS2V5Ym9hcmRLZXlDb2RlLnNLZXldKSB7XG4gICAgICAgIGNhbWVyYVBvc2l0aW9uLnogPSBjYW1lcmFQb3NpdGlvbi56ICsgdXBkYXRlVmFsdWUgPiA2LjAgPyA2LjAgOiBjYW1lcmFQb3NpdGlvbi56ICsgdXBkYXRlVmFsdWU7XG4gICAgfVxuICAgIC8vIHVwZGF0ZVZhbHVlID0gdXBkYXRlVmFsdWUgIT09IDAuMSA/IHVwZGF0ZVZhbHVlICogMiA6IHVwZGF0ZVZhbHVlO1xuICAgIGlmIChrZXlib2FyZFtjb25zdF8xLktleWJvYXJkS2V5Q29kZS5kS2V5XSkge1xuICAgICAgICBjYW1lcmFQb3NpdGlvbi54ICs9IHVwZGF0ZVZhbHVlO1xuICAgIH1cbiAgICBpZiAoa2V5Ym9hcmRbY29uc3RfMS5LZXlib2FyZEtleUNvZGUuYUtleV0pIHtcbiAgICAgICAgY2FtZXJhUG9zaXRpb24ueCAtPSB1cGRhdGVWYWx1ZTtcbiAgICB9XG4gICAgaWYgKGtleWJvYXJkW2NvbnN0XzEuS2V5Ym9hcmRLZXlDb2RlLnNwYWNlS2V5XSkge1xuICAgICAgICBjYW1lcmFQb3NpdGlvbi55ICs9IHVwZGF0ZVZhbHVlO1xuICAgIH1cbiAgICBpZiAoa2V5Ym9hcmRbY29uc3RfMS5LZXlib2FyZEtleUNvZGUuektleV0pIHtcbiAgICAgICAgY2FtZXJhUG9zaXRpb24ueSAtPSB1cGRhdGVWYWx1ZTtcbiAgICB9XG59XG5mdW5jdGlvbiByZW5kZXJMaW5lcygpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgcmVuZGVyZXIuZHJhd0xpbmUobGluZSk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXTtcbiAgICAgICAgY29uc3QgbmV4dExpbmVzID0gbGluZXNbaSArIDFdO1xuICAgICAgICBpZiAobGluZS5saW5lID09PSBuZXh0TGluZXMubGluZSkge1xuICAgICAgICAgICAgY29uc3QgY2lyY2xlID0ge1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXh0TGluZXMucG9zaXRpb24sIHJhZGl1czogMC4xIC8gMiwgaWQ6IGxpbmUuaWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZW5kZXJlci5kcmF3Q2lyY2xlKGNpcmNsZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiByZW5kZXJDaXJjbGVzKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2lyY2xlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjaXJjbGUgPSBjaXJjbGVzW2ldO1xuICAgICAgICByZW5kZXJlci5kcmF3Q2lyY2xlKGNpcmNsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaGFuZGxlRXZlbnRzKCkge1xuICAgIGxldCBpID0gMDtcbiAgICB3aGlsZSAoaSA8IGV2ZW50U3RhY2subGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50ID0gZXZlbnRTdGFja1tpXTtcbiAgICAgICAgaWYgKG1vZGUgPT09IERyYXdNb2RlLmxpbmUpIHtcbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vkb3duJyAmJiAhZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgICAgICAgICBkcmF3aW5nTGluZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuZ3RoID0gMC4wMTtcbiAgICAgICAgICAgICAgICBsaW5lcy5wdXNoKCgwLCBjb21wb25lbnRzXzEuY3JlYXRlTGluZSkoKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGV2ZW50LngsIGV2ZW50LnkpLCBsZW5ndGgsIGdldE5ld0lkKCkpKTtcbiAgICAgICAgICAgICAgICBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXS5saW5lID0gbGluZUNvdW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZXZlbnQudHlwZSA9PT0gJ21vdXNlZG93bicgJiYgZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0TGluZSA9IGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aFggPSBldmVudC54IC0gbGFzdExpbmUucG9zaXRpb24ueDtcbiAgICAgICAgICAgICAgICBjb25zdCBsZW5ndGhZID0gZXZlbnQueSAtIGxhc3RMaW5lLnBvc2l0aW9uLnk7XG4gICAgICAgICAgICAgICAgbGV0IGFuZ2xlID0gKDAsIHNjcmVlbl8xLmdldEFuZ2xlRnJvbUxpbmVQcm9qZWN0aW9uKShsZW5ndGhYLCBsZW5ndGhZKTtcbiAgICAgICAgICAgICAgICBsZXQgbGluZUxlbmd0aCA9IDAuMDtcbiAgICAgICAgICAgICAgICBpZiAoYW5nbGUgPT09IDkwIHx8IGFuZ2xlID09PSAyNzApIHtcbiAgICAgICAgICAgICAgICAgICAgbGluZUxlbmd0aCA9IGxlbmd0aFk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsaW5lTGVuZ3RoID0gKGxlbmd0aFgpIC8gTWF0aC5jb3MoKDAsIHV0aWxzXzEudG9SYWRpYW5zKShhbmdsZSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBmaW5kIG91dCBsaW5lYXIgdHJhbnNmb3JtYXRpb24sIHRyYW5zZm9ybSBzY3JlZW4gY29yZGluYXRpb24gdG8gd29ybGRcbiAgICAgICAgICAgICAgICBsYXN0TGluZS5sZW5ndGggPSBsaW5lTGVuZ3RoO1xuICAgICAgICAgICAgICAgIGxhc3RMaW5lLnJvdGF0ZSA9IGFuZ2xlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aCA9IDAuMDE7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaCgoMCwgY29tcG9uZW50c18xLmNyZWF0ZUxpbmUpKCgwLCB2ZWNfMS5jcmVhdGVWZWMyKShldmVudC54LCBldmVudC55KSwgbGVuZ3RoLCBnZXROZXdJZCgpKSk7XG4gICAgICAgICAgICAgICAgbGluZXNbbGluZXMubGVuZ3RoIC0gMV0ubGluZSA9IGxpbmVDb3VudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vtb3ZlJyAmJiBkcmF3aW5nTGluZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RMaW5lID0gbGluZXNbbGluZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuZ3RoWCA9IGV2ZW50LnggLSBsYXN0TGluZS5wb3NpdGlvbi54O1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlbmd0aFkgPSBldmVudC55IC0gbGFzdExpbmUucG9zaXRpb24ueTtcbiAgICAgICAgICAgICAgICBsZXQgYW5nbGUgPSAoMCwgc2NyZWVuXzEuZ2V0QW5nbGVGcm9tTGluZVByb2plY3Rpb24pKGxlbmd0aFgsIGxlbmd0aFkpO1xuICAgICAgICAgICAgICAgIGxldCBsaW5lTGVuZ3RoID0gMC4wO1xuICAgICAgICAgICAgICAgIGlmIChhbmdsZSA9PT0gOTAgfHwgYW5nbGUgPT09IDI3MCkge1xuICAgICAgICAgICAgICAgICAgICBsaW5lTGVuZ3RoID0gbGVuZ3RoWTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxpbmVMZW5ndGggPSAobGVuZ3RoWCkgLyBNYXRoLmNvcygoMCwgdXRpbHNfMS50b1JhZGlhbnMpKGFuZ2xlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFRPRE86IGZpbmQgb3V0IGxpbmVhciB0cmFuc2Zvcm1hdGlvbiwgdHJhbnNmb3JtIHNjcmVlbiBjb3JkaW5hdGlvbiB0byB3b3JsZFxuICAgICAgICAgICAgICAgIGxhc3RMaW5lLmxlbmd0aCA9IGxpbmVMZW5ndGg7XG4gICAgICAgICAgICAgICAgbGFzdExpbmUucm90YXRlID0gYW5nbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gJ2tleXByZXNzJyAmJiBldmVudC5rZXkgPT09ICdFbnRlcicgJiYgZHJhd2luZ0xpbmUpIHtcbiAgICAgICAgICAgICAgICBkcmF3aW5nTGluZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGxpbmVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIGxpbmVDb3VudCArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChtb2RlID09PSBEcmF3TW9kZS5jaXJjbGUpIHtcbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vkb3duJyAmJiAhZHJhd2luZ0NpcmxlKSB7XG4gICAgICAgICAgICAgICAgY2lyY2xlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICgwLCB2ZWNfMS5jcmVhdGVWZWMyKShldmVudC54LCBldmVudC55KSxcbiAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAwLjEsXG4gICAgICAgICAgICAgICAgICAgIGlkOiBnZXROZXdJZCgpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZHJhd2luZ0NpcmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2Vtb3ZlJyAmJiBkcmF3aW5nQ2lybGUpIHtcbiAgICAgICAgICAgICAgICBjaXJjbGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogKDAsIHZlY18xLmNyZWF0ZVZlYzIpKGV2ZW50LngsIGV2ZW50LnkpLFxuICAgICAgICAgICAgICAgICAgICByYWRpdXM6IDAuMSxcbiAgICAgICAgICAgICAgICAgICAgaWQ6IGdldE5ld0lkKClcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChldmVudC50eXBlID09PSAnbW91c2V1cCcgJiYgZHJhd2luZ0NpcmxlKSB7XG4gICAgICAgICAgICAgICAgZHJhd2luZ0NpcmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaSsrO1xuICAgIH1cbiAgICBsZXQgbGVuZ3RoID0gZXZlbnRTdGFjay5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBldmVudFN0YWNrLnBvcCgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZUhUTUwoKSB7XG4gICAgY29uc3QgYiA9IHJlbmRlcmVyLmdldElkRGF0YVJlYWRlcigpLnJlYWRQaXhlbChtb3VzZVBvc2l0aW9uLngsIHNjcmVlbkhlaWdodCAtIG1vdXNlUG9zaXRpb24ueSk7XG4gICAgY29uc3QgY29tcG9uZW50SWQgPSAoMCwgbWVtb3J5XzEuaW50ZXJwcmV0QXNJbnQzMikoYlswXSwgYlsxXSwgYlsyXSwgYlszXSk7XG4gICAgLy8gY29uc3QgY29tcG9uZW50ID0gY29tcG9uZW50SWQgIT09IDAgPyBiaW5hcnlGaW5kKGxpbmVzLCAwLCBsaW5lcy5sZW5ndGgsIGwgPT4gY29tcG9uZW50SWQgLSBsLmlkKSA6IG51bGw7XG4gICAgY29tcG9uZW50SWRWaWV3ZXIuaW5uZXJUZXh0ID0gYGN1cnJlbnQgY29tcG9uZW50IGlkOiAke2NvbXBvbmVudElkID09PSAwID8gJ25vIHNlbGVjdGVkIGNvbXBvbmVudCcgOiBjb21wb25lbnRJZH1gO1xuICAgIG1vdXNlUG9zdGlvblZpZXdlci5pbm5lclRleHQgPSBgbW91c2UgcG9zaXRpb24geDogJHttb3VzZVBvc2l0aW9uLnh9IHk6ICR7bW91c2VQb3NpdGlvbi55fWA7XG4gICAgY2lyY2xlQ291bnRWaWV3ZXIuaW5uZXJUZXh0ID0gYGNpcmNsZSBjb3VudDogJHtyZW5kZXJlci5nZXREcmF3U3RhdCgpLmRyYXdlZENpcmNsZXN9IGZsdXNoZWQgY291bnQ6ICR7cmVuZGVyZXIuZ2V0RHJhd1N0YXQoKS5jaXJjbGVGbHVzaGVkfWA7XG59XG4vLyBsZXQgY2FuY2VsID0gbnVsbDtcbi8vIFRPRE86IGNoZWNrIHdpdGggZ2xtIGFib3V0IHRyYW5zcG9zZSBwcm9qZWN0aW9uXG5jb25zdCBwcm9qZWN0aW9uTWF0cml4ID0gKCgwLCBtYXRpeF8xLmNyZWF0ZVBlcnNwZWN0aXZlTWF0cml4KShmb3Z5LCBhc3BlY3QsIG5lYXIsIGZhcikpO1xuZnVuY3Rpb24gbG9vcCgpIHtcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG4gICAgaGFuZGxlRXZlbnRzKCk7XG4gICAgbGV0IHZpZXdNYXRyaXggPSAoMCwgbWF0aXhfMS5jcmVhdGVVbml0TWF0cml4KSgxLjApO1xuICAgIHZpZXdNYXRyaXggPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodmlld01hdHJpeCwgKDAsIG1hdGl4XzEuY3JlYXRlUm90YXRpb25NYXRyaXgpKDAsIDAsIDApKTsgLy8gcm90YXRlXG4gICAgdmlld01hdHJpeCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh2aWV3TWF0cml4LCAoMCwgbWF0aXhfMS5jcmVhdGVUcmFuc2xhdGlvbk1hdHJpeCkoY2FtZXJhUG9zaXRpb24ueCwgY2FtZXJhUG9zaXRpb24ueSwgY2FtZXJhUG9zaXRpb24ueikpOyAvLyB0cmFuc2xhdGVcbiAgICB1cGRhdGVDYW1lcmEoKTtcbiAgICByZW5kZXJlci5iZWdpblNjZW5lKHByb2plY3Rpb25NYXRyaXgsICgwLCBtYXRpeF8xLnRyYW5zcG9zZU1hdHJpeCkodmlld01hdHJpeCkpO1xuICAgIHJlbmRlckxpbmVzKCk7XG4gICAgcmVuZGVyQ2lyY2xlcygpO1xuICAgIHJlbmRlcmVyLmVuZFNjZW5lKCk7XG4gICAgdXBkYXRlSFRNTCgpO1xufVxud2luZG93LmdldElkcyA9ICgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhyZW5kZXJlci5nZXRJZERhdGFSZWFkZXIoKS5yZWFkQnVmZmVyKCkpO1xufTtcbi8vIHNldFRpbWVvdXQoKCkgPT4ge1xuLy8gICBjYW5jZWxBbmltYXRpb25GcmFtZShjYW5jZWwpO1xuLy8gfSwgMzAwMCk7XG5sb29wKCk7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/main.ts\n");

/***/ }),

/***/ "./src/math/matix.ts":
/*!***************************!*\
  !*** ./src/math/matix.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.multiplyMatrix = exports.createRotationMatrix = exports.createScaleMatrix = exports.createTranslationMatrix = exports.createPerspectiveMatrix = exports.transposeMatrix = exports.createUnitMatrix = exports.printMatrix = exports.setMatrixValue = exports.getMatrixValue = exports.getRawValues = exports.createMatrix = void 0;\nfunction createMatrix(values, n = 4, m = 4) {\n    return ({\n        n: n,\n        m: m,\n        values: Float32Array.from(values.slice(0, n * m))\n    });\n}\nexports.createMatrix = createMatrix;\nfunction getRawValues(matrix) {\n    return matrix.values;\n}\nexports.getRawValues = getRawValues;\nfunction getMatrixValue(matrix, j, i) {\n    return matrix.values[i + matrix.m * j];\n}\nexports.getMatrixValue = getMatrixValue;\nfunction setMatrixValue(matrix, j, i, value) {\n    matrix.values[i + matrix.m * j] = value;\n}\nexports.setMatrixValue = setMatrixValue;\nfunction printMatrix(matrix) {\n    let res = '';\n    for (let j = 0; j < matrix.n; j++) {\n        res += `(${getMatrixValue(matrix, j, 0)}`;\n        for (let i = 1; i < matrix.m; i++) {\n            res += `|${getMatrixValue(matrix, j, i)}`;\n        }\n        res += ')\\n';\n    }\n    return res;\n}\nexports.printMatrix = printMatrix;\nfunction createUnitMatrix(value) {\n    return createMatrix([\n        value, 0, 0, 0,\n        0, value, 0, 0,\n        0, 0, value, 0,\n        0, 0, 0, value,\n    ]);\n}\nexports.createUnitMatrix = createUnitMatrix;\nfunction transposeMatrix(matrix) {\n    for (let j = 0; j < matrix.m; j++) {\n        for (let i = j + 1; i < matrix.n; i++) {\n            const temp = getMatrixValue(matrix, j, i);\n            setMatrixValue(matrix, j, i, getMatrixValue(matrix, i, j));\n            setMatrixValue(matrix, i, j, temp);\n        }\n    }\n    return matrix;\n}\nexports.transposeMatrix = transposeMatrix;\nfunction createPerspectiveMatrix(fov, aspect, near, far) {\n    const matrix = createUnitMatrix(0.0);\n    const tan = Math.tan(fov / 2);\n    setMatrixValue(matrix, 0, 0, 1 / (aspect * tan));\n    setMatrixValue(matrix, 1, 1, 1 / tan);\n    setMatrixValue(matrix, 2, 2, -((far + near) / (far - near)));\n    setMatrixValue(matrix, 2, 3, -1);\n    setMatrixValue(matrix, 3, 2, -(2 * (far * near) / (far - near)));\n    return matrix;\n}\nexports.createPerspectiveMatrix = createPerspectiveMatrix;\nfunction createTranslationMatrix(x, y, z) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 3, x);\n    setMatrixValue(matrix, 1, 3, y);\n    setMatrixValue(matrix, 2, 3, z);\n    return matrix;\n}\nexports.createTranslationMatrix = createTranslationMatrix;\nfunction createScaleMatrix(x, y, z) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 0, x);\n    setMatrixValue(matrix, 1, 1, y);\n    setMatrixValue(matrix, 2, 2, z);\n    return matrix;\n}\nexports.createScaleMatrix = createScaleMatrix;\nfunction createRotationMatrix(a, b, g) {\n    const matrix = createUnitMatrix(1.0);\n    setMatrixValue(matrix, 0, 0, Math.cos(a) * Math.cos(b));\n    setMatrixValue(matrix, 0, 1, Math.cos(a) * Math.sin(b) * Math.sin(g) - Math.sin(a) * Math.cos(g));\n    setMatrixValue(matrix, 0, 2, Math.cos(a) * Math.sin(b) * Math.cos(g) + Math.sin(a) * Math.sin(g));\n    setMatrixValue(matrix, 1, 0, Math.sin(a) * Math.cos(b));\n    setMatrixValue(matrix, 1, 1, Math.sin(a) * Math.sin(b) * Math.sin(g) + Math.cos(a) * Math.cos(g));\n    setMatrixValue(matrix, 1, 2, Math.sin(a) * Math.sin(b) * Math.cos(g) - Math.cos(a) * Math.sin(g));\n    setMatrixValue(matrix, 2, 0, -Math.sin(b));\n    setMatrixValue(matrix, 2, 1, Math.cos(b) * Math.sin(g));\n    setMatrixValue(matrix, 2, 2, Math.cos(b) * Math.cos(g));\n    return matrix;\n}\nexports.createRotationMatrix = createRotationMatrix;\nfunction multiplyMatrix(m1, m2) {\n    // m1.n x m2.m\n    let value = 0;\n    const src = createMatrix(new Array(m1.n * m2.m).fill(0), m1.n, m2.m);\n    for (let j = 0; j < m1.n; j++) {\n        for (let i = 0; i < m2.m; i++) {\n            value = 0;\n            for (let m = 0; m < m1.m; m++) {\n                value += getMatrixValue(m1, j, m) * getMatrixValue(m2, m, i);\n            }\n            setMatrixValue(src, j, i, value);\n        }\n    }\n    return src;\n}\nexports.multiplyMatrix = multiplyMatrix;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC9tYXRpeC50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxzQkFBc0IsR0FBRyw0QkFBNEIsR0FBRyx5QkFBeUIsR0FBRywrQkFBK0IsR0FBRywrQkFBK0IsR0FBRyx1QkFBdUIsR0FBRyx3QkFBd0IsR0FBRyxtQkFBbUIsR0FBRyxzQkFBc0IsR0FBRyxzQkFBc0IsR0FBRyxvQkFBb0IsR0FBRyxvQkFBb0I7QUFDaFU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0Esb0JBQW9CLGNBQWM7QUFDbEMsbUJBQW1CLDZCQUE2QjtBQUNoRCx3QkFBd0IsY0FBYztBQUN0Qyx1QkFBdUIsNkJBQTZCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBLG9CQUFvQixjQUFjO0FBQ2xDLDRCQUE0QixjQUFjO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUIsd0JBQXdCLFVBQVU7QUFDbEM7QUFDQSw0QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9tYXRoL21hdGl4LnRzPzQ4OTQiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLm11bHRpcGx5TWF0cml4ID0gZXhwb3J0cy5jcmVhdGVSb3RhdGlvbk1hdHJpeCA9IGV4cG9ydHMuY3JlYXRlU2NhbGVNYXRyaXggPSBleHBvcnRzLmNyZWF0ZVRyYW5zbGF0aW9uTWF0cml4ID0gZXhwb3J0cy5jcmVhdGVQZXJzcGVjdGl2ZU1hdHJpeCA9IGV4cG9ydHMudHJhbnNwb3NlTWF0cml4ID0gZXhwb3J0cy5jcmVhdGVVbml0TWF0cml4ID0gZXhwb3J0cy5wcmludE1hdHJpeCA9IGV4cG9ydHMuc2V0TWF0cml4VmFsdWUgPSBleHBvcnRzLmdldE1hdHJpeFZhbHVlID0gZXhwb3J0cy5nZXRSYXdWYWx1ZXMgPSBleHBvcnRzLmNyZWF0ZU1hdHJpeCA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWF0ZU1hdHJpeCh2YWx1ZXMsIG4gPSA0LCBtID0gNCkge1xuICAgIHJldHVybiAoe1xuICAgICAgICBuOiBuLFxuICAgICAgICBtOiBtLFxuICAgICAgICB2YWx1ZXM6IEZsb2F0MzJBcnJheS5mcm9tKHZhbHVlcy5zbGljZSgwLCBuICogbSkpXG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZU1hdHJpeCA9IGNyZWF0ZU1hdHJpeDtcbmZ1bmN0aW9uIGdldFJhd1ZhbHVlcyhtYXRyaXgpIHtcbiAgICByZXR1cm4gbWF0cml4LnZhbHVlcztcbn1cbmV4cG9ydHMuZ2V0UmF3VmFsdWVzID0gZ2V0UmF3VmFsdWVzO1xuZnVuY3Rpb24gZ2V0TWF0cml4VmFsdWUobWF0cml4LCBqLCBpKSB7XG4gICAgcmV0dXJuIG1hdHJpeC52YWx1ZXNbaSArIG1hdHJpeC5tICogal07XG59XG5leHBvcnRzLmdldE1hdHJpeFZhbHVlID0gZ2V0TWF0cml4VmFsdWU7XG5mdW5jdGlvbiBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGosIGksIHZhbHVlKSB7XG4gICAgbWF0cml4LnZhbHVlc1tpICsgbWF0cml4Lm0gKiBqXSA9IHZhbHVlO1xufVxuZXhwb3J0cy5zZXRNYXRyaXhWYWx1ZSA9IHNldE1hdHJpeFZhbHVlO1xuZnVuY3Rpb24gcHJpbnRNYXRyaXgobWF0cml4KSB7XG4gICAgbGV0IHJlcyA9ICcnO1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWF0cml4Lm47IGorKykge1xuICAgICAgICByZXMgKz0gYCgke2dldE1hdHJpeFZhbHVlKG1hdHJpeCwgaiwgMCl9YDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBtYXRyaXgubTsgaSsrKSB7XG4gICAgICAgICAgICByZXMgKz0gYHwke2dldE1hdHJpeFZhbHVlKG1hdHJpeCwgaiwgaSl9YDtcbiAgICAgICAgfVxuICAgICAgICByZXMgKz0gJylcXG4nO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xufVxuZXhwb3J0cy5wcmludE1hdHJpeCA9IHByaW50TWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlVW5pdE1hdHJpeCh2YWx1ZSkge1xuICAgIHJldHVybiBjcmVhdGVNYXRyaXgoW1xuICAgICAgICB2YWx1ZSwgMCwgMCwgMCxcbiAgICAgICAgMCwgdmFsdWUsIDAsIDAsXG4gICAgICAgIDAsIDAsIHZhbHVlLCAwLFxuICAgICAgICAwLCAwLCAwLCB2YWx1ZSxcbiAgICBdKTtcbn1cbmV4cG9ydHMuY3JlYXRlVW5pdE1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXg7XG5mdW5jdGlvbiB0cmFuc3Bvc2VNYXRyaXgobWF0cml4KSB7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBtYXRyaXgubTsgaisrKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBqICsgMTsgaSA8IG1hdHJpeC5uOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBnZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGosIGkpO1xuICAgICAgICAgICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCBqLCBpLCBnZXRNYXRyaXhWYWx1ZShtYXRyaXgsIGksIGopKTtcbiAgICAgICAgICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgaSwgaiwgdGVtcCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hdHJpeDtcbn1cbmV4cG9ydHMudHJhbnNwb3NlTWF0cml4ID0gdHJhbnNwb3NlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlUGVyc3BlY3RpdmVNYXRyaXgoZm92LCBhc3BlY3QsIG5lYXIsIGZhcikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMC4wKTtcbiAgICBjb25zdCB0YW4gPSBNYXRoLnRhbihmb3YgLyAyKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIDEgLyAoYXNwZWN0ICogdGFuKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAxLCAxLCAxIC8gdGFuKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDIsIC0oKGZhciArIG5lYXIpIC8gKGZhciAtIG5lYXIpKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAzLCAtMSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAzLCAyLCAtKDIgKiAoZmFyICogbmVhcikgLyAoZmFyIC0gbmVhcikpKTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVQZXJzcGVjdGl2ZU1hdHJpeCA9IGNyZWF0ZVBlcnNwZWN0aXZlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlVHJhbnNsYXRpb25NYXRyaXgoeCwgeSwgeikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDMsIHgpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMywgeSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAzLCB6KTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVUcmFuc2xhdGlvbk1hdHJpeCA9IGNyZWF0ZVRyYW5zbGF0aW9uTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlU2NhbGVNYXRyaXgoeCwgeSwgeikge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIHgpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMSwgeSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAyLCB6KTtcbiAgICByZXR1cm4gbWF0cml4O1xufVxuZXhwb3J0cy5jcmVhdGVTY2FsZU1hdHJpeCA9IGNyZWF0ZVNjYWxlTWF0cml4O1xuZnVuY3Rpb24gY3JlYXRlUm90YXRpb25NYXRyaXgoYSwgYiwgZykge1xuICAgIGNvbnN0IG1hdHJpeCA9IGNyZWF0ZVVuaXRNYXRyaXgoMS4wKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDAsIDAsIE1hdGguY29zKGEpICogTWF0aC5jb3MoYikpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMCwgMSwgTWF0aC5jb3MoYSkgKiBNYXRoLnNpbihiKSAqIE1hdGguc2luKGcpIC0gTWF0aC5zaW4oYSkgKiBNYXRoLmNvcyhnKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAwLCAyLCBNYXRoLmNvcyhhKSAqIE1hdGguc2luKGIpICogTWF0aC5jb3MoZykgKyBNYXRoLnNpbihhKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDEsIDAsIE1hdGguc2luKGEpICogTWF0aC5jb3MoYikpO1xuICAgIHNldE1hdHJpeFZhbHVlKG1hdHJpeCwgMSwgMSwgTWF0aC5zaW4oYSkgKiBNYXRoLnNpbihiKSAqIE1hdGguc2luKGcpICsgTWF0aC5jb3MoYSkgKiBNYXRoLmNvcyhnKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAxLCAyLCBNYXRoLnNpbihhKSAqIE1hdGguc2luKGIpICogTWF0aC5jb3MoZykgLSBNYXRoLmNvcyhhKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDAsIC1NYXRoLnNpbihiKSk7XG4gICAgc2V0TWF0cml4VmFsdWUobWF0cml4LCAyLCAxLCBNYXRoLmNvcyhiKSAqIE1hdGguc2luKGcpKTtcbiAgICBzZXRNYXRyaXhWYWx1ZShtYXRyaXgsIDIsIDIsIE1hdGguY29zKGIpICogTWF0aC5jb3MoZykpO1xuICAgIHJldHVybiBtYXRyaXg7XG59XG5leHBvcnRzLmNyZWF0ZVJvdGF0aW9uTWF0cml4ID0gY3JlYXRlUm90YXRpb25NYXRyaXg7XG5mdW5jdGlvbiBtdWx0aXBseU1hdHJpeChtMSwgbTIpIHtcbiAgICAvLyBtMS5uIHggbTIubVxuICAgIGxldCB2YWx1ZSA9IDA7XG4gICAgY29uc3Qgc3JjID0gY3JlYXRlTWF0cml4KG5ldyBBcnJheShtMS5uICogbTIubSkuZmlsbCgwKSwgbTEubiwgbTIubSk7XG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBtMS5uOyBqKyspIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtMi5tOyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IG0gPSAwOyBtIDwgbTEubTsgbSsrKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgKz0gZ2V0TWF0cml4VmFsdWUobTEsIGosIG0pICogZ2V0TWF0cml4VmFsdWUobTIsIG0sIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2V0TWF0cml4VmFsdWUoc3JjLCBqLCBpLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNyYztcbn1cbmV4cG9ydHMubXVsdGlwbHlNYXRyaXggPSBtdWx0aXBseU1hdHJpeDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/math/matix.ts\n");

/***/ }),

/***/ "./src/math/screen.ts":
/*!****************************!*\
  !*** ./src/math/screen.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.convertScreenCoordToWorldCoord = exports.getAngleFromLineProjection = exports.normalizeYCoord = exports.normalizeXCoord = void 0;\nconst utils_1 = __webpack_require__(/*! ./utils */ \"./src/math/utils.ts\");\nfunction normalizeXCoord(x, screenWidth) {\n    return ((x / screenWidth) * 2 - 1);\n}\nexports.normalizeXCoord = normalizeXCoord;\nfunction normalizeYCoord(y, screenHeight) {\n    return ((y / screenHeight) * 2 - 1) * -1;\n}\nexports.normalizeYCoord = normalizeYCoord;\nfunction getAngleFromLineProjection(projectionX, projectionY) {\n    let angel = (0, utils_1.toDegrees)(Math.atan(projectionY / projectionX));\n    if (projectionX < 0 && projectionY > 0) {\n        angel = 180 + angel;\n    }\n    if (projectionX < 0 && projectionY < 0) {\n        angel = 180 + angel;\n    }\n    if (projectionX > 0 && projectionY < 0) {\n        angel = 360 + angel;\n    }\n    angel = Math.abs(angel);\n    return angel;\n}\nexports.getAngleFromLineProjection = getAngleFromLineProjection;\nfunction convertScreenCoordToWorldCoord(coord, cameraPosition, paitingLayer, screenWidth, screenHeight, fovy, aspect) {\n    const offsetXNormalized = normalizeXCoord(coord.x, screenWidth);\n    const offsetYNormalized = normalizeYCoord(coord.y, screenHeight);\n    const tan = Math.tan(fovy / 2);\n    // TODO: use inverse projection matrix to calculate this\n    const projectCoefX = (aspect * tan * (-paitingLayer + cameraPosition.z));\n    const projectCoefY = (tan * (-paitingLayer + cameraPosition.z));\n    const startX = cameraPosition.x + (offsetXNormalized * projectCoefX);\n    const startY = cameraPosition.y + (offsetYNormalized * projectCoefY);\n    coord.x = startX;\n    coord.y = startY;\n}\nexports.convertScreenCoordToWorldCoord = convertScreenCoordToWorldCoord;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC9zY3JlZW4udHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsc0NBQXNDLEdBQUcsa0NBQWtDLEdBQUcsdUJBQXVCLEdBQUcsdUJBQXVCO0FBQy9ILGdCQUFnQixtQkFBTyxDQUFDLG9DQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QjtBQUN2QjtBQUNBO0FBQ0E7QUFDQSx1QkFBdUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvbWF0aC9zY3JlZW4udHM/ZGJhNSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY29udmVydFNjcmVlbkNvb3JkVG9Xb3JsZENvb3JkID0gZXhwb3J0cy5nZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbiA9IGV4cG9ydHMubm9ybWFsaXplWUNvb3JkID0gZXhwb3J0cy5ub3JtYWxpemVYQ29vcmQgPSB2b2lkIDA7XG5jb25zdCB1dGlsc18xID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5mdW5jdGlvbiBub3JtYWxpemVYQ29vcmQoeCwgc2NyZWVuV2lkdGgpIHtcbiAgICByZXR1cm4gKCh4IC8gc2NyZWVuV2lkdGgpICogMiAtIDEpO1xufVxuZXhwb3J0cy5ub3JtYWxpemVYQ29vcmQgPSBub3JtYWxpemVYQ29vcmQ7XG5mdW5jdGlvbiBub3JtYWxpemVZQ29vcmQoeSwgc2NyZWVuSGVpZ2h0KSB7XG4gICAgcmV0dXJuICgoeSAvIHNjcmVlbkhlaWdodCkgKiAyIC0gMSkgKiAtMTtcbn1cbmV4cG9ydHMubm9ybWFsaXplWUNvb3JkID0gbm9ybWFsaXplWUNvb3JkO1xuZnVuY3Rpb24gZ2V0QW5nbGVGcm9tTGluZVByb2plY3Rpb24ocHJvamVjdGlvblgsIHByb2plY3Rpb25ZKSB7XG4gICAgbGV0IGFuZ2VsID0gKDAsIHV0aWxzXzEudG9EZWdyZWVzKShNYXRoLmF0YW4ocHJvamVjdGlvblkgLyBwcm9qZWN0aW9uWCkpO1xuICAgIGlmIChwcm9qZWN0aW9uWCA8IDAgJiYgcHJvamVjdGlvblkgPiAwKSB7XG4gICAgICAgIGFuZ2VsID0gMTgwICsgYW5nZWw7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0aW9uWCA8IDAgJiYgcHJvamVjdGlvblkgPCAwKSB7XG4gICAgICAgIGFuZ2VsID0gMTgwICsgYW5nZWw7XG4gICAgfVxuICAgIGlmIChwcm9qZWN0aW9uWCA+IDAgJiYgcHJvamVjdGlvblkgPCAwKSB7XG4gICAgICAgIGFuZ2VsID0gMzYwICsgYW5nZWw7XG4gICAgfVxuICAgIGFuZ2VsID0gTWF0aC5hYnMoYW5nZWwpO1xuICAgIHJldHVybiBhbmdlbDtcbn1cbmV4cG9ydHMuZ2V0QW5nbGVGcm9tTGluZVByb2plY3Rpb24gPSBnZXRBbmdsZUZyb21MaW5lUHJvamVjdGlvbjtcbmZ1bmN0aW9uIGNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZChjb29yZCwgY2FtZXJhUG9zaXRpb24sIHBhaXRpbmdMYXllciwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCwgZm92eSwgYXNwZWN0KSB7XG4gICAgY29uc3Qgb2Zmc2V0WE5vcm1hbGl6ZWQgPSBub3JtYWxpemVYQ29vcmQoY29vcmQueCwgc2NyZWVuV2lkdGgpO1xuICAgIGNvbnN0IG9mZnNldFlOb3JtYWxpemVkID0gbm9ybWFsaXplWUNvb3JkKGNvb3JkLnksIHNjcmVlbkhlaWdodCk7XG4gICAgY29uc3QgdGFuID0gTWF0aC50YW4oZm92eSAvIDIpO1xuICAgIC8vIFRPRE86IHVzZSBpbnZlcnNlIHByb2plY3Rpb24gbWF0cml4IHRvIGNhbGN1bGF0ZSB0aGlzXG4gICAgY29uc3QgcHJvamVjdENvZWZYID0gKGFzcGVjdCAqIHRhbiAqICgtcGFpdGluZ0xheWVyICsgY2FtZXJhUG9zaXRpb24ueikpO1xuICAgIGNvbnN0IHByb2plY3RDb2VmWSA9ICh0YW4gKiAoLXBhaXRpbmdMYXllciArIGNhbWVyYVBvc2l0aW9uLnopKTtcbiAgICBjb25zdCBzdGFydFggPSBjYW1lcmFQb3NpdGlvbi54ICsgKG9mZnNldFhOb3JtYWxpemVkICogcHJvamVjdENvZWZYKTtcbiAgICBjb25zdCBzdGFydFkgPSBjYW1lcmFQb3NpdGlvbi55ICsgKG9mZnNldFlOb3JtYWxpemVkICogcHJvamVjdENvZWZZKTtcbiAgICBjb29yZC54ID0gc3RhcnRYO1xuICAgIGNvb3JkLnkgPSBzdGFydFk7XG59XG5leHBvcnRzLmNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZCA9IGNvbnZlcnRTY3JlZW5Db29yZFRvV29ybGRDb29yZDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/math/screen.ts\n");

/***/ }),

/***/ "./src/math/utils.ts":
/*!***************************!*\
  !*** ./src/math/utils.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.smootsptep = exports.clamp = exports.toDegrees = exports.toRadians = void 0;\nconst toRaduansCof = Math.PI / 180.0;\nfunction toRadians(angle) {\n    return angle * toRaduansCof;\n}\nexports.toRadians = toRadians;\nfunction toDegrees(angle) {\n    return angle / toRaduansCof;\n}\nexports.toDegrees = toDegrees;\nfunction clamp(n, l, u) {\n    return Math.min(Math.max(n, l), u);\n}\nexports.clamp = clamp;\nfunction smootsptep(edge0, edge1, x) {\n    let t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n    return t * t * (3.0 - 2.0 * t);\n}\nexports.smootsptep = smootsptep;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC91dGlscy50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxrQkFBa0IsR0FBRyxhQUFhLEdBQUcsaUJBQWlCLEdBQUcsaUJBQWlCO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvbWF0aC91dGlscy50cz8xMjgyIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5zbW9vdHNwdGVwID0gZXhwb3J0cy5jbGFtcCA9IGV4cG9ydHMudG9EZWdyZWVzID0gZXhwb3J0cy50b1JhZGlhbnMgPSB2b2lkIDA7XG5jb25zdCB0b1JhZHVhbnNDb2YgPSBNYXRoLlBJIC8gMTgwLjA7XG5mdW5jdGlvbiB0b1JhZGlhbnMoYW5nbGUpIHtcbiAgICByZXR1cm4gYW5nbGUgKiB0b1JhZHVhbnNDb2Y7XG59XG5leHBvcnRzLnRvUmFkaWFucyA9IHRvUmFkaWFucztcbmZ1bmN0aW9uIHRvRGVncmVlcyhhbmdsZSkge1xuICAgIHJldHVybiBhbmdsZSAvIHRvUmFkdWFuc0NvZjtcbn1cbmV4cG9ydHMudG9EZWdyZWVzID0gdG9EZWdyZWVzO1xuZnVuY3Rpb24gY2xhbXAobiwgbCwgdSkge1xuICAgIHJldHVybiBNYXRoLm1pbihNYXRoLm1heChuLCBsKSwgdSk7XG59XG5leHBvcnRzLmNsYW1wID0gY2xhbXA7XG5mdW5jdGlvbiBzbW9vdHNwdGVwKGVkZ2UwLCBlZGdlMSwgeCkge1xuICAgIGxldCB0ID0gY2xhbXAoKHggLSBlZGdlMCkgLyAoZWRnZTEgLSBlZGdlMCksIDAuMCwgMS4wKTtcbiAgICByZXR1cm4gdCAqIHQgKiAoMy4wIC0gMi4wICogdCk7XG59XG5leHBvcnRzLnNtb290c3B0ZXAgPSBzbW9vdHNwdGVwO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/math/utils.ts\n");

/***/ }),

/***/ "./src/math/vec.ts":
/*!*************************!*\
  !*** ./src/math/vec.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createVec4 = exports.createVec3 = exports.createVec2 = void 0;\nfunction createVec2(x, y) {\n    return ({\n        x, y\n    });\n}\nexports.createVec2 = createVec2;\nfunction createVec3(x, y, z) {\n    return ({\n        x, y, z\n    });\n}\nexports.createVec3 = createVec3;\nfunction createVec4(x, y, z, w) {\n    return ({\n        x, y, z, w\n    });\n}\nexports.createVec4 = createVec4;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvbWF0aC92ZWMudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0JBQWtCLEdBQUcsa0JBQWtCLEdBQUcsa0JBQWtCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esa0JBQWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL21hdGgvdmVjLnRzP2IyYzgiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmNyZWF0ZVZlYzQgPSBleHBvcnRzLmNyZWF0ZVZlYzMgPSBleHBvcnRzLmNyZWF0ZVZlYzIgPSB2b2lkIDA7XG5mdW5jdGlvbiBjcmVhdGVWZWMyKHgsIHkpIHtcbiAgICByZXR1cm4gKHtcbiAgICAgICAgeCwgeVxuICAgIH0pO1xufVxuZXhwb3J0cy5jcmVhdGVWZWMyID0gY3JlYXRlVmVjMjtcbmZ1bmN0aW9uIGNyZWF0ZVZlYzMoeCwgeSwgeikge1xuICAgIHJldHVybiAoe1xuICAgICAgICB4LCB5LCB6XG4gICAgfSk7XG59XG5leHBvcnRzLmNyZWF0ZVZlYzMgPSBjcmVhdGVWZWMzO1xuZnVuY3Rpb24gY3JlYXRlVmVjNCh4LCB5LCB6LCB3KSB7XG4gICAgcmV0dXJuICh7XG4gICAgICAgIHgsIHksIHosIHdcbiAgICB9KTtcbn1cbmV4cG9ydHMuY3JlYXRlVmVjNCA9IGNyZWF0ZVZlYzQ7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/math/vec.ts\n");

/***/ }),

/***/ "./src/render/components.ts":
/*!**********************************!*\
  !*** ./src/render/components.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createLine = void 0;\nfunction createLine(position, length, id) {\n    return ({\n        position,\n        length,\n        scale: 1.0,\n        rotate: 0.0,\n        line: -1,\n        id\n    });\n}\nexports.createLine = createLine;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2NvbXBvbmVudHMudHMuanMiLCJtYXBwaW5ncyI6IkFBQWE7QUFDYiw4Q0FBNkMsRUFBRSxhQUFhLEVBQUM7QUFDN0Qsa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxrQkFBa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvcmVuZGVyL2NvbXBvbmVudHMudHM/Y2JlYSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY3JlYXRlTGluZSA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWF0ZUxpbmUocG9zaXRpb24sIGxlbmd0aCwgaWQpIHtcbiAgICByZXR1cm4gKHtcbiAgICAgICAgcG9zaXRpb24sXG4gICAgICAgIGxlbmd0aCxcbiAgICAgICAgc2NhbGU6IDEuMCxcbiAgICAgICAgcm90YXRlOiAwLjAsXG4gICAgICAgIGxpbmU6IC0xLFxuICAgICAgICBpZFxuICAgIH0pO1xufVxuZXhwb3J0cy5jcmVhdGVMaW5lID0gY3JlYXRlTGluZTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/components.ts\n");

/***/ }),

/***/ "./src/render/const.ts":
/*!*****************************!*\
  !*** ./src/render/const.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.paitingLayer = void 0;\nexports.paitingLayer = -3.0;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2NvbnN0LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELG9CQUFvQjtBQUNwQixvQkFBb0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvcmVuZGVyL2NvbnN0LnRzPzVkMjciXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnBhaXRpbmdMYXllciA9IHZvaWQgMDtcbmV4cG9ydHMucGFpdGluZ0xheWVyID0gLTMuMDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/render/const.ts\n");

/***/ }),

/***/ "./src/render/gl-api.ts":
/*!******************************!*\
  !*** ./src/render/gl-api.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createGLShader = exports.creareGLProgram = void 0;\nfunction creareGLProgram(gl, vertShader, fragShader) {\n    const program = gl.createProgram();\n    gl.attachShader(program, createGLShader(gl, gl.VERTEX_SHADER, vertShader));\n    gl.attachShader(program, createGLShader(gl, gl.FRAGMENT_SHADER, fragShader));\n    gl.linkProgram(program);\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        const info = gl.getProgramInfoLog(program);\n        console.warn(`Fail to link program: ${info}`);\n        gl.deleteProgram(program);\n        return null;\n    }\n    return program;\n}\nexports.creareGLProgram = creareGLProgram;\nfunction createGLShader(gl, type, shaderSrc) {\n    const shader = gl.createShader(type);\n    if (shader === 0)\n        console.warn('Fail to create shader');\n    gl.shaderSource(shader, shaderSrc);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        const message = gl.getShaderInfoLog(shader);\n        console.warn(`Fail to compile shader: ${message}`);\n        gl.deleteShader(shader);\n        return null;\n    }\n    return shader;\n}\nexports.createGLShader = createGLShader;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL2dsLWFwaS50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxzQkFBc0IsR0FBRyx1QkFBdUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsS0FBSztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsUUFBUTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3JlbmRlci9nbC1hcGkudHM/M2M4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY3JlYXRlR0xTaGFkZXIgPSBleHBvcnRzLmNyZWFyZUdMUHJvZ3JhbSA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWFyZUdMUHJvZ3JhbShnbCwgdmVydFNoYWRlciwgZnJhZ1NoYWRlcikge1xuICAgIGNvbnN0IHByb2dyYW0gPSBnbC5jcmVhdGVQcm9ncmFtKCk7XG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGNyZWF0ZUdMU2hhZGVyKGdsLCBnbC5WRVJURVhfU0hBREVSLCB2ZXJ0U2hhZGVyKSk7XG4gICAgZ2wuYXR0YWNoU2hhZGVyKHByb2dyYW0sIGNyZWF0ZUdMU2hhZGVyKGdsLCBnbC5GUkFHTUVOVF9TSEFERVIsIGZyYWdTaGFkZXIpKTtcbiAgICBnbC5saW5rUHJvZ3JhbShwcm9ncmFtKTtcbiAgICBpZiAoIWdsLmdldFByb2dyYW1QYXJhbWV0ZXIocHJvZ3JhbSwgZ2wuTElOS19TVEFUVVMpKSB7XG4gICAgICAgIGNvbnN0IGluZm8gPSBnbC5nZXRQcm9ncmFtSW5mb0xvZyhwcm9ncmFtKTtcbiAgICAgICAgY29uc29sZS53YXJuKGBGYWlsIHRvIGxpbmsgcHJvZ3JhbTogJHtpbmZvfWApO1xuICAgICAgICBnbC5kZWxldGVQcm9ncmFtKHByb2dyYW0pO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIHByb2dyYW07XG59XG5leHBvcnRzLmNyZWFyZUdMUHJvZ3JhbSA9IGNyZWFyZUdMUHJvZ3JhbTtcbmZ1bmN0aW9uIGNyZWF0ZUdMU2hhZGVyKGdsLCB0eXBlLCBzaGFkZXJTcmMpIHtcbiAgICBjb25zdCBzaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIodHlwZSk7XG4gICAgaWYgKHNoYWRlciA9PT0gMClcbiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsIHRvIGNyZWF0ZSBzaGFkZXInKTtcbiAgICBnbC5zaGFkZXJTb3VyY2Uoc2hhZGVyLCBzaGFkZXJTcmMpO1xuICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcbiAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSkge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZ2wuZ2V0U2hhZGVySW5mb0xvZyhzaGFkZXIpO1xuICAgICAgICBjb25zb2xlLndhcm4oYEZhaWwgdG8gY29tcGlsZSBzaGFkZXI6ICR7bWVzc2FnZX1gKTtcbiAgICAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gc2hhZGVyO1xufVxuZXhwb3J0cy5jcmVhdGVHTFNoYWRlciA9IGNyZWF0ZUdMU2hhZGVyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/render/gl-api.ts\n");

/***/ }),

/***/ "./src/render/renderer.ts":
/*!********************************!*\
  !*** ./src/render/renderer.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.Renderer = exports.QUAD_WITH_TEXTURE_COORD_DATA = void 0;\nconst matix_1 = __webpack_require__(/*! ../math/matix */ \"./src/math/matix.ts\");\nconst const_1 = __webpack_require__(/*! ./const */ \"./src/render/const.ts\");\nconst gl_api_1 = __webpack_require__(/*! ./gl-api */ \"./src/render/gl-api.ts\");\nconst utils_1 = __webpack_require__(/*! ../math/utils */ \"./src/math/utils.ts\");\nconst line_vertex_glsl_1 = __webpack_require__(/*! ../assets/line-vertex.glsl */ \"./src/assets/line-vertex.glsl\");\nconst circle_vertex_glsl_1 = __webpack_require__(/*! ../assets/circle-vertex.glsl */ \"./src/assets/circle-vertex.glsl\");\nconst line_pixel_glsl_1 = __webpack_require__(/*! ../assets/line-pixel.glsl */ \"./src/assets/line-pixel.glsl\");\nconst circle_pixel_glsl_1 = __webpack_require__(/*! ../assets/circle-pixel.glsl */ \"./src/assets/circle-pixel.glsl\");\nconst texture_vertex_glsl_1 = __webpack_require__(/*! ../assets/texture-vertex.glsl */ \"./src/assets/texture-vertex.glsl\");\nconst texture_pixel_glsl_1 = __webpack_require__(/*! ../assets/texture-pixel.glsl */ \"./src/assets/texture-pixel.glsl\");\nconst dataPerVertex = 4;\nconst dataPerLine = dataPerVertex * 6;\nconst dataPerCircleVertex = 6;\nconst dataPerCircle = dataPerCircleVertex * 6;\nconst lineBufferSize = 10000;\nconst circleBufferSize = 100;\nexports.QUAD_WITH_TEXTURE_COORD_DATA = Float32Array.from([\n    // first triangle\n    -1.0, 1.0, 0.0,\n    0.0, 0.0,\n    1.0, 1.0, 0.0,\n    1.0, 0.0,\n    -1.0, -1.0, 0.0,\n    0.0, 1.0,\n    // second triangle\n    1.0, 1.0, 0.0,\n    1.0, 0.0,\n    1.0, -1.0, 0.0,\n    1.0, 1.0,\n    -1.0, -1.0, 0.0,\n    0.0, 1.0, // texCoord v2\n]);\nclass Renderer {\n    constructor(gl, screenWidth, screenHeight) {\n        this.gl = gl;\n        this.projection = null;\n        this.camera = null;\n        this.squreData = new Float32Array(lineBufferSize * dataPerLine);\n        this.circleData = new Float32Array(circleBufferSize * dataPerCircle);\n        this.squreCount = 0;\n        this.circleCount = 0;\n        this._flushedLine = 0;\n        this._flushedCircle = 0;\n        this._lastDrawedCircle = 0;\n        this.squreVBO = gl.createBuffer();\n        this.mainProgram = (0, gl_api_1.creareGLProgram)(gl, texture_vertex_glsl_1.default, texture_pixel_glsl_1.default);\n        this.mainVBO = gl.createBuffer();\n        this.squreProgram = (0, gl_api_1.creareGLProgram)(gl, line_vertex_glsl_1.default, line_pixel_glsl_1.default);\n        this.squreUniforms = {\n            modelViewLocation: gl.getUniformLocation(this.squreProgram, 'MV'),\n            modelLocation: gl.getUniformLocation(this.squreProgram, 'MM'),\n            projectionLocation: gl.getUniformLocation(this.squreProgram, 'P'),\n        };\n        this.circleVBO = gl.createBuffer();\n        this.circleProgram = (0, gl_api_1.creareGLProgram)(gl, circle_vertex_glsl_1.default, circle_pixel_glsl_1.default);\n        this.circleUniforms = {\n            modelViewLocation: gl.getUniformLocation(this.circleProgram, 'MV'),\n            modelLocation: gl.getUniformLocation(this.circleProgram, 'MM'),\n            projectionLocation: gl.getUniformLocation(this.circleProgram, 'P'),\n        };\n        gl.viewport(0, 0, screenWidth, screenHeight);\n        gl.enable(gl.DEPTH_TEST);\n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        gl.enable(gl.BLEND);\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n        const frameBuffer = gl.createFramebuffer();\n        const colorText = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, colorText);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 600, 400, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        const idText = gl.createTexture();\n        gl.bindTexture(gl.TEXTURE_2D, idText);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA8UI, 600, 400, 0, gl.RGBA_INTEGER, gl.UNSIGNED_BYTE, null);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        const rbo = gl.createRenderbuffer();\n        gl.bindRenderbuffer(gl.RENDERBUFFER, rbo);\n        gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH24_STENCIL8, 600, 400);\n        gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\n        gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, rbo);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, colorText, 0);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT1, gl.TEXTURE_2D, idText, 0);\n        this.gl.drawBuffers([\n            this.gl.COLOR_ATTACHMENT0,\n            this.gl.COLOR_ATTACHMENT1,\n        ]);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        this.framebuffer = frameBuffer;\n        this.colorTexture = colorText;\n        this.idTexture = idText;\n        gl.useProgram(this.mainProgram);\n        gl.uniform1i(gl.getUniformLocation(this.mainProgram, 'outTexture'), 0); //TODO: why can't use gl.TEXTURE0\n    }\n    beginScene(projection, camera) {\n        this._flushedLine = 0; // TODO: delete\n        this._flushedCircle = 0;\n        this._lastDrawedCircle = 0;\n        this.projection = projection;\n        this.camera = camera;\n        if (this.isDataNotFlushed()) {\n            console.warn('Render data was not flushed from prev scene');\n        }\n        this.squreCount = 0;\n        this.circleCount = 0;\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.framebuffer);\n        this.gl.clearBufferfv(this.gl.COLOR, 0, new Float32Array([0, 0, 0, 1.0]));\n        this.gl.clearBufferuiv(this.gl.COLOR, 1, new Uint32Array([0, 0, 0, 0]));\n        this.gl.clearBufferfi(this.gl.DEPTH_STENCIL, 0, 1.0, 0); // TODO: why depth = 1.0\n    }\n    drawLine(line) {\n        const lineLength = line.length;\n        const xProjection = (lineLength * Math.cos((0, utils_1.toRadians)(line.rotate)) / 2);\n        const yProjection = (lineLength * Math.sin((0, utils_1.toRadians)(line.rotate)) / 2);\n        const translate = (0, matix_1.createTranslationMatrix)(line.position.x + xProjection, line.position.y + yProjection, 0);\n        const rotate = (0, matix_1.createRotationMatrix)((0, utils_1.toRadians)(line.rotate), 0, 0);\n        const scale = (0, matix_1.createScaleMatrix)(lineLength, 0.1, 1.0);\n        this.drawSqure(translate, rotate, scale, line.id);\n    }\n    drawSqure(translate = null, rotate = null, scale = null, id) {\n        if (this.squreCount === lineBufferSize) {\n            let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n            this.flushSqure(modelMatrix);\n        }\n        let leftTop = (0, matix_1.createMatrix)([-0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let leftBottom = (0, matix_1.createMatrix)([-0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightTop = (0, matix_1.createMatrix)([0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightBottom = (0, matix_1.createMatrix)([0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        if (scale) {\n            leftTop = (0, matix_1.multiplyMatrix)(scale, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(scale, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(scale, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(scale, rightBottom);\n        }\n        if (rotate) {\n            leftTop = (0, matix_1.multiplyMatrix)(rotate, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(rotate, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(rotate, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(rotate, rightBottom);\n        }\n        if (translate) {\n            leftTop = (0, matix_1.multiplyMatrix)(translate, leftTop);\n            leftBottom = (0, matix_1.multiplyMatrix)(translate, leftBottom);\n            rightTop = (0, matix_1.multiplyMatrix)(translate, rightTop);\n            rightBottom = (0, matix_1.multiplyMatrix)(translate, rightBottom);\n        }\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 0 + 0] = (0, matix_1.getMatrixValue)(leftTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 0 + 1] = (0, matix_1.getMatrixValue)(leftTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 0 + 2] = (0, matix_1.getMatrixValue)(leftTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 0 + 3] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 1 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 1 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 1 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 1 + 3] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 2 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 2 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 2 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 2 + 3] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 3 + 0] = (0, matix_1.getMatrixValue)(rightBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 3 + 1] = (0, matix_1.getMatrixValue)(rightBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 3 + 2] = (0, matix_1.getMatrixValue)(rightBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 3 + 3] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 4 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 4 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 4 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 4 + 3] = id;\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 5 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 5 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 5 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.squreData[this.squreCount * dataPerLine + dataPerVertex * 5 + 3] = id;\n        this.squreCount += 1;\n    }\n    drawCircle(circle) {\n        if (this.circleCount === circleBufferSize) {\n            let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n            this.flushCircle(modelMatrix);\n        }\n        let leftTop = (0, matix_1.createMatrix)([-0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let leftBottom = (0, matix_1.createMatrix)([-0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightTop = (0, matix_1.createMatrix)([0.5, 0.5, const_1.paitingLayer, 1.0], 4, 1);\n        let rightBottom = (0, matix_1.createMatrix)([0.5, -0.5, const_1.paitingLayer, 1.0], 4, 1);\n        const translate = (0, matix_1.createTranslationMatrix)(circle.position.x, circle.position.y, 0);\n        // const rotate = createRotationMatrix(0, 0, 0);\n        const scale = (0, matix_1.createScaleMatrix)(circle.radius * 2, circle.radius * 2, 1.0);\n        leftTop = (0, matix_1.multiplyMatrix)(scale, leftTop);\n        leftBottom = (0, matix_1.multiplyMatrix)(scale, leftBottom);\n        rightTop = (0, matix_1.multiplyMatrix)(scale, rightTop);\n        rightBottom = (0, matix_1.multiplyMatrix)(scale, rightBottom);\n        // leftTop =  multiplyMatrix(rotate, leftTop);\n        // leftBottom = multiplyMatrix(rotate, leftBottom);\n        // rightTop =  multiplyMatrix(rotate, rightTop);\n        // rightBottom = multiplyMatrix(rotate, rightBottom);\n        leftTop = (0, matix_1.multiplyMatrix)(translate, leftTop);\n        leftBottom = (0, matix_1.multiplyMatrix)(translate, leftBottom);\n        rightTop = (0, matix_1.multiplyMatrix)(translate, rightTop);\n        rightBottom = (0, matix_1.multiplyMatrix)(translate, rightBottom);\n        const dataPerVertex = 6;\n        const id = circle.id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 0] = (0, matix_1.getMatrixValue)(leftTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 1] = (0, matix_1.getMatrixValue)(leftTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 2] = (0, matix_1.getMatrixValue)(leftTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 3] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 4] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 0 + 5] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 3] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 4] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 1 + 5] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 3] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 4] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 2 + 5] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 0] = (0, matix_1.getMatrixValue)(rightBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 1] = (0, matix_1.getMatrixValue)(rightBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 2] = (0, matix_1.getMatrixValue)(rightBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 3] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 4] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 3 + 5] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 0] = (0, matix_1.getMatrixValue)(rightTop, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 1] = (0, matix_1.getMatrixValue)(rightTop, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 2] = (0, matix_1.getMatrixValue)(rightTop, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 3] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 4] = 1.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 4 + 5] = id;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 0] = (0, matix_1.getMatrixValue)(leftBottom, 0, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 1] = (0, matix_1.getMatrixValue)(leftBottom, 1, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 2] = (0, matix_1.getMatrixValue)(leftBottom, 2, 0);\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 3] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 4] = 0.0;\n        this.circleData[this.circleCount * dataPerCircle + dataPerVertex * 5 + 5] = id;\n        this.circleCount += 1;\n    }\n    endScene() {\n        this.flush();\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\n        this.gl.useProgram(this.mainProgram);\n        this.gl.activeTexture(this.gl.TEXTURE0);\n        this.gl.bindTexture(this.gl.TEXTURE_2D, this.colorTexture);\n        this.gl.activeTexture(this.gl.TEXTURE1);\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.mainVBO);\n        this.gl.bufferData(this.gl.ARRAY_BUFFER, exports.QUAD_WITH_TEXTURE_COORD_DATA, this.gl.STATIC_DRAW);\n        this.gl.vertexAttribPointer(0, 3, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * 5, 0);\n        this.gl.enableVertexAttribArray(0);\n        this.gl.vertexAttribPointer(1, 2, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * 5, Float32Array.BYTES_PER_ELEMENT * 3);\n        this.gl.enableVertexAttribArray(1);\n        this.gl.drawArrays(this.gl.TRIANGLES, 0, exports.QUAD_WITH_TEXTURE_COORD_DATA.length);\n        this.projection = null;\n        this.camera = null;\n        this.squreCount = 0;\n        this.circleCount = 0;\n        // console.log('flush squre count', flushLine);\n        // console.log('flush circle count', flushCircle);\n    }\n    flush() {\n        let modelMatrix = (0, matix_1.transposeMatrix)((0, matix_1.createUnitMatrix)(1.0));\n        this.flushSqure(modelMatrix);\n        this.flushCircle(modelMatrix);\n    }\n    getIdDataReader() {\n        const gl = this.gl;\n        const readPixels = (x, y, width, height) => {\n            this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, this.framebuffer);\n            const b = new Uint8Array(width * height * 4);\n            gl.readBuffer(gl.COLOR_ATTACHMENT1);\n            gl.readPixels(x, y, width, height, gl.RGBA_INTEGER, gl.UNSIGNED_BYTE, b);\n            this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\n            return b;\n        };\n        return { readBuffer: () => readPixels(0, 0, 600, 400), readPixel: (x, y) => readPixels(x, y, 1, 1) };\n    }\n    flushSqure(modelMatrix) {\n        if (this.squreCount !== 0) {\n            this._flushedLine += 1;\n            this.gl.useProgram(this.squreProgram);\n            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.squreVBO);\n            this.gl.bufferData(this.gl.ARRAY_BUFFER, this.squreData, this.gl.STATIC_DRAW);\n            this.gl.vertexAttribPointer(0, 3, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * dataPerVertex, 0);\n            this.gl.enableVertexAttribArray(0);\n            this.gl.vertexAttribPointer(1, 1, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * dataPerVertex, Float32Array.BYTES_PER_ELEMENT * 3);\n            this.gl.enableVertexAttribArray(1);\n            if (this.camera) {\n                this.gl.uniformMatrix4fv(this.squreUniforms.modelViewLocation, false, (0, matix_1.getRawValues)(this.camera));\n            }\n            this.gl.uniformMatrix4fv(this.squreUniforms.modelLocation, false, (0, matix_1.getRawValues)(modelMatrix));\n            if (this.projection) {\n                this.gl.uniformMatrix4fv(this.squreUniforms.projectionLocation, false, (0, matix_1.getRawValues)(this.projection));\n            }\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.squreCount * 6);\n        }\n        this.squreCount = 0;\n    }\n    flushCircle(modelMatrix) {\n        if (this.circleCount !== 0) {\n            this._flushedCircle += 1;\n            this._lastDrawedCircle = this.circleCount;\n            this.gl.useProgram(this.circleProgram);\n            this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.circleVBO);\n            this.gl.bufferData(this.gl.ARRAY_BUFFER, this.circleData, this.gl.STATIC_DRAW);\n            this.gl.vertexAttribPointer(0, 3, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * dataPerCircleVertex, 0);\n            this.gl.enableVertexAttribArray(0);\n            this.gl.vertexAttribPointer(1, 2, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * dataPerCircleVertex, Float32Array.BYTES_PER_ELEMENT * 3);\n            this.gl.enableVertexAttribArray(1);\n            this.gl.vertexAttribPointer(2, 1, this.gl.FLOAT, false, Float32Array.BYTES_PER_ELEMENT * dataPerCircleVertex, Float32Array.BYTES_PER_ELEMENT * 5);\n            this.gl.enableVertexAttribArray(2);\n            if (this.camera) {\n                this.gl.uniformMatrix4fv(this.circleUniforms.modelViewLocation, false, (0, matix_1.getRawValues)(this.camera));\n            }\n            this.gl.uniformMatrix4fv(this.circleUniforms.modelLocation, false, (0, matix_1.getRawValues)(modelMatrix));\n            if (this.projection) {\n                this.gl.uniformMatrix4fv(this.circleUniforms.projectionLocation, false, (0, matix_1.getRawValues)(this.projection));\n            }\n            this.gl.drawArrays(this.gl.TRIANGLES, 0, this.circleCount * 6);\n        }\n        this.circleCount = 0;\n    }\n    getDrawStat() {\n        return { circleFlushed: this._flushedCircle, drawedCircles: this._lastDrawedCircle + Math.max(0, this._flushedCircle - 1) * circleBufferSize };\n    }\n    isDataNotFlushed() {\n        return this.squreCount !== 0 || this.circleCount !== 0;\n    }\n}\nexports.Renderer = Renderer;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcmVuZGVyL3JlbmRlcmVyLnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELGdCQUFnQixHQUFHLG9DQUFvQztBQUN2RCxnQkFBZ0IsbUJBQU8sQ0FBQywwQ0FBZTtBQUN2QyxnQkFBZ0IsbUJBQU8sQ0FBQyxzQ0FBUztBQUNqQyxpQkFBaUIsbUJBQU8sQ0FBQyx3Q0FBVTtBQUNuQyxnQkFBZ0IsbUJBQU8sQ0FBQywwQ0FBZTtBQUN2QywyQkFBMkIsbUJBQU8sQ0FBQyxpRUFBNEI7QUFDL0QsNkJBQTZCLG1CQUFPLENBQUMscUVBQThCO0FBQ25FLDBCQUEwQixtQkFBTyxDQUFDLCtEQUEyQjtBQUM3RCw0QkFBNEIsbUJBQU8sQ0FBQyxtRUFBNkI7QUFDakUsOEJBQThCLG1CQUFPLENBQUMsdUVBQStCO0FBQ3JFLDZCQUE2QixtQkFBTyxDQUFDLHFFQUE4QjtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGO0FBQ2hGO0FBQ0E7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQiIsInNvdXJjZXMiOlsid2VicGFjazovL2RyYXdlci8uL3NyYy9yZW5kZXIvcmVuZGVyZXIudHM/YzhjZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuUmVuZGVyZXIgPSBleHBvcnRzLlFVQURfV0lUSF9URVhUVVJFX0NPT1JEX0RBVEEgPSB2b2lkIDA7XG5jb25zdCBtYXRpeF8xID0gcmVxdWlyZShcIi4uL21hdGgvbWF0aXhcIik7XG5jb25zdCBjb25zdF8xID0gcmVxdWlyZShcIi4vY29uc3RcIik7XG5jb25zdCBnbF9hcGlfMSA9IHJlcXVpcmUoXCIuL2dsLWFwaVwiKTtcbmNvbnN0IHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vbWF0aC91dGlsc1wiKTtcbmNvbnN0IGxpbmVfdmVydGV4X2dsc2xfMSA9IHJlcXVpcmUoXCIuLi9hc3NldHMvbGluZS12ZXJ0ZXguZ2xzbFwiKTtcbmNvbnN0IGNpcmNsZV92ZXJ0ZXhfZ2xzbF8xID0gcmVxdWlyZShcIi4uL2Fzc2V0cy9jaXJjbGUtdmVydGV4Lmdsc2xcIik7XG5jb25zdCBsaW5lX3BpeGVsX2dsc2xfMSA9IHJlcXVpcmUoXCIuLi9hc3NldHMvbGluZS1waXhlbC5nbHNsXCIpO1xuY29uc3QgY2lyY2xlX3BpeGVsX2dsc2xfMSA9IHJlcXVpcmUoXCIuLi9hc3NldHMvY2lyY2xlLXBpeGVsLmdsc2xcIik7XG5jb25zdCB0ZXh0dXJlX3ZlcnRleF9nbHNsXzEgPSByZXF1aXJlKFwiLi4vYXNzZXRzL3RleHR1cmUtdmVydGV4Lmdsc2xcIik7XG5jb25zdCB0ZXh0dXJlX3BpeGVsX2dsc2xfMSA9IHJlcXVpcmUoXCIuLi9hc3NldHMvdGV4dHVyZS1waXhlbC5nbHNsXCIpO1xuY29uc3QgZGF0YVBlclZlcnRleCA9IDQ7XG5jb25zdCBkYXRhUGVyTGluZSA9IGRhdGFQZXJWZXJ0ZXggKiA2O1xuY29uc3QgZGF0YVBlckNpcmNsZVZlcnRleCA9IDY7XG5jb25zdCBkYXRhUGVyQ2lyY2xlID0gZGF0YVBlckNpcmNsZVZlcnRleCAqIDY7XG5jb25zdCBsaW5lQnVmZmVyU2l6ZSA9IDEwMDAwO1xuY29uc3QgY2lyY2xlQnVmZmVyU2l6ZSA9IDEwMDtcbmV4cG9ydHMuUVVBRF9XSVRIX1RFWFRVUkVfQ09PUkRfREFUQSA9IEZsb2F0MzJBcnJheS5mcm9tKFtcbiAgICAvLyBmaXJzdCB0cmlhbmdsZVxuICAgIC0xLjAsIDEuMCwgMC4wLFxuICAgIDAuMCwgMC4wLFxuICAgIDEuMCwgMS4wLCAwLjAsXG4gICAgMS4wLCAwLjAsXG4gICAgLTEuMCwgLTEuMCwgMC4wLFxuICAgIDAuMCwgMS4wLFxuICAgIC8vIHNlY29uZCB0cmlhbmdsZVxuICAgIDEuMCwgMS4wLCAwLjAsXG4gICAgMS4wLCAwLjAsXG4gICAgMS4wLCAtMS4wLCAwLjAsXG4gICAgMS4wLCAxLjAsXG4gICAgLTEuMCwgLTEuMCwgMC4wLFxuICAgIDAuMCwgMS4wLCAvLyB0ZXhDb29yZCB2MlxuXSk7XG5jbGFzcyBSZW5kZXJlciB7XG4gICAgY29uc3RydWN0b3IoZ2wsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpIHtcbiAgICAgICAgdGhpcy5nbCA9IGdsO1xuICAgICAgICB0aGlzLnByb2plY3Rpb24gPSBudWxsO1xuICAgICAgICB0aGlzLmNhbWVyYSA9IG51bGw7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhID0gbmV3IEZsb2F0MzJBcnJheShsaW5lQnVmZmVyU2l6ZSAqIGRhdGFQZXJMaW5lKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhID0gbmV3IEZsb2F0MzJBcnJheShjaXJjbGVCdWZmZXJTaXplICogZGF0YVBlckNpcmNsZSk7XG4gICAgICAgIHRoaXMuc3F1cmVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuY2lyY2xlQ291bnQgPSAwO1xuICAgICAgICB0aGlzLl9mbHVzaGVkTGluZSA9IDA7XG4gICAgICAgIHRoaXMuX2ZsdXNoZWRDaXJjbGUgPSAwO1xuICAgICAgICB0aGlzLl9sYXN0RHJhd2VkQ2lyY2xlID0gMDtcbiAgICAgICAgdGhpcy5zcXVyZVZCTyA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xuICAgICAgICB0aGlzLm1haW5Qcm9ncmFtID0gKDAsIGdsX2FwaV8xLmNyZWFyZUdMUHJvZ3JhbSkoZ2wsIHRleHR1cmVfdmVydGV4X2dsc2xfMS5kZWZhdWx0LCB0ZXh0dXJlX3BpeGVsX2dsc2xfMS5kZWZhdWx0KTtcbiAgICAgICAgdGhpcy5tYWluVkJPID0gZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgIHRoaXMuc3F1cmVQcm9ncmFtID0gKDAsIGdsX2FwaV8xLmNyZWFyZUdMUHJvZ3JhbSkoZ2wsIGxpbmVfdmVydGV4X2dsc2xfMS5kZWZhdWx0LCBsaW5lX3BpeGVsX2dsc2xfMS5kZWZhdWx0KTtcbiAgICAgICAgdGhpcy5zcXVyZVVuaWZvcm1zID0ge1xuICAgICAgICAgICAgbW9kZWxWaWV3TG9jYXRpb246IGdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLnNxdXJlUHJvZ3JhbSwgJ01WJyksXG4gICAgICAgICAgICBtb2RlbExvY2F0aW9uOiBnbC5nZXRVbmlmb3JtTG9jYXRpb24odGhpcy5zcXVyZVByb2dyYW0sICdNTScpLFxuICAgICAgICAgICAgcHJvamVjdGlvbkxvY2F0aW9uOiBnbC5nZXRVbmlmb3JtTG9jYXRpb24odGhpcy5zcXVyZVByb2dyYW0sICdQJyksXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuY2lyY2xlVkJPID0gZ2wuY3JlYXRlQnVmZmVyKCk7XG4gICAgICAgIHRoaXMuY2lyY2xlUHJvZ3JhbSA9ICgwLCBnbF9hcGlfMS5jcmVhcmVHTFByb2dyYW0pKGdsLCBjaXJjbGVfdmVydGV4X2dsc2xfMS5kZWZhdWx0LCBjaXJjbGVfcGl4ZWxfZ2xzbF8xLmRlZmF1bHQpO1xuICAgICAgICB0aGlzLmNpcmNsZVVuaWZvcm1zID0ge1xuICAgICAgICAgICAgbW9kZWxWaWV3TG9jYXRpb246IGdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLmNpcmNsZVByb2dyYW0sICdNVicpLFxuICAgICAgICAgICAgbW9kZWxMb2NhdGlvbjogZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHRoaXMuY2lyY2xlUHJvZ3JhbSwgJ01NJyksXG4gICAgICAgICAgICBwcm9qZWN0aW9uTG9jYXRpb246IGdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLmNpcmNsZVByb2dyYW0sICdQJyksXG4gICAgICAgIH07XG4gICAgICAgIGdsLnZpZXdwb3J0KDAsIDAsIHNjcmVlbldpZHRoLCBzY3JlZW5IZWlnaHQpO1xuICAgICAgICBnbC5lbmFibGUoZ2wuREVQVEhfVEVTVCk7XG4gICAgICAgIGdsLmNsZWFyQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKTtcbiAgICAgICAgZ2wuZW5hYmxlKGdsLkJMRU5EKTtcbiAgICAgICAgZ2wuYmxlbmRGdW5jKGdsLlNSQ19BTFBIQSwgZ2wuT05FX01JTlVTX1NSQ19BTFBIQSk7XG4gICAgICAgIGNvbnN0IGZyYW1lQnVmZmVyID0gZ2wuY3JlYXRlRnJhbWVidWZmZXIoKTtcbiAgICAgICAgY29uc3QgY29sb3JUZXh0ID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xuICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBjb2xvclRleHQpO1xuICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkEsIDYwMCwgNDAwLCAwLCBnbC5SR0JBLCBnbC5VTlNJR05FRF9CWVRFLCBudWxsKTtcbiAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01JTl9GSUxURVIsIGdsLkxJTkVBUik7XG4gICAgICAgIGdsLnRleFBhcmFtZXRlcmkoZ2wuVEVYVFVSRV8yRCwgZ2wuVEVYVFVSRV9NQUdfRklMVEVSLCBnbC5MSU5FQVIpO1xuICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBudWxsKTtcbiAgICAgICAgY29uc3QgaWRUZXh0ID0gZ2wuY3JlYXRlVGV4dHVyZSgpO1xuICAgICAgICBnbC5iaW5kVGV4dHVyZShnbC5URVhUVVJFXzJELCBpZFRleHQpO1xuICAgICAgICBnbC50ZXhJbWFnZTJEKGdsLlRFWFRVUkVfMkQsIDAsIGdsLlJHQkE4VUksIDYwMCwgNDAwLCAwLCBnbC5SR0JBX0lOVEVHRVIsIGdsLlVOU0lHTkVEX0JZVEUsIG51bGwpO1xuICAgICAgICBnbC50ZXhQYXJhbWV0ZXJpKGdsLlRFWFRVUkVfMkQsIGdsLlRFWFRVUkVfTUlOX0ZJTFRFUiwgZ2wuTElORUFSKTtcbiAgICAgICAgZ2wudGV4UGFyYW1ldGVyaShnbC5URVhUVVJFXzJELCBnbC5URVhUVVJFX01BR19GSUxURVIsIGdsLkxJTkVBUik7XG4gICAgICAgIGdsLmJpbmRUZXh0dXJlKGdsLlRFWFRVUkVfMkQsIG51bGwpO1xuICAgICAgICBjb25zdCByYm8gPSBnbC5jcmVhdGVSZW5kZXJidWZmZXIoKTtcbiAgICAgICAgZ2wuYmluZFJlbmRlcmJ1ZmZlcihnbC5SRU5ERVJCVUZGRVIsIHJibyk7XG4gICAgICAgIGdsLnJlbmRlcmJ1ZmZlclN0b3JhZ2UoZ2wuUkVOREVSQlVGRkVSLCBnbC5ERVBUSDI0X1NURU5DSUw4LCA2MDAsIDQwMCk7XG4gICAgICAgIGdsLmJpbmRSZW5kZXJidWZmZXIoZ2wuUkVOREVSQlVGRkVSLCBudWxsKTtcbiAgICAgICAgZ2wuYmluZEZyYW1lYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBmcmFtZUJ1ZmZlcik7XG4gICAgICAgIGdsLmZyYW1lYnVmZmVyUmVuZGVyYnVmZmVyKGdsLkZSQU1FQlVGRkVSLCBnbC5ERVBUSF9TVEVOQ0lMX0FUVEFDSE1FTlQsIGdsLlJFTkRFUkJVRkZFUiwgcmJvKTtcbiAgICAgICAgZ2wuZnJhbWVidWZmZXJUZXh0dXJlMkQoZ2wuRlJBTUVCVUZGRVIsIGdsLkNPTE9SX0FUVEFDSE1FTlQwLCBnbC5URVhUVVJFXzJELCBjb2xvclRleHQsIDApO1xuICAgICAgICBnbC5mcmFtZWJ1ZmZlclRleHR1cmUyRChnbC5GUkFNRUJVRkZFUiwgZ2wuQ09MT1JfQVRUQUNITUVOVDEsIGdsLlRFWFRVUkVfMkQsIGlkVGV4dCwgMCk7XG4gICAgICAgIHRoaXMuZ2wuZHJhd0J1ZmZlcnMoW1xuICAgICAgICAgICAgdGhpcy5nbC5DT0xPUl9BVFRBQ0hNRU5UMCxcbiAgICAgICAgICAgIHRoaXMuZ2wuQ09MT1JfQVRUQUNITUVOVDEsXG4gICAgICAgIF0pO1xuICAgICAgICBnbC5iaW5kRnJhbWVidWZmZXIoZ2wuRlJBTUVCVUZGRVIsIG51bGwpO1xuICAgICAgICB0aGlzLmZyYW1lYnVmZmVyID0gZnJhbWVCdWZmZXI7XG4gICAgICAgIHRoaXMuY29sb3JUZXh0dXJlID0gY29sb3JUZXh0O1xuICAgICAgICB0aGlzLmlkVGV4dHVyZSA9IGlkVGV4dDtcbiAgICAgICAgZ2wudXNlUHJvZ3JhbSh0aGlzLm1haW5Qcm9ncmFtKTtcbiAgICAgICAgZ2wudW5pZm9ybTFpKGdsLmdldFVuaWZvcm1Mb2NhdGlvbih0aGlzLm1haW5Qcm9ncmFtLCAnb3V0VGV4dHVyZScpLCAwKTsgLy9UT0RPOiB3aHkgY2FuJ3QgdXNlIGdsLlRFWFRVUkUwXG4gICAgfVxuICAgIGJlZ2luU2NlbmUocHJvamVjdGlvbiwgY2FtZXJhKSB7XG4gICAgICAgIHRoaXMuX2ZsdXNoZWRMaW5lID0gMDsgLy8gVE9ETzogZGVsZXRlXG4gICAgICAgIHRoaXMuX2ZsdXNoZWRDaXJjbGUgPSAwO1xuICAgICAgICB0aGlzLl9sYXN0RHJhd2VkQ2lyY2xlID0gMDtcbiAgICAgICAgdGhpcy5wcm9qZWN0aW9uID0gcHJvamVjdGlvbjtcbiAgICAgICAgdGhpcy5jYW1lcmEgPSBjYW1lcmE7XG4gICAgICAgIGlmICh0aGlzLmlzRGF0YU5vdEZsdXNoZWQoKSkge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdSZW5kZXIgZGF0YSB3YXMgbm90IGZsdXNoZWQgZnJvbSBwcmV2IHNjZW5lJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcXVyZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCA9IDA7XG4gICAgICAgIHRoaXMuZ2wuYmluZEZyYW1lYnVmZmVyKHRoaXMuZ2wuRlJBTUVCVUZGRVIsIHRoaXMuZnJhbWVidWZmZXIpO1xuICAgICAgICB0aGlzLmdsLmNsZWFyQnVmZmVyZnYodGhpcy5nbC5DT0xPUiwgMCwgbmV3IEZsb2F0MzJBcnJheShbMCwgMCwgMCwgMS4wXSkpO1xuICAgICAgICB0aGlzLmdsLmNsZWFyQnVmZmVydWl2KHRoaXMuZ2wuQ09MT1IsIDEsIG5ldyBVaW50MzJBcnJheShbMCwgMCwgMCwgMF0pKTtcbiAgICAgICAgdGhpcy5nbC5jbGVhckJ1ZmZlcmZpKHRoaXMuZ2wuREVQVEhfU1RFTkNJTCwgMCwgMS4wLCAwKTsgLy8gVE9ETzogd2h5IGRlcHRoID0gMS4wXG4gICAgfVxuICAgIGRyYXdMaW5lKGxpbmUpIHtcbiAgICAgICAgY29uc3QgbGluZUxlbmd0aCA9IGxpbmUubGVuZ3RoO1xuICAgICAgICBjb25zdCB4UHJvamVjdGlvbiA9IChsaW5lTGVuZ3RoICogTWF0aC5jb3MoKDAsIHV0aWxzXzEudG9SYWRpYW5zKShsaW5lLnJvdGF0ZSkpIC8gMik7XG4gICAgICAgIGNvbnN0IHlQcm9qZWN0aW9uID0gKGxpbmVMZW5ndGggKiBNYXRoLnNpbigoMCwgdXRpbHNfMS50b1JhZGlhbnMpKGxpbmUucm90YXRlKSkgLyAyKTtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlID0gKDAsIG1hdGl4XzEuY3JlYXRlVHJhbnNsYXRpb25NYXRyaXgpKGxpbmUucG9zaXRpb24ueCArIHhQcm9qZWN0aW9uLCBsaW5lLnBvc2l0aW9uLnkgKyB5UHJvamVjdGlvbiwgMCk7XG4gICAgICAgIGNvbnN0IHJvdGF0ZSA9ICgwLCBtYXRpeF8xLmNyZWF0ZVJvdGF0aW9uTWF0cml4KSgoMCwgdXRpbHNfMS50b1JhZGlhbnMpKGxpbmUucm90YXRlKSwgMCwgMCk7XG4gICAgICAgIGNvbnN0IHNjYWxlID0gKDAsIG1hdGl4XzEuY3JlYXRlU2NhbGVNYXRyaXgpKGxpbmVMZW5ndGgsIDAuMSwgMS4wKTtcbiAgICAgICAgdGhpcy5kcmF3U3F1cmUodHJhbnNsYXRlLCByb3RhdGUsIHNjYWxlLCBsaW5lLmlkKTtcbiAgICB9XG4gICAgZHJhd1NxdXJlKHRyYW5zbGF0ZSA9IG51bGwsIHJvdGF0ZSA9IG51bGwsIHNjYWxlID0gbnVsbCwgaWQpIHtcbiAgICAgICAgaWYgKHRoaXMuc3F1cmVDb3VudCA9PT0gbGluZUJ1ZmZlclNpemUpIHtcbiAgICAgICAgICAgIGxldCBtb2RlbE1hdHJpeCA9ICgwLCBtYXRpeF8xLnRyYW5zcG9zZU1hdHJpeCkoKDAsIG1hdGl4XzEuY3JlYXRlVW5pdE1hdHJpeCkoMS4wKSk7XG4gICAgICAgICAgICB0aGlzLmZsdXNoU3F1cmUobW9kZWxNYXRyaXgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBsZWZ0VG9wID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgMC41LCBjb25zdF8xLnBhaXRpbmdMYXllciwgMS4wXSwgNCwgMSk7XG4gICAgICAgIGxldCBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgLTAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIDAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIC0wLjUsIGNvbnN0XzEucGFpdGluZ0xheWVyLCAxLjBdLCA0LCAxKTtcbiAgICAgICAgaWYgKHNjYWxlKSB7XG4gICAgICAgICAgICBsZWZ0VG9wID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCBsZWZ0VG9wKTtcbiAgICAgICAgICAgIGxlZnRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIGxlZnRCb3R0b20pO1xuICAgICAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgICAgIHJpZ2h0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJvdGF0ZSkge1xuICAgICAgICAgICAgbGVmdFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIGxlZnRUb3ApO1xuICAgICAgICAgICAgbGVmdEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIGxlZnRCb3R0b20pO1xuICAgICAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkocm90YXRlLCByaWdodFRvcCk7XG4gICAgICAgICAgICByaWdodEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KShyb3RhdGUsIHJpZ2h0Qm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHJhbnNsYXRlKSB7XG4gICAgICAgICAgICBsZWZ0VG9wID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgbGVmdFRvcCk7XG4gICAgICAgICAgICBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgbGVmdEJvdHRvbSk7XG4gICAgICAgICAgICByaWdodFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgICAgIHJpZ2h0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHRyYW5zbGF0ZSwgcmlnaHRCb3R0b20pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDAgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyVmVydGV4ICogMCArIDFdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRUb3AsIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAwICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdFRvcCwgMiwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDAgKyAzXSA9IGlkO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAxICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAxICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAxICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAxICsgM10gPSBpZDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyVmVydGV4ICogMiArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDIgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0Qm90dG9tLCAyLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyVmVydGV4ICogMiArIDNdID0gaWQ7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDMgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDMgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDMgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDMgKyAzXSA9IGlkO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiA0ICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiA0ICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDEsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiA0ICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiA0ICsgM10gPSBpZDtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyVmVydGV4ICogNSArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKGxlZnRCb3R0b20sIDAsIDApO1xuICAgICAgICB0aGlzLnNxdXJlRGF0YVt0aGlzLnNxdXJlQ291bnQgKiBkYXRhUGVyTGluZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuc3F1cmVEYXRhW3RoaXMuc3F1cmVDb3VudCAqIGRhdGFQZXJMaW5lICsgZGF0YVBlclZlcnRleCAqIDUgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0Qm90dG9tLCAyLCAwKTtcbiAgICAgICAgdGhpcy5zcXVyZURhdGFbdGhpcy5zcXVyZUNvdW50ICogZGF0YVBlckxpbmUgKyBkYXRhUGVyVmVydGV4ICogNSArIDNdID0gaWQ7XG4gICAgICAgIHRoaXMuc3F1cmVDb3VudCArPSAxO1xuICAgIH1cbiAgICBkcmF3Q2lyY2xlKGNpcmNsZSkge1xuICAgICAgICBpZiAodGhpcy5jaXJjbGVDb3VudCA9PT0gY2lyY2xlQnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgbGV0IG1vZGVsTWF0cml4ID0gKDAsIG1hdGl4XzEudHJhbnNwb3NlTWF0cml4KSgoMCwgbWF0aXhfMS5jcmVhdGVVbml0TWF0cml4KSgxLjApKTtcbiAgICAgICAgICAgIHRoaXMuZmx1c2hDaXJjbGUobW9kZWxNYXRyaXgpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBsZWZ0VG9wID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgMC41LCBjb25zdF8xLnBhaXRpbmdMYXllciwgMS4wXSwgNCwgMSk7XG4gICAgICAgIGxldCBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEuY3JlYXRlTWF0cml4KShbLTAuNSwgLTAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIDAuNSwgY29uc3RfMS5wYWl0aW5nTGF5ZXIsIDEuMF0sIDQsIDEpO1xuICAgICAgICBsZXQgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5jcmVhdGVNYXRyaXgpKFswLjUsIC0wLjUsIGNvbnN0XzEucGFpdGluZ0xheWVyLCAxLjBdLCA0LCAxKTtcbiAgICAgICAgY29uc3QgdHJhbnNsYXRlID0gKDAsIG1hdGl4XzEuY3JlYXRlVHJhbnNsYXRpb25NYXRyaXgpKGNpcmNsZS5wb3NpdGlvbi54LCBjaXJjbGUucG9zaXRpb24ueSwgMCk7XG4gICAgICAgIC8vIGNvbnN0IHJvdGF0ZSA9IGNyZWF0ZVJvdGF0aW9uTWF0cml4KDAsIDAsIDApO1xuICAgICAgICBjb25zdCBzY2FsZSA9ICgwLCBtYXRpeF8xLmNyZWF0ZVNjYWxlTWF0cml4KShjaXJjbGUucmFkaXVzICogMiwgY2lyY2xlLnJhZGl1cyAqIDIsIDEuMCk7XG4gICAgICAgIGxlZnRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIGxlZnRUb3ApO1xuICAgICAgICBsZWZ0Qm90dG9tID0gKDAsIG1hdGl4XzEubXVsdGlwbHlNYXRyaXgpKHNjYWxlLCBsZWZ0Qm90dG9tKTtcbiAgICAgICAgcmlnaHRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkoc2NhbGUsIHJpZ2h0Qm90dG9tKTtcbiAgICAgICAgLy8gbGVmdFRvcCA9ICBtdWx0aXBseU1hdHJpeChyb3RhdGUsIGxlZnRUb3ApO1xuICAgICAgICAvLyBsZWZ0Qm90dG9tID0gbXVsdGlwbHlNYXRyaXgocm90YXRlLCBsZWZ0Qm90dG9tKTtcbiAgICAgICAgLy8gcmlnaHRUb3AgPSAgbXVsdGlwbHlNYXRyaXgocm90YXRlLCByaWdodFRvcCk7XG4gICAgICAgIC8vIHJpZ2h0Qm90dG9tID0gbXVsdGlwbHlNYXRyaXgocm90YXRlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIGxlZnRUb3AgPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodHJhbnNsYXRlLCBsZWZ0VG9wKTtcbiAgICAgICAgbGVmdEJvdHRvbSA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIGxlZnRCb3R0b20pO1xuICAgICAgICByaWdodFRvcCA9ICgwLCBtYXRpeF8xLm11bHRpcGx5TWF0cml4KSh0cmFuc2xhdGUsIHJpZ2h0VG9wKTtcbiAgICAgICAgcmlnaHRCb3R0b20gPSAoMCwgbWF0aXhfMS5tdWx0aXBseU1hdHJpeCkodHJhbnNsYXRlLCByaWdodEJvdHRvbSk7XG4gICAgICAgIGNvbnN0IGRhdGFQZXJWZXJ0ZXggPSA2O1xuICAgICAgICBjb25zdCBpZCA9IGNpcmNsZS5pZDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAxLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyAyXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShsZWZ0VG9wLCAyLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyAzXSA9IDAuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyA0XSA9IDEuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDAgKyA1XSA9IGlkO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogMSArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDEgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAxICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogMSArIDNdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogMSArIDRdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogMSArIDVdID0gaWQ7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgM10gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgNF0gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAyICsgNV0gPSBpZDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDMgKyAwXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiAzICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRCb3R0b20sIDEsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogMyArIDJdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0Qm90dG9tLCAyLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDMgKyAzXSA9IDEuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDMgKyA0XSA9IDAuMDtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDMgKyA1XSA9IGlkO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogNCArIDBdID0gKDAsIG1hdGl4XzEuZ2V0TWF0cml4VmFsdWUpKHJpZ2h0VG9wLCAwLCAwKTtcbiAgICAgICAgdGhpcy5jaXJjbGVEYXRhW3RoaXMuY2lyY2xlQ291bnQgKiBkYXRhUGVyQ2lyY2xlICsgZGF0YVBlclZlcnRleCAqIDQgKyAxXSA9ICgwLCBtYXRpeF8xLmdldE1hdHJpeFZhbHVlKShyaWdodFRvcCwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA0ICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkocmlnaHRUb3AsIDIsIDApO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogNCArIDNdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogNCArIDRdID0gMS4wO1xuICAgICAgICB0aGlzLmNpcmNsZURhdGFbdGhpcy5jaXJjbGVDb3VudCAqIGRhdGFQZXJDaXJjbGUgKyBkYXRhUGVyVmVydGV4ICogNCArIDVdID0gaWQ7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgMF0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMCwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgMV0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMSwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgMl0gPSAoMCwgbWF0aXhfMS5nZXRNYXRyaXhWYWx1ZSkobGVmdEJvdHRvbSwgMiwgMCk7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgM10gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgNF0gPSAwLjA7XG4gICAgICAgIHRoaXMuY2lyY2xlRGF0YVt0aGlzLmNpcmNsZUNvdW50ICogZGF0YVBlckNpcmNsZSArIGRhdGFQZXJWZXJ0ZXggKiA1ICsgNV0gPSBpZDtcbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCArPSAxO1xuICAgIH1cbiAgICBlbmRTY2VuZSgpIHtcbiAgICAgICAgdGhpcy5mbHVzaCgpO1xuICAgICAgICB0aGlzLmdsLmJpbmRGcmFtZWJ1ZmZlcih0aGlzLmdsLkZSQU1FQlVGRkVSLCBudWxsKTtcbiAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKHRoaXMubWFpblByb2dyYW0pO1xuICAgICAgICB0aGlzLmdsLmFjdGl2ZVRleHR1cmUodGhpcy5nbC5URVhUVVJFMCk7XG4gICAgICAgIHRoaXMuZ2wuYmluZFRleHR1cmUodGhpcy5nbC5URVhUVVJFXzJELCB0aGlzLmNvbG9yVGV4dHVyZSk7XG4gICAgICAgIHRoaXMuZ2wuYWN0aXZlVGV4dHVyZSh0aGlzLmdsLlRFWFRVUkUxKTtcbiAgICAgICAgdGhpcy5nbC5iaW5kQnVmZmVyKHRoaXMuZ2wuQVJSQVlfQlVGRkVSLCB0aGlzLm1haW5WQk8pO1xuICAgICAgICB0aGlzLmdsLmJ1ZmZlckRhdGEodGhpcy5nbC5BUlJBWV9CVUZGRVIsIGV4cG9ydHMuUVVBRF9XSVRIX1RFWFRVUkVfQ09PUkRfREFUQSwgdGhpcy5nbC5TVEFUSUNfRFJBVyk7XG4gICAgICAgIHRoaXMuZ2wudmVydGV4QXR0cmliUG9pbnRlcigwLCAzLCB0aGlzLmdsLkZMT0FULCBmYWxzZSwgRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UICogNSwgMCk7XG4gICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoMCk7XG4gICAgICAgIHRoaXMuZ2wudmVydGV4QXR0cmliUG9pbnRlcigxLCAyLCB0aGlzLmdsLkZMT0FULCBmYWxzZSwgRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UICogNSwgRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UICogMyk7XG4gICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoMSk7XG4gICAgICAgIHRoaXMuZ2wuZHJhd0FycmF5cyh0aGlzLmdsLlRSSUFOR0xFUywgMCwgZXhwb3J0cy5RVUFEX1dJVEhfVEVYVFVSRV9DT09SRF9EQVRBLmxlbmd0aCk7XG4gICAgICAgIHRoaXMucHJvamVjdGlvbiA9IG51bGw7XG4gICAgICAgIHRoaXMuY2FtZXJhID0gbnVsbDtcbiAgICAgICAgdGhpcy5zcXVyZUNvdW50ID0gMDtcbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCA9IDA7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdmbHVzaCBzcXVyZSBjb3VudCcsIGZsdXNoTGluZSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdmbHVzaCBjaXJjbGUgY291bnQnLCBmbHVzaENpcmNsZSk7XG4gICAgfVxuICAgIGZsdXNoKCkge1xuICAgICAgICBsZXQgbW9kZWxNYXRyaXggPSAoMCwgbWF0aXhfMS50cmFuc3Bvc2VNYXRyaXgpKCgwLCBtYXRpeF8xLmNyZWF0ZVVuaXRNYXRyaXgpKDEuMCkpO1xuICAgICAgICB0aGlzLmZsdXNoU3F1cmUobW9kZWxNYXRyaXgpO1xuICAgICAgICB0aGlzLmZsdXNoQ2lyY2xlKG1vZGVsTWF0cml4KTtcbiAgICB9XG4gICAgZ2V0SWREYXRhUmVhZGVyKCkge1xuICAgICAgICBjb25zdCBnbCA9IHRoaXMuZ2w7XG4gICAgICAgIGNvbnN0IHJlYWRQaXhlbHMgPSAoeCwgeSwgd2lkdGgsIGhlaWdodCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5nbC5iaW5kRnJhbWVidWZmZXIodGhpcy5nbC5GUkFNRUJVRkZFUiwgdGhpcy5mcmFtZWJ1ZmZlcik7XG4gICAgICAgICAgICBjb25zdCBiID0gbmV3IFVpbnQ4QXJyYXkod2lkdGggKiBoZWlnaHQgKiA0KTtcbiAgICAgICAgICAgIGdsLnJlYWRCdWZmZXIoZ2wuQ09MT1JfQVRUQUNITUVOVDEpO1xuICAgICAgICAgICAgZ2wucmVhZFBpeGVscyh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBnbC5SR0JBX0lOVEVHRVIsIGdsLlVOU0lHTkVEX0JZVEUsIGIpO1xuICAgICAgICAgICAgdGhpcy5nbC5iaW5kRnJhbWVidWZmZXIodGhpcy5nbC5GUkFNRUJVRkZFUiwgbnVsbCk7XG4gICAgICAgICAgICByZXR1cm4gYjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHsgcmVhZEJ1ZmZlcjogKCkgPT4gcmVhZFBpeGVscygwLCAwLCA2MDAsIDQwMCksIHJlYWRQaXhlbDogKHgsIHkpID0+IHJlYWRQaXhlbHMoeCwgeSwgMSwgMSkgfTtcbiAgICB9XG4gICAgZmx1c2hTcXVyZShtb2RlbE1hdHJpeCkge1xuICAgICAgICBpZiAodGhpcy5zcXVyZUNvdW50ICE9PSAwKSB7XG4gICAgICAgICAgICB0aGlzLl9mbHVzaGVkTGluZSArPSAxO1xuICAgICAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKHRoaXMuc3F1cmVQcm9ncmFtKTtcbiAgICAgICAgICAgIHRoaXMuZ2wuYmluZEJ1ZmZlcih0aGlzLmdsLkFSUkFZX0JVRkZFUiwgdGhpcy5zcXVyZVZCTyk7XG4gICAgICAgICAgICB0aGlzLmdsLmJ1ZmZlckRhdGEodGhpcy5nbC5BUlJBWV9CVUZGRVIsIHRoaXMuc3F1cmVEYXRhLCB0aGlzLmdsLlNUQVRJQ19EUkFXKTtcbiAgICAgICAgICAgIHRoaXMuZ2wudmVydGV4QXR0cmliUG9pbnRlcigwLCAzLCB0aGlzLmdsLkZMT0FULCBmYWxzZSwgRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UICogZGF0YVBlclZlcnRleCwgMCk7XG4gICAgICAgICAgICB0aGlzLmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KDApO1xuICAgICAgICAgICAgdGhpcy5nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKDEsIDEsIHRoaXMuZ2wuRkxPQVQsIGZhbHNlLCBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQgKiBkYXRhUGVyVmVydGV4LCBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQgKiAzKTtcbiAgICAgICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoMSk7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW1lcmEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdsLnVuaWZvcm1NYXRyaXg0ZnYodGhpcy5zcXVyZVVuaWZvcm1zLm1vZGVsVmlld0xvY2F0aW9uLCBmYWxzZSwgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKSh0aGlzLmNhbWVyYSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nbC51bmlmb3JtTWF0cml4NGZ2KHRoaXMuc3F1cmVVbmlmb3Jtcy5tb2RlbExvY2F0aW9uLCBmYWxzZSwgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKShtb2RlbE1hdHJpeCkpO1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvamVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2wudW5pZm9ybU1hdHJpeDRmdih0aGlzLnNxdXJlVW5pZm9ybXMucHJvamVjdGlvbkxvY2F0aW9uLCBmYWxzZSwgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKSh0aGlzLnByb2plY3Rpb24pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZ2wuZHJhd0FycmF5cyh0aGlzLmdsLlRSSUFOR0xFUywgMCwgdGhpcy5zcXVyZUNvdW50ICogNik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zcXVyZUNvdW50ID0gMDtcbiAgICB9XG4gICAgZmx1c2hDaXJjbGUobW9kZWxNYXRyaXgpIHtcbiAgICAgICAgaWYgKHRoaXMuY2lyY2xlQ291bnQgIT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuX2ZsdXNoZWRDaXJjbGUgKz0gMTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3REcmF3ZWRDaXJjbGUgPSB0aGlzLmNpcmNsZUNvdW50O1xuICAgICAgICAgICAgdGhpcy5nbC51c2VQcm9ncmFtKHRoaXMuY2lyY2xlUHJvZ3JhbSk7XG4gICAgICAgICAgICB0aGlzLmdsLmJpbmRCdWZmZXIodGhpcy5nbC5BUlJBWV9CVUZGRVIsIHRoaXMuY2lyY2xlVkJPKTtcbiAgICAgICAgICAgIHRoaXMuZ2wuYnVmZmVyRGF0YSh0aGlzLmdsLkFSUkFZX0JVRkZFUiwgdGhpcy5jaXJjbGVEYXRhLCB0aGlzLmdsLlNUQVRJQ19EUkFXKTtcbiAgICAgICAgICAgIHRoaXMuZ2wudmVydGV4QXR0cmliUG9pbnRlcigwLCAzLCB0aGlzLmdsLkZMT0FULCBmYWxzZSwgRmxvYXQzMkFycmF5LkJZVEVTX1BFUl9FTEVNRU5UICogZGF0YVBlckNpcmNsZVZlcnRleCwgMCk7XG4gICAgICAgICAgICB0aGlzLmdsLmVuYWJsZVZlcnRleEF0dHJpYkFycmF5KDApO1xuICAgICAgICAgICAgdGhpcy5nbC52ZXJ0ZXhBdHRyaWJQb2ludGVyKDEsIDIsIHRoaXMuZ2wuRkxPQVQsIGZhbHNlLCBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQgKiBkYXRhUGVyQ2lyY2xlVmVydGV4LCBGbG9hdDMyQXJyYXkuQllURVNfUEVSX0VMRU1FTlQgKiAzKTtcbiAgICAgICAgICAgIHRoaXMuZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoMSk7XG4gICAgICAgICAgICB0aGlzLmdsLnZlcnRleEF0dHJpYlBvaW50ZXIoMiwgMSwgdGhpcy5nbC5GTE9BVCwgZmFsc2UsIEZsb2F0MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVCAqIGRhdGFQZXJDaXJjbGVWZXJ0ZXgsIEZsb2F0MzJBcnJheS5CWVRFU19QRVJfRUxFTUVOVCAqIDUpO1xuICAgICAgICAgICAgdGhpcy5nbC5lbmFibGVWZXJ0ZXhBdHRyaWJBcnJheSgyKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbWVyYSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2wudW5pZm9ybU1hdHJpeDRmdih0aGlzLmNpcmNsZVVuaWZvcm1zLm1vZGVsVmlld0xvY2F0aW9uLCBmYWxzZSwgKDAsIG1hdGl4XzEuZ2V0UmF3VmFsdWVzKSh0aGlzLmNhbWVyYSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nbC51bmlmb3JtTWF0cml4NGZ2KHRoaXMuY2lyY2xlVW5pZm9ybXMubW9kZWxMb2NhdGlvbiwgZmFsc2UsICgwLCBtYXRpeF8xLmdldFJhd1ZhbHVlcykobW9kZWxNYXRyaXgpKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnByb2plY3Rpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdsLnVuaWZvcm1NYXRyaXg0ZnYodGhpcy5jaXJjbGVVbmlmb3Jtcy5wcm9qZWN0aW9uTG9jYXRpb24sIGZhbHNlLCAoMCwgbWF0aXhfMS5nZXRSYXdWYWx1ZXMpKHRoaXMucHJvamVjdGlvbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5nbC5kcmF3QXJyYXlzKHRoaXMuZ2wuVFJJQU5HTEVTLCAwLCB0aGlzLmNpcmNsZUNvdW50ICogNik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaXJjbGVDb3VudCA9IDA7XG4gICAgfVxuICAgIGdldERyYXdTdGF0KCkge1xuICAgICAgICByZXR1cm4geyBjaXJjbGVGbHVzaGVkOiB0aGlzLl9mbHVzaGVkQ2lyY2xlLCBkcmF3ZWRDaXJjbGVzOiB0aGlzLl9sYXN0RHJhd2VkQ2lyY2xlICsgTWF0aC5tYXgoMCwgdGhpcy5fZmx1c2hlZENpcmNsZSAtIDEpICogY2lyY2xlQnVmZmVyU2l6ZSB9O1xuICAgIH1cbiAgICBpc0RhdGFOb3RGbHVzaGVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zcXVyZUNvdW50ICE9PSAwIHx8IHRoaXMuY2lyY2xlQ291bnQgIT09IDA7XG4gICAgfVxufVxuZXhwb3J0cy5SZW5kZXJlciA9IFJlbmRlcmVyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/render/renderer.ts\n");

/***/ }),

/***/ "./src/utils/memory.ts":
/*!*****************************!*\
  !*** ./src/utils/memory.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.interpretAsInt32 = void 0;\nfunction interpretAsInt32(a, b, c, d) {\n    return (a) | (b << 8) | (c << 16) | (d << 24);\n}\nexports.interpretAsInt32 = interpretAsInt32;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvbWVtb3J5LnRzLmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2IsOENBQTZDLEVBQUUsYUFBYSxFQUFDO0FBQzdELHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kcmF3ZXIvLi9zcmMvdXRpbHMvbWVtb3J5LnRzP2RlZWMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmludGVycHJldEFzSW50MzIgPSB2b2lkIDA7XG5mdW5jdGlvbiBpbnRlcnByZXRBc0ludDMyKGEsIGIsIGMsIGQpIHtcbiAgICByZXR1cm4gKGEpIHwgKGIgPDwgOCkgfCAoYyA8PCAxNikgfCAoZCA8PCAyNCk7XG59XG5leHBvcnRzLmludGVycHJldEFzSW50MzIgPSBpbnRlcnByZXRBc0ludDMyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/memory.ts\n");

/***/ }),

/***/ "./src/utils/uniqeId.ts":
/*!******************************!*\
  !*** ./src/utils/uniqeId.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.createUniqeIdGenerator = void 0;\nfunction createUniqeIdGenerator(start = 0) {\n    return () => start++;\n}\nexports.createUniqeIdGenerator = createUniqeIdGenerator;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdXRpbHMvdW5pcWVJZC50cy5qcyIsIm1hcHBpbmdzIjoiQUFBYTtBQUNiLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsOEJBQThCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZHJhd2VyLy4vc3JjL3V0aWxzL3VuaXFlSWQudHM/OWE0ZCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuY3JlYXRlVW5pcWVJZEdlbmVyYXRvciA9IHZvaWQgMDtcbmZ1bmN0aW9uIGNyZWF0ZVVuaXFlSWRHZW5lcmF0b3Ioc3RhcnQgPSAwKSB7XG4gICAgcmV0dXJuICgpID0+IHN0YXJ0Kys7XG59XG5leHBvcnRzLmNyZWF0ZVVuaXFlSWRHZW5lcmF0b3IgPSBjcmVhdGVVbmlxZUlkR2VuZXJhdG9yO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/utils/uniqeId.ts\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/main.ts");
/******/ 	
/******/ })()
;